import{r as requireReact,g as getAugmentedNamespace,a as reactExports,C as ChevronRight,b as ChevronLeft,Z as ZoomIn,c as ZoomOut,R as RotateCw,D as Download}from"./react-DxiZ5OBW.js";var jsxRuntime={exports:{}},reactJsxRuntime_production_min={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var d=requireReact(),a=Symbol.for("react.element"),I=Symbol.for("react.fragment"),u=Object.prototype.hasOwnProperty,b=d.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n={key:!0,ref:!0,__self:!0,__source:!0};function x(z,W,r){var t,i={},h=null,c=null;r!==void 0&&(h=""+r),W.key!==void 0&&(h=""+W.key),W.ref!==void 0&&(c=W.ref);for(t in W)u.call(W,t)&&!n.hasOwnProperty(t)&&(i[t]=W[t]);if(z&&z.defaultProps)for(t in W=z.defaultProps,W)i[t]===void 0&&(i[t]=W[t]);return{$$typeof:a,type:z,key:h,ref:c,props:i,_owner:b.current}}return reactJsxRuntime_production_min.Fragment=I,reactJsxRuntime_production_min.jsx=x,reactJsxRuntime_production_min.jsxs=x,reactJsxRuntime_production_min}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production_min()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),lib={exports:{}},core_min={};function commonjsRequire(d){throw new Error('Could not dynamically require "'+d+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,(function(module,exports){(function(a,I){module.exports=a.pdfjsLib=I()})(globalThis,()=>(()=>{var __webpack_modules__=[,((d,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.VerbosityLevel=a.Util=a.UnknownErrorException=a.UnexpectedResponseException=a.TextRenderingMode=a.RenderingIntentFlag=a.PromiseCapability=a.PermissionFlag=a.PasswordResponses=a.PasswordException=a.PageActionEventType=a.OPS=a.MissingPDFException=a.MAX_IMAGE_SIZE_TO_CACHE=a.LINE_FACTOR=a.LINE_DESCENT_FACTOR=a.InvalidPDFException=a.ImageKind=a.IDENTITY_MATRIX=a.FormatError=a.FeatureTest=a.FONT_IDENTITY_MATRIX=a.DocumentActionEventType=a.CMapCompressionType=a.BaseException=a.BASELINE_FACTOR=a.AnnotationType=a.AnnotationReplyType=a.AnnotationPrefix=a.AnnotationMode=a.AnnotationFlag=a.AnnotationFieldFlag=a.AnnotationEditorType=a.AnnotationEditorPrefix=a.AnnotationEditorParamsType=a.AnnotationBorderStyleType=a.AnnotationActionEventType=a.AbortException=void 0,a.assert=f,a.bytesToString=U,a.createValidAbsoluteUrl=S,a.getModificationDate=Ae,a.getUuid=un,a.getVerbosityLevel=Et,a.info=ct,a.isArrayBuffer=ne,a.isArrayEqual=ke,a.isNodeJS=void 0,a.normalizeUnicode=qe,a.objectFromMap=rt,a.objectSize=At,a.setVerbosityLevel=vt,a.shadow=L,a.string32=it,a.stringToBytes=X,a.stringToPDFString=Bt,a.stringToUTF8String=Xt,a.unreachable=A,a.utf8StringToString=$t,a.warn=O;const I=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");a.isNodeJS=I;const u=[1,0,0,1,0,0];a.IDENTITY_MATRIX=u;const b=[.001,0,0,.001,0,0];a.FONT_IDENTITY_MATRIX=b;const n=1e7;a.MAX_IMAGE_SIZE_TO_CACHE=n;const x=1.35;a.LINE_FACTOR=x;const z=.35;a.LINE_DESCENT_FACTOR=z;const W=z/x;a.BASELINE_FACTOR=W;const r={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};a.RenderingIntentFlag=r;const t={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};a.AnnotationMode=t;const i="pdfjs_internal_editor_";a.AnnotationEditorPrefix=i;const h={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};a.AnnotationEditorType=h;const c={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};a.AnnotationEditorParamsType=c;const e={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};a.PermissionFlag=e;const g={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};a.TextRenderingMode=g;const v={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};a.ImageKind=v;const l={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};a.AnnotationType=l;const w={GROUP:"Group",REPLY:"R"};a.AnnotationReplyType=w;const M={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};a.AnnotationFlag=M;const R={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};a.AnnotationFieldFlag=R;const m={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};a.AnnotationBorderStyleType=m;const C={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};a.AnnotationActionEventType=C;const q={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};a.DocumentActionEventType=q;const $={O:"PageOpen",C:"PageClose"};a.PageActionEventType=$;const j={ERRORS:0,WARNINGS:1,INFOS:5};a.VerbosityLevel=j;const tt={NONE:0,BINARY:1};a.CMapCompressionType=tt;const nt={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};a.OPS=nt;const yt={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};a.PasswordResponses=yt;let dt=j.WARNINGS;function vt(bt){Number.isInteger(bt)&&(dt=bt)}function Et(){return dt}function ct(bt){dt>=j.INFOS&&console.log(`Info: ${bt}`)}function O(bt){dt>=j.WARNINGS&&console.log(`Warning: ${bt}`)}function A(bt){throw new Error(bt)}function f(bt,et){bt||A(et)}function p(bt){switch(bt?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function S(bt,et=null,Q=null){if(!bt)return null;try{if(Q&&typeof bt=="string"&&(Q.addDefaultProtocol&&bt.startsWith("www.")&&bt.match(/\./g)?.length>=2&&(bt=`http://${bt}`),Q.tryConvertEncoding))try{bt=Xt(bt)}catch{}const St=et?new URL(bt,et):new URL(bt);if(p(St))return St}catch{}return null}function L(bt,et,Q,St=!1){return Object.defineProperty(bt,et,{value:Q,enumerable:!St,configurable:!0,writable:!1}),Q}const F=(function(){function et(Q,St){this.constructor===et&&A("Cannot initialize BaseException."),this.message=Q,this.name=St}return et.prototype=new Error,et.constructor=et,et})();a.BaseException=F;class H extends F{constructor(et,Q){super(et,"PasswordException"),this.code=Q}}a.PasswordException=H;class T extends F{constructor(et,Q){super(et,"UnknownErrorException"),this.details=Q}}a.UnknownErrorException=T;class s extends F{constructor(et){super(et,"InvalidPDFException")}}a.InvalidPDFException=s;class _ extends F{constructor(et){super(et,"MissingPDFException")}}a.MissingPDFException=_;class E extends F{constructor(et,Q){super(et,"UnexpectedResponseException"),this.status=Q}}a.UnexpectedResponseException=E;class P extends F{constructor(et){super(et,"FormatError")}}a.FormatError=P;class k extends F{constructor(et){super(et,"AbortException")}}a.AbortException=k;function U(bt){(typeof bt!="object"||bt?.length===void 0)&&A("Invalid argument for bytesToString");const et=bt.length,Q=8192;if(et<Q)return String.fromCharCode.apply(null,bt);const St=[];for(let oe=0;oe<et;oe+=Q){const Wt=Math.min(oe+Q,et),Qt=bt.subarray(oe,Wt);St.push(String.fromCharCode.apply(null,Qt))}return St.join("")}function X(bt){typeof bt!="string"&&A("Invalid argument for stringToBytes");const et=bt.length,Q=new Uint8Array(et);for(let St=0;St<et;++St)Q[St]=bt.charCodeAt(St)&255;return Q}function it(bt){return String.fromCharCode(bt>>24&255,bt>>16&255,bt>>8&255,bt&255)}function At(bt){return Object.keys(bt).length}function rt(bt){const et=Object.create(null);for(const[Q,St]of bt)et[Q]=St;return et}function st(){const bt=new Uint8Array(4);return bt[0]=1,new Uint32Array(bt.buffer,0,1)[0]===1}function ut(){try{return new Function(""),!0}catch{return!1}}class ht{static get isLittleEndian(){return L(this,"isLittleEndian",st())}static get isEvalSupported(){return L(this,"isEvalSupported",ut())}static get isOffscreenCanvasSupported(){return L(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?L(this,"platform",{isWin:!1,isMac:!1}):L(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){return L(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}a.FeatureTest=ht;const gt=[...Array(256).keys()].map(bt=>bt.toString(16).padStart(2,"0"));class Ct{static makeHexColor(et,Q,St){return`#${gt[et]}${gt[Q]}${gt[St]}`}static scaleMinMax(et,Q){let St;et[0]?(et[0]<0&&(St=Q[0],Q[0]=Q[1],Q[1]=St),Q[0]*=et[0],Q[1]*=et[0],et[3]<0&&(St=Q[2],Q[2]=Q[3],Q[3]=St),Q[2]*=et[3],Q[3]*=et[3]):(St=Q[0],Q[0]=Q[2],Q[2]=St,St=Q[1],Q[1]=Q[3],Q[3]=St,et[1]<0&&(St=Q[2],Q[2]=Q[3],Q[3]=St),Q[2]*=et[1],Q[3]*=et[1],et[2]<0&&(St=Q[0],Q[0]=Q[1],Q[1]=St),Q[0]*=et[2],Q[1]*=et[2]),Q[0]+=et[4],Q[1]+=et[4],Q[2]+=et[5],Q[3]+=et[5]}static transform(et,Q){return[et[0]*Q[0]+et[2]*Q[1],et[1]*Q[0]+et[3]*Q[1],et[0]*Q[2]+et[2]*Q[3],et[1]*Q[2]+et[3]*Q[3],et[0]*Q[4]+et[2]*Q[5]+et[4],et[1]*Q[4]+et[3]*Q[5]+et[5]]}static applyTransform(et,Q){const St=et[0]*Q[0]+et[1]*Q[2]+Q[4],oe=et[0]*Q[1]+et[1]*Q[3]+Q[5];return[St,oe]}static applyInverseTransform(et,Q){const St=Q[0]*Q[3]-Q[1]*Q[2],oe=(et[0]*Q[3]-et[1]*Q[2]+Q[2]*Q[5]-Q[4]*Q[3])/St,Wt=(-et[0]*Q[1]+et[1]*Q[0]+Q[4]*Q[1]-Q[5]*Q[0])/St;return[oe,Wt]}static getAxialAlignedBoundingBox(et,Q){const St=this.applyTransform(et,Q),oe=this.applyTransform(et.slice(2,4),Q),Wt=this.applyTransform([et[0],et[3]],Q),Qt=this.applyTransform([et[2],et[1]],Q);return[Math.min(St[0],oe[0],Wt[0],Qt[0]),Math.min(St[1],oe[1],Wt[1],Qt[1]),Math.max(St[0],oe[0],Wt[0],Qt[0]),Math.max(St[1],oe[1],Wt[1],Qt[1])]}static inverseTransform(et){const Q=et[0]*et[3]-et[1]*et[2];return[et[3]/Q,-et[1]/Q,-et[2]/Q,et[0]/Q,(et[2]*et[5]-et[4]*et[3])/Q,(et[4]*et[1]-et[5]*et[0])/Q]}static singularValueDecompose2dScale(et){const Q=[et[0],et[2],et[1],et[3]],St=et[0]*Q[0]+et[1]*Q[2],oe=et[0]*Q[1]+et[1]*Q[3],Wt=et[2]*Q[0]+et[3]*Q[2],Qt=et[2]*Q[1]+et[3]*Q[3],Ge=(St+Qt)/2,Xe=Math.sqrt((St+Qt)**2-4*(St*Qt-Wt*oe))/2,ze=Ge+Xe||1,Me=Ge-Xe||1;return[Math.sqrt(ze),Math.sqrt(Me)]}static normalizeRect(et){const Q=et.slice(0);return et[0]>et[2]&&(Q[0]=et[2],Q[2]=et[0]),et[1]>et[3]&&(Q[1]=et[3],Q[3]=et[1]),Q}static intersect(et,Q){const St=Math.max(Math.min(et[0],et[2]),Math.min(Q[0],Q[2])),oe=Math.min(Math.max(et[0],et[2]),Math.max(Q[0],Q[2]));if(St>oe)return null;const Wt=Math.max(Math.min(et[1],et[3]),Math.min(Q[1],Q[3])),Qt=Math.min(Math.max(et[1],et[3]),Math.max(Q[1],Q[3]));return Wt>Qt?null:[St,Wt,oe,Qt]}static bezierBoundingBox(et,Q,St,oe,Wt,Qt,Ge,Xe){const ze=[],Me=[[],[]];let Ue,Be,rn,Se,sn,an,hn,dn;for(let fn=0;fn<2;++fn){if(fn===0?(Be=6*et-12*St+6*Wt,Ue=-3*et+9*St-9*Wt+3*Ge,rn=3*St-3*et):(Be=6*Q-12*oe+6*Qt,Ue=-3*Q+9*oe-9*Qt+3*Xe,rn=3*oe-3*Q),Math.abs(Ue)<1e-12){if(Math.abs(Be)<1e-12)continue;Se=-rn/Be,0<Se&&Se<1&&ze.push(Se);continue}hn=Be*Be-4*rn*Ue,dn=Math.sqrt(hn),!(hn<0)&&(sn=(-Be+dn)/(2*Ue),0<sn&&sn<1&&ze.push(sn),an=(-Be-dn)/(2*Ue),0<an&&an<1&&ze.push(an))}let Qe=ze.length,Fe;const tn=Qe;for(;Qe--;)Se=ze[Qe],Fe=1-Se,Me[0][Qe]=Fe*Fe*Fe*et+3*Fe*Fe*Se*St+3*Fe*Se*Se*Wt+Se*Se*Se*Ge,Me[1][Qe]=Fe*Fe*Fe*Q+3*Fe*Fe*Se*oe+3*Fe*Se*Se*Qt+Se*Se*Se*Xe;return Me[0][tn]=et,Me[1][tn]=Q,Me[0][tn+1]=Ge,Me[1][tn+1]=Xe,Me[0].length=Me[1].length=tn+2,[Math.min(...Me[0]),Math.min(...Me[1]),Math.max(...Me[0]),Math.max(...Me[1])]}}a.Util=Ct;const Lt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Bt(bt){if(bt[0]>="ï"){let Q;if(bt[0]==="þ"&&bt[1]==="ÿ"?Q="utf-16be":bt[0]==="ÿ"&&bt[1]==="þ"?Q="utf-16le":bt[0]==="ï"&&bt[1]==="»"&&bt[2]==="¿"&&(Q="utf-8"),Q)try{const St=new TextDecoder(Q,{fatal:!0}),oe=X(bt);return St.decode(oe)}catch(St){O(`stringToPDFString: "${St}".`)}}const et=[];for(let Q=0,St=bt.length;Q<St;Q++){const oe=Lt[bt.charCodeAt(Q)];et.push(oe?String.fromCharCode(oe):bt.charAt(Q))}return et.join("")}function Xt(bt){return decodeURIComponent(escape(bt))}function $t(bt){return unescape(encodeURIComponent(bt))}function ne(bt){return typeof bt=="object"&&bt?.byteLength!==void 0}function ke(bt,et){if(bt.length!==et.length)return!1;for(let Q=0,St=bt.length;Q<St;Q++)if(bt[Q]!==et[Q])return!1;return!0}function Ae(bt=new Date){return[bt.getUTCFullYear().toString(),(bt.getUTCMonth()+1).toString().padStart(2,"0"),bt.getUTCDate().toString().padStart(2,"0"),bt.getUTCHours().toString().padStart(2,"0"),bt.getUTCMinutes().toString().padStart(2,"0"),bt.getUTCSeconds().toString().padStart(2,"0")].join("")}class He{#t=!1;constructor(){this.promise=new Promise((et,Q)=>{this.resolve=St=>{this.#t=!0,et(St)},this.reject=St=>{this.#t=!0,Q(St)}})}get settled(){return this.#t}}a.PromiseCapability=He;let Pe=null,Oe=null;function qe(bt){return Pe||(Pe=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Oe=new Map([["ﬅ","ſt"]])),bt.replaceAll(Pe,(et,Q,St)=>Q?Q.normalize("NFKC"):Oe.get(St))}function un(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();const bt=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(bt);else for(let et=0;et<32;et++)bt[et]=Math.floor(Math.random()*255);return U(bt)}const Ne="pdfjs_internal_id_";a.AnnotationPrefix=Ne}),((__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(d){if(typeof d=="string"||d instanceof URL?d={url:d}:(0,_util.isArrayBuffer)(d)&&(d={data:d}),typeof d!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!d.url&&!d.data&&!d.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const a=new PDFDocumentLoadingTask,{docId:I}=a,u=d.url?getUrlProp(d.url):null,b=d.data?getDataProp(d.data):null,n=d.httpHeaders||null,x=d.withCredentials===!0,z=d.password??null,W=d.range instanceof PDFDataRangeTransport?d.range:null,r=Number.isInteger(d.rangeChunkSize)&&d.rangeChunkSize>0?d.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let t=d.worker instanceof PDFWorker?d.worker:null;const i=d.verbosity,h=typeof d.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(d.docBaseUrl)?d.docBaseUrl:null,c=typeof d.cMapUrl=="string"?d.cMapUrl:null,e=d.cMapPacked!==!1,g=d.CMapReaderFactory||DefaultCMapReaderFactory,v=typeof d.standardFontDataUrl=="string"?d.standardFontDataUrl:null,l=d.StandardFontDataFactory||DefaultStandardFontDataFactory,w=d.stopAtErrors!==!0,M=Number.isInteger(d.maxImageSize)&&d.maxImageSize>-1?d.maxImageSize:-1,R=d.isEvalSupported!==!1,m=typeof d.isOffscreenCanvasSupported=="boolean"?d.isOffscreenCanvasSupported:!_util.isNodeJS,C=Number.isInteger(d.canvasMaxAreaInBytes)?d.canvasMaxAreaInBytes:-1,q=typeof d.disableFontFace=="boolean"?d.disableFontFace:_util.isNodeJS,$=d.fontExtraProperties===!0,j=d.enableXfa===!0,tt=d.ownerDocument||globalThis.document,nt=d.disableRange===!0,yt=d.disableStream===!0,dt=d.disableAutoFetch===!0,vt=d.pdfBug===!0,Et=W?W.length:d.length??NaN,ct=typeof d.useSystemFonts=="boolean"?d.useSystemFonts:!_util.isNodeJS&&!q,O=typeof d.useWorkerFetch=="boolean"?d.useWorkerFetch:g===_display_utils.DOMCMapReaderFactory&&l===_display_utils.DOMStandardFontDataFactory&&c&&v&&(0,_display_utils.isValidFetchUrl)(c,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(v,document.baseURI),A=d.canvasFactory||new DefaultCanvasFactory({ownerDocument:tt}),f=d.filterFactory||new DefaultFilterFactory({docId:I,ownerDocument:tt}),p=null;(0,_util.setVerbosityLevel)(i);const S={canvasFactory:A,filterFactory:f};if(O||(S.cMapReaderFactory=new g({baseUrl:c,isCompressed:e}),S.standardFontDataFactory=new l({baseUrl:v})),!t){const H={verbosity:i,port:_worker_options.GlobalWorkerOptions.workerPort};t=H.port?PDFWorker.fromPort(H):new PDFWorker(H),a._worker=t}const L={docId:I,apiVersion:"3.11.174",data:b,password:z,disableAutoFetch:dt,rangeChunkSize:r,length:Et,docBaseUrl:h,enableXfa:j,evaluatorOptions:{maxImageSize:M,disableFontFace:q,ignoreErrors:w,isEvalSupported:R,isOffscreenCanvasSupported:m,canvasMaxAreaInBytes:C,fontExtraProperties:$,useSystemFonts:ct,cMapUrl:O?c:null,standardFontDataUrl:O?v:null}},F={ignoreErrors:w,isEvalSupported:R,disableFontFace:q,fontExtraProperties:$,enableXfa:j,ownerDocument:tt,disableAutoFetch:dt,pdfBug:vt,styleElement:p};return t.promise.then(function(){if(a.destroyed)throw new Error("Loading aborted");const H=_fetchDocument(t,L),T=new Promise(function(s){let _;W?_=new _transport_stream.PDFDataTransportStream({length:Et,initialData:W.initialData,progressiveDone:W.progressiveDone,contentDispositionFilename:W.contentDispositionFilename,disableRange:nt,disableStream:yt},W):b||(_=(P=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(P):(0,_display_utils.isValidFetchUrl)(P.url)?new _displayFetch_stream.PDFFetchStream(P):new _displayNetwork.PDFNetworkStream(P))({url:u,length:Et,httpHeaders:n,withCredentials:x,rangeChunkSize:r,disableRange:nt,disableStream:yt})),s(_)});return Promise.all([H,T]).then(function([s,_]){if(a.destroyed)throw new Error("Loading aborted");const E=new _message_handler.MessageHandler(I,s,t.port),P=new WorkerTransport(E,a,_,F,S);a._transport=P,E.send("Ready",null)})}).catch(a._capability.reject),a}async function _fetchDocument(d,a){if(d.destroyed)throw new Error("Worker was destroyed");const I=await d.messageHandler.sendWithPromise("GetDocRequest",a,a.data?[a.data.buffer]:null);if(d.destroyed)throw new Error("Worker was destroyed");return I}function getUrlProp(d){if(d instanceof URL)return d.href;try{return new URL(d,window.location).href}catch{if(_util.isNodeJS&&typeof d=="string")return d}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(d){if(_util.isNodeJS&&typeof Buffer<"u"&&d instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(d instanceof Uint8Array&&d.byteLength===d.buffer.byteLength)return d;if(typeof d=="string")return(0,_util.stringToBytes)(d);if(typeof d=="object"&&!isNaN(d?.length)||(0,_util.isArrayBuffer)(d))return new Uint8Array(d);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class PDFDocumentLoadingTask{static#t=0;constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#t++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(a){throw this._worker?.port&&delete this._worker._pendingDestroy,a}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(a,I,u=!1,b=null){this.length=a,this.initialData=I,this.progressiveDone=u,this.contentDispositionFilename=b,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(a){this._rangeListeners.push(a)}addProgressListener(a){this._progressListeners.push(a)}addProgressiveReadListener(a){this._progressiveReadListeners.push(a)}addProgressiveDoneListener(a){this._progressiveDoneListeners.push(a)}onDataRange(a,I){for(const u of this._rangeListeners)u(a,I)}onDataProgress(a,I){this._readyCapability.promise.then(()=>{for(const u of this._progressListeners)u(a,I)})}onDataProgressiveRead(a){this._readyCapability.promise.then(()=>{for(const I of this._progressiveReadListeners)I(a)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const a of this._progressiveDoneListeners)a()})}transportReady(){this._readyCapability.resolve()}requestDataRange(a,I){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(a,I){this._pdfInfo=a,this._transport=I,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(u=>{if(!u)return u;const b=[];for(const n in u)b.push(...u[n]);return b}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(a){return this._transport.getPage(a)}getPageIndex(a){return this._transport.getPageIndex(a)}getDestinations(){return this._transport.getDestinations()}getDestination(a){return this._transport.getDestination(a)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(a=!1){return this._transport.startCleanup(a||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#t=null;#e=!1;constructor(a,I,u,b=!1){this._pageIndex=a,this._pageInfo=I,this._transport=u,this._stats=b?new _display_utils.StatTimer:null,this._pdfBug=b,this.commonObjs=u.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:a,rotation:I=this.rotate,offsetX:u=0,offsetY:b=0,dontFlip:n=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:a,rotation:I,offsetX:u,offsetY:b,dontFlip:n})}getAnnotations({intent:a="display"}={}){const I=this._transport.getRenderingIntent(a);return this._transport.getAnnotations(this._pageIndex,I.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:a,viewport:I,intent:u="display",annotationMode:b=_util.AnnotationMode.ENABLE,transform:n=null,background:x=null,optionalContentConfigPromise:z=null,annotationCanvasMap:W=null,pageColors:r=null,printAnnotationStorage:t=null}){this._stats?.time("Overall");const i=this._transport.getRenderingIntent(u,b,t);this.#e=!1,this.#i(),z||(z=this._transport.getOptionalContentConfig());let h=this._intentStates.get(i.cacheKey);h||(h=Object.create(null),this._intentStates.set(i.cacheKey,h)),h.streamReaderCancelTimeout&&(clearTimeout(h.streamReaderCancelTimeout),h.streamReaderCancelTimeout=null);const c=!!(i.renderingIntent&_util.RenderingIntentFlag.PRINT);h.displayReadyCapability||(h.displayReadyCapability=new _util.PromiseCapability,h.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(i));const e=l=>{h.renderTasks.delete(g),(this._maybeCleanupAfterRender||c)&&(this.#e=!0),this.#n(!c),l?(g.capability.reject(l),this._abortOperatorList({intentState:h,reason:l instanceof Error?l:new Error(l)})):g.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},g=new InternalRenderTask({callback:e,params:{canvasContext:a,viewport:I,transform:n,background:x},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:W,operatorList:h.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!c,pdfBug:this._pdfBug,pageColors:r});(h.renderTasks||=new Set).add(g);const v=g.task;return Promise.all([h.displayReadyCapability.promise,z]).then(([l,w])=>{if(this.destroyed){e();return}this._stats?.time("Rendering"),g.initializeGraphics({transparency:l,optionalContentConfig:w}),g.operatorListChanged()}).catch(e),v}getOperatorList({intent:a="display",annotationMode:I=_util.AnnotationMode.ENABLE,printAnnotationStorage:u=null}={}){function b(){x.operatorList.lastChunk&&(x.opListReadCapability.resolve(x.operatorList),x.renderTasks.delete(z))}const n=this._transport.getRenderingIntent(a,I,u,!0);let x=this._intentStates.get(n.cacheKey);x||(x=Object.create(null),this._intentStates.set(n.cacheKey,x));let z;return x.opListReadCapability||(z=Object.create(null),z.operatorListChanged=b,x.opListReadCapability=new _util.PromiseCapability,(x.renderTasks||=new Set).add(z),x.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(n)),x.opListReadCapability.promise}streamTextContent({includeMarkedContent:a=!1,disableNormalization:I=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:a===!0,disableNormalization:I===!0},{highWaterMark:100,size(b){return b.items.length}})}getTextContent(a={}){if(this._transport._htmlForXfa)return this.getXfa().then(u=>_xfa_text.XfaText.textContent(u));const I=this.streamTextContent(a);return new Promise(function(u,b){function n(){x.read().then(function({value:W,done:r}){if(r){u(z);return}Object.assign(z.styles,W.styles),z.items.push(...W.items),n()},b)}const x=I.getReader(),z={items:[],styles:Object.create(null)};n()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const a=[];for(const I of this._intentStates.values())if(this._abortOperatorList({intentState:I,reason:new Error("Page was destroyed."),force:!0}),!I.opListReadCapability)for(const u of I.renderTasks)a.push(u.completed),u.cancel();return this.objs.clear(),this.#e=!1,this.#i(),Promise.all(a)}cleanup(a=!1){this.#e=!0;const I=this.#n(!1);return a&&I&&(this._stats&&=new _display_utils.StatTimer),I}#n(a=!1){if(this.#i(),!this.#e||this.destroyed)return!1;if(a)return this.#t=setTimeout(()=>{this.#t=null,this.#n(!1)},DELAYED_CLEANUP_TIMEOUT),!1;for(const{renderTasks:I,operatorList:u}of this._intentStates.values())if(I.size>0||!u.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}#i(){this.#t&&(clearTimeout(this.#t),this.#t=null)}_startRenderPage(a,I){const u=this._intentStates.get(I);u&&(this._stats?.timeEnd("Page Request"),u.displayReadyCapability?.resolve(a))}_renderPageChunk(a,I){for(let u=0,b=a.length;u<b;u++)I.operatorList.fnArray.push(a.fnArray[u]),I.operatorList.argsArray.push(a.argsArray[u]);I.operatorList.lastChunk=a.lastChunk,I.operatorList.separateAnnots=a.separateAnnots;for(const u of I.renderTasks)u.operatorListChanged();a.lastChunk&&this.#n(!0)}_pumpOperatorList({renderingIntent:a,cacheKey:I,annotationStorageSerializable:u}){const{map:b,transfers:n}=u,z=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:a,cacheKey:I,annotationStorage:b},n).getReader(),W=this._intentStates.get(I);W.streamReader=z;const r=()=>{z.read().then(({value:t,done:i})=>{if(i){W.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(t,W),r())},t=>{if(W.streamReader=null,!this._transport.destroyed){if(W.operatorList){W.operatorList.lastChunk=!0;for(const i of W.renderTasks)i.operatorListChanged();this.#n(!0)}if(W.displayReadyCapability)W.displayReadyCapability.reject(t);else if(W.opListReadCapability)W.opListReadCapability.reject(t);else throw t}})};r()}_abortOperatorList({intentState:a,reason:I,force:u=!1}){if(a.streamReader){if(a.streamReaderCancelTimeout&&(clearTimeout(a.streamReaderCancelTimeout),a.streamReaderCancelTimeout=null),!u){if(a.renderTasks.size>0)return;if(I instanceof _display_utils.RenderingCancelledException){let b=RENDERING_CANCELLED_TIMEOUT;I.extraDelay>0&&I.extraDelay<1e3&&(b+=I.extraDelay),a.streamReaderCancelTimeout=setTimeout(()=>{a.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:a,reason:I,force:!0})},b);return}}if(a.streamReader.cancel(new _util.AbortException(I.message)).catch(()=>{}),a.streamReader=null,!this._transport.destroyed){for(const[b,n]of this._intentStates)if(n===a){this._intentStates.delete(b);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{#t=new Set;#e=Promise.resolve();postMessage(a,I){const u={data:structuredClone(a,I?{transfer:I}:null)};this.#e.then(()=>{for(const b of this.#t)b.call(this,u)})}addEventListener(a,I){this.#t.add(I)}removeEventListener(a,I){this.#t.delete(I)}terminate(){this.#t.clear()}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const d=document?.currentScript?.src;d&&(PDFWorkerUtil.fallbackWorkerSrc=d.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(d,a){let I;try{if(I=new URL(d),!I.origin||I.origin==="null")return!1}catch{return!1}const u=new URL(a,I);return I.origin===u.origin},PDFWorkerUtil.createCDNWrapper=function(d){const a=`importScripts("${d}");`;return URL.createObjectURL(new Blob([a]))}}class PDFWorker{static#workerPorts;constructor({name:d=null,port:a=null,verbosity:I=(0,_util.getVerbosityLevel)()}={}){if(this.name=d,this.destroyed=!1,this.verbosity=I,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,a){if(PDFWorker.#workerPorts?.has(a))throw new Error("Cannot use more than one PDFWorker per port.");(PDFWorker.#workerPorts||=new WeakMap).set(a,this),this._initializeFromPort(a);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(d){this._port=d,this._messageHandler=new _message_handler.MessageHandler("main","worker",d),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:d}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,d)||(d=PDFWorkerUtil.createCDNWrapper(new URL(d,window.location).href));const a=new Worker(d),I=new _message_handler.MessageHandler("main","worker",a),u=()=>{a.removeEventListener("error",b),I.destroy(),a.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},b=()=>{this._webWorker||u()};a.addEventListener("error",b),I.on("test",x=>{if(a.removeEventListener("error",b),this.destroyed){u();return}x?(this._messageHandler=I,this._port=a,this._webWorker=a,this._readyCapability.resolve(),I.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),I.destroy(),a.terminate())}),I.on("ready",x=>{if(a.removeEventListener("error",b),this.destroyed){u();return}try{n()}catch{this._setupFakeWorker()}});const n=()=>{const x=new Uint8Array;I.send("test",x,[x.buffer])};n();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(d=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const a=new LoopbackPort;this._port=a;const I=`fake${PDFWorkerUtil.fakeWorkerId++}`,u=new _message_handler.MessageHandler(I+"_worker",I,a);d.setup(u,a);const b=new _message_handler.MessageHandler(I,I+"_worker",a);this._messageHandler=b,this._readyCapability.resolve(),b.send("configure",{verbosity:this.verbosity})}).catch(d=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${d.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#workerPorts?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(d){if(!d?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const a=this.#workerPorts?.get(d.port);if(a){if(a._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return a}return new PDFWorker(d)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker;class WorkerTransport{#t=new Map;#e=new Map;#n=new Map;#i=null;constructor(a,I,u,b,n){this.messageHandler=a,this.loadingTask=I,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:b.ownerDocument,styleElement:b.styleElement}),this._params=b,this.canvasFactory=n.canvasFactory,this.filterFactory=n.filterFactory,this.cMapReaderFactory=n.cMapReaderFactory,this.standardFontDataFactory=n.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=u,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}#o(a,I=null){const u=this.#t.get(a);if(u)return u;const b=this.messageHandler.sendWithPromise(a,I);return this.#t.set(a,b),b}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(a,I=_util.AnnotationMode.ENABLE,u=null,b=!1){let n=_util.RenderingIntentFlag.DISPLAY,x=_annotation_storage.SerializableEmpty;switch(a){case"any":n=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":n=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${a}`)}switch(I){case _util.AnnotationMode.DISABLE:n+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:n+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:n+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,x=(n&_util.RenderingIntentFlag.PRINT&&u instanceof _annotation_storage.PrintAnnotationStorage?u:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${I}`)}return b&&(n+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:n,cacheKey:`${n}_${x.hash}`,annotationStorageSerializable:x}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this.#i?.reject(new Error("Worker was destroyed during onPassword callback"));const a=[];for(const u of this.#e.values())a.push(u._destroy());this.#e.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const I=this.messageHandler.sendWithPromise("Terminate",null);return a.push(I),Promise.all(a).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),this._networkStream?.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:a,loadingTask:I}=this;a.on("GetReader",(u,b)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=n=>{this._lastProgress={loaded:n.loaded,total:n.total}},b.onPull=()=>{this._fullReader.read().then(function({value:n,done:x}){if(x){b.close();return}(0,_util.assert)(n instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),b.enqueue(new Uint8Array(n),1,[n])}).catch(n=>{b.error(n)})},b.onCancel=n=>{this._fullReader.cancel(n),b.ready.catch(x=>{if(!this.destroyed)throw x})}}),a.on("ReaderHeadersReady",u=>{const b=new _util.PromiseCapability,n=this._fullReader;return n.headersReady.then(()=>{(!n.isStreamingSupported||!n.isRangeSupported)&&(this._lastProgress&&I.onProgress?.(this._lastProgress),n.onProgress=x=>{I.onProgress?.({loaded:x.loaded,total:x.total})}),b.resolve({isStreamingSupported:n.isStreamingSupported,isRangeSupported:n.isRangeSupported,contentLength:n.contentLength})},b.reject),b.promise}),a.on("GetRangeReader",(u,b)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(u.begin,u.end);if(!n){b.close();return}b.onPull=()=>{n.read().then(function({value:x,done:z}){if(z){b.close();return}(0,_util.assert)(x instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),b.enqueue(new Uint8Array(x),1,[x])}).catch(x=>{b.error(x)})},b.onCancel=x=>{n.cancel(x),b.ready.catch(z=>{if(!this.destroyed)throw z})}}),a.on("GetDoc",({pdfInfo:u})=>{this._numPages=u.numPages,this._htmlForXfa=u.htmlForXfa,delete u.htmlForXfa,I._capability.resolve(new PDFDocumentProxy(u,this))}),a.on("DocException",function(u){let b;switch(u.name){case"PasswordException":b=new _util.PasswordException(u.message,u.code);break;case"InvalidPDFException":b=new _util.InvalidPDFException(u.message);break;case"MissingPDFException":b=new _util.MissingPDFException(u.message);break;case"UnexpectedResponseException":b=new _util.UnexpectedResponseException(u.message,u.status);break;case"UnknownErrorException":b=new _util.UnknownErrorException(u.message,u.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}I._capability.reject(b)}),a.on("PasswordRequest",u=>{if(this.#i=new _util.PromiseCapability,I.onPassword){const b=n=>{n instanceof Error?this.#i.reject(n):this.#i.resolve({password:n})};try{I.onPassword(b,u.code)}catch(n){this.#i.reject(n)}}else this.#i.reject(new _util.PasswordException(u.message,u.code));return this.#i.promise}),a.on("DataLoaded",u=>{I.onProgress?.({loaded:u.length,total:u.length}),this.downloadInfoCapability.resolve(u)}),a.on("StartRenderPage",u=>{if(this.destroyed)return;this.#e.get(u.pageIndex)._startRenderPage(u.transparency,u.cacheKey)}),a.on("commonobj",([u,b,n])=>{if(!this.destroyed&&!this.commonObjs.has(u))switch(b){case"Font":const x=this._params;if("error"in n){const r=n.error;(0,_util.warn)(`Error during font loading: ${r}`),this.commonObjs.resolve(u,r);break}const z=x.pdfBug&&globalThis.FontInspector?.enabled?(r,t)=>globalThis.FontInspector.fontAdded(r,t):null,W=new _font_loader.FontFaceObject(n,{isEvalSupported:x.isEvalSupported,disableFontFace:x.disableFontFace,ignoreErrors:x.ignoreErrors,inspectFont:z});this.fontLoader.bind(W).catch(r=>a.sendWithPromise("FontFallback",{id:u})).finally(()=>{!x.fontExtraProperties&&W.data&&(W.data=null),this.commonObjs.resolve(u,W)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(u,n);break;default:throw new Error(`Got unknown common object type ${b}`)}}),a.on("obj",([u,b,n,x])=>{if(this.destroyed)return;const z=this.#e.get(b);if(!z.objs.has(u))switch(n){case"Image":if(z.objs.resolve(u,x),x){let W;if(x.bitmap){const{width:r,height:t}=x;W=r*t*4}else W=x.data?.length||0;W>_util.MAX_IMAGE_SIZE_TO_CACHE&&(z._maybeCleanupAfterRender=!0)}break;case"Pattern":z.objs.resolve(u,x);break;default:throw new Error(`Got unknown object type ${n}`)}}),a.on("DocProgress",u=>{this.destroyed||I.onProgress?.({loaded:u.loaded,total:u.total})}),a.on("FetchBuiltInCMap",u=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(u):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),a.on("FetchStandardFontData",u=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(u):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:a,transfers:I}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:a,filename:this._fullReader?.filename??null},I).finally(()=>{this.annotationStorage.resetModified()})}getPage(a){if(!Number.isInteger(a)||a<=0||a>this._numPages)return Promise.reject(new Error("Invalid page request."));const I=a-1,u=this.#n.get(I);if(u)return u;const b=this.messageHandler.sendWithPromise("GetPage",{pageIndex:I}).then(n=>{if(this.destroyed)throw new Error("Transport destroyed");const x=new PDFPageProxy(I,n,this,this._params.pdfBug);return this.#e.set(I,x),x});return this.#n.set(I,b),b}getPageIndex(a){return typeof a!="object"||a===null||!Number.isInteger(a.num)||a.num<0||!Number.isInteger(a.gen)||a.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:a.num,gen:a.gen})}getAnnotations(a,I){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:a,intent:I})}getFieldObjects(){return this.#o("GetFieldObjects")}hasJSActions(){return this.#o("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(a){return typeof a!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:a})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#o("GetDocJSActions")}getPageJSActions(a){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:a})}getStructTree(a){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:a})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(a=>new _optional_content_config.OptionalContentConfig(a))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const a="GetMetadata",I=this.#t.get(a);if(I)return I;const u=this.messageHandler.sendWithPromise(a,null).then(b=>({info:b[0],metadata:b[1]?new _metadata.Metadata(b[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(a,u),u}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(a=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const I of this.#e.values())if(!I.cleanup())throw new Error(`startCleanup: Page ${I.pageNumber} is currently rendering.`);this.commonObjs.clear(),a||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:a,enableXfa:I}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:a,enableXfa:I})}}class PDFObjects{#t=Object.create(null);#e(a){return this.#t[a]||={capability:new _util.PromiseCapability,data:null}}get(a,I=null){if(I){const b=this.#e(a);return b.capability.promise.then(()=>I(b.data)),null}const u=this.#t[a];if(!u?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${a}.`);return u.data}has(a){return this.#t[a]?.capability.settled||!1}resolve(a,I=null){const u=this.#e(a);u.data=I,u.capability.resolve()}clear(){for(const a in this.#t){const{data:I}=this.#t[a];I?.bitmap?.close()}this.#t=Object.create(null)}}class RenderTask{#t=null;constructor(a){this.#t=a,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(a=0){this.#t.cancel(null,a)}get separateAnnots(){const{separateAnnots:a}=this.#t.operatorList;if(!a)return!1;const{annotationCanvasMap:I}=this.#t;return a.form||a.canvas&&I?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#t=new WeakSet;constructor({callback:a,params:I,objs:u,commonObjs:b,annotationCanvasMap:n,operatorList:x,pageIndex:z,canvasFactory:W,filterFactory:r,useRequestAnimationFrame:t=!1,pdfBug:i=!1,pageColors:h=null}){this.callback=a,this.params=I,this.objs=u,this.commonObjs=b,this.annotationCanvasMap=n,this.operatorListIdx=null,this.operatorList=x,this._pageIndex=z,this.canvasFactory=W,this.filterFactory=r,this._pdfBug=i,this.pageColors=h,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=t===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=I.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:a=!1,optionalContentConfig:I}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:u,viewport:b,transform:n,background:x}=this.params;this.gfx=new _canvas.CanvasGraphics(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:I},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:n,viewport:b,transparency:a,background:x}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(a=null,I=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),InternalRenderTask.#t.delete(this._canvas),this.callback(a||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,I))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),InternalRenderTask.#t.delete(this._canvas),this.callback())))}}const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.SerializableEmpty=a.PrintAnnotationStorage=a.AnnotationStorage=void 0;var u=I(1),b=I(4),n=I(8);const x=Object.freeze({map:null,hash:"",transfers:void 0});a.SerializableEmpty=x;class z{#t=!1;#e=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,i){const h=this.#e.get(t);return h===void 0?i:Object.assign(i,h)}getRawValue(t){return this.#e.get(t)}remove(t){if(this.#e.delete(t),this.#e.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const i of this.#e.values())if(i instanceof b.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(t,i){const h=this.#e.get(t);let c=!1;if(h!==void 0)for(const[e,g]of Object.entries(i))h[e]!==g&&(c=!0,h[e]=g);else c=!0,this.#e.set(t,i);c&&this.#n(),i instanceof b.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(i.constructor._type)}has(t){return this.#e.has(t)}getAll(){return this.#e.size>0?(0,u.objectFromMap)(this.#e):null}setAll(t){for(const[i,h]of Object.entries(t))this.setValue(i,h)}get size(){return this.#e.size}#n(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new W(this)}get serializable(){if(this.#e.size===0)return x;const t=new Map,i=new n.MurmurHash3_64,h=[],c=Object.create(null);let e=!1;for(const[g,v]of this.#e){const l=v instanceof b.AnnotationEditor?v.serialize(!1,c):v;l&&(t.set(g,l),i.update(`${g}:${JSON.stringify(l)}`),e||=!!l.bitmap)}if(e)for(const g of t.values())g.bitmap&&h.push(g.bitmap);return t.size>0?{map:t,hash:i.hexdigest(),transfers:h}:x}}a.AnnotationStorage=z;class W extends z{#t;constructor(t){super();const{map:i,hash:h,transfers:c}=t.serializable,e=structuredClone(i,c?{transfer:c}:null);this.#t={map:e,hash:h,transfers:c}}get print(){(0,u.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}}a.PrintAnnotationStorage=W}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.AnnotationEditor=void 0;var u=I(5),b=I(1),n=I(6);class x{#t="";#e=!1;#n=null;#i=null;#o=null;#a=!1;#s=null;#l=this.focusin.bind(this);#c=this.focusout.bind(this);#r=!1;#f=!1;#h=!1;_initialOptions=Object.create(null);_uiManager=null;_focusEventsAllowed=!0;_l10nPromise=null;#d=!1;#p=x._zIndex++;static _borderLineWidth=-1;static _colorManager=new u.ColorManager;static _zIndex=1;static SMALL_EDITOR_SIZE=0;constructor(r){this.constructor===x&&(0,b.unreachable)("Cannot initialize AnnotationEditor."),this.parent=r.parent,this.id=r.id,this.width=this.height=null,this.pageIndex=r.parent.pageIndex,this.name=r.name,this.div=null,this._uiManager=r.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=r.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:i,pageHeight:h,pageX:c,pageY:e}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,h],this.pageTranslation=[c,e];const[g,v]=this.parentDimensions;this.x=r.x/g,this.y=r.y/v,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,b.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(r){const t=new z({id:r.parent.getNextId(),parent:r.parent,uiManager:r._uiManager});t.annotationElementId=r.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(r,t=null){if(x._l10nPromise||=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(h=>[h,r.get(h)])),t?.strings)for(const h of t.strings)x._l10nPromise.set(h,r.get(h));if(x._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);x._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(r,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(r){return!1}static paste(r,t){(0,b.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#d}set _isDraggable(r){this.#d=r,this.div?.classList.toggle("draggable",r)}center(){const[r,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(r*2),this.y+=this.width*r/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(r*2),this.y-=this.width*r/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(r){this._uiManager.addCommands(r)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#p}setParent(r){r!==null&&(this.pageIndex=r.pageIndex,this.pageDimensions=r.pageDimensions),this.parent=r}focusin(r){this._focusEventsAllowed&&(this.#r?this.#r=!1:this.parent.setSelected(this))}focusout(r){!this._focusEventsAllowed||!this.isAttachedToDOM||r.relatedTarget?.closest(`#${this.id}`)||(r.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(r,t,i,h){const[c,e]=this.parentDimensions;[i,h]=this.screenToPageTranslation(i,h),this.x=(r+i)/c,this.y=(t+h)/e,this.fixAndSetPosition()}#v([r,t],i,h){[i,h]=this.screenToPageTranslation(i,h),this.x+=i/r,this.y+=h/t,this.fixAndSetPosition()}translate(r,t){this.#v(this.parentDimensions,r,t)}translateInPage(r,t){this.#v(this.pageDimensions,r,t),this.div.scrollIntoView({block:"nearest"})}drag(r,t){const[i,h]=this.parentDimensions;if(this.x+=r/i,this.y+=t/h,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:l,y:w}=this.div.getBoundingClientRect();this.parent.findNewParent(this,l,w)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:c,y:e}=this;const[g,v]=this.#m();c+=g,e+=v,this.div.style.left=`${(100*c).toFixed(2)}%`,this.div.style.top=`${(100*e).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}#m(){const[r,t]=this.parentDimensions,{_borderLineWidth:i}=x,h=i/r,c=i/t;switch(this.rotation){case 90:return[-h,c];case 180:return[h,c];case 270:return[h,-c];default:return[-h,-c]}}fixAndSetPosition(){const[r,t]=this.pageDimensions;let{x:i,y:h,width:c,height:e}=this;switch(c*=r,e*=t,i*=r,h*=t,this.rotation){case 0:i=Math.max(0,Math.min(r-c,i)),h=Math.max(0,Math.min(t-e,h));break;case 90:i=Math.max(0,Math.min(r-e,i)),h=Math.min(t,Math.max(c,h));break;case 180:i=Math.min(r,Math.max(c,i)),h=Math.min(t,Math.max(e,h));break;case 270:i=Math.min(r,Math.max(e,i)),h=Math.max(0,Math.min(t-c,h));break}this.x=i/=r,this.y=h/=t;const[g,v]=this.#m();i+=g,h+=v;const{style:l}=this.div;l.left=`${(100*i).toFixed(2)}%`,l.top=`${(100*h).toFixed(2)}%`,this.moveInDOM()}static#g(r,t,i){switch(i){case 90:return[t,-r];case 180:return[-r,-t];case 270:return[-t,r];default:return[r,t]}}screenToPageTranslation(r,t){return x.#g(r,t,this.parentRotation)}pageTranslationToScreen(r,t){return x.#g(r,t,360-this.parentRotation)}#u(r){switch(r){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:r,pageDimensions:[t,i]}=this,h=t*r,c=i*r;return b.FeatureTest.isCSSRoundSupported?[Math.round(h),Math.round(c)]:[h,c]}setDims(r,t){const[i,h]=this.parentDimensions;this.div.style.width=`${(100*r/i).toFixed(2)}%`,this.#a||(this.div.style.height=`${(100*t/h).toFixed(2)}%`),this.#n?.classList.toggle("small",r<x.SMALL_EDITOR_SIZE||t<x.SMALL_EDITOR_SIZE)}fixDims(){const{style:r}=this.div,{height:t,width:i}=r,h=i.endsWith("%"),c=!this.#a&&t.endsWith("%");if(h&&c)return;const[e,g]=this.parentDimensions;h||(r.width=`${(100*parseFloat(i)/e).toFixed(2)}%`),!this.#a&&!c&&(r.height=`${(100*parseFloat(t)/g).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#b(){if(this.#s)return;this.#s=document.createElement("div"),this.#s.classList.add("resizers");const r=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||r.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const t of r){const i=document.createElement("div");this.#s.append(i),i.classList.add("resizer",t),i.addEventListener("pointerdown",this.#E.bind(this,t)),i.addEventListener("contextmenu",n.noContextMenu)}this.div.prepend(this.#s)}#E(r,t){t.preventDefault();const{isMac:i}=b.FeatureTest.platform;if(t.button!==0||t.ctrlKey&&i)return;const h=this.#S.bind(this,r),c=this._isDraggable;this._isDraggable=!1;const e={passive:!0,capture:!0};window.addEventListener("pointermove",h,e);const g=this.x,v=this.y,l=this.width,w=this.height,M=this.parent.div.style.cursor,R=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const m=()=>{this._isDraggable=c,window.removeEventListener("pointerup",m),window.removeEventListener("blur",m),window.removeEventListener("pointermove",h,e),this.parent.div.style.cursor=M,this.div.style.cursor=R;const C=this.x,q=this.y,$=this.width,j=this.height;C===g&&q===v&&$===l&&j===w||this.addCommands({cmd:()=>{this.width=$,this.height=j,this.x=C,this.y=q;const[tt,nt]=this.parentDimensions;this.setDims(tt*$,nt*j),this.fixAndSetPosition()},undo:()=>{this.width=l,this.height=w,this.x=g,this.y=v;const[tt,nt]=this.parentDimensions;this.setDims(tt*l,nt*w),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",m),window.addEventListener("blur",m)}#S(r,t){const[i,h]=this.parentDimensions,c=this.x,e=this.y,g=this.width,v=this.height,l=x.MIN_SIZE/i,w=x.MIN_SIZE/h,M=T=>Math.round(T*1e4)/1e4,R=this.#u(this.rotation),m=(T,s)=>[R[0]*T+R[2]*s,R[1]*T+R[3]*s],C=this.#u(360-this.rotation),q=(T,s)=>[C[0]*T+C[2]*s,C[1]*T+C[3]*s];let $,j,tt=!1,nt=!1;switch(r){case"topLeft":tt=!0,$=(T,s)=>[0,0],j=(T,s)=>[T,s];break;case"topMiddle":$=(T,s)=>[T/2,0],j=(T,s)=>[T/2,s];break;case"topRight":tt=!0,$=(T,s)=>[T,0],j=(T,s)=>[0,s];break;case"middleRight":nt=!0,$=(T,s)=>[T,s/2],j=(T,s)=>[0,s/2];break;case"bottomRight":tt=!0,$=(T,s)=>[T,s],j=(T,s)=>[0,0];break;case"bottomMiddle":$=(T,s)=>[T/2,s],j=(T,s)=>[T/2,0];break;case"bottomLeft":tt=!0,$=(T,s)=>[0,s],j=(T,s)=>[T,0];break;case"middleLeft":nt=!0,$=(T,s)=>[0,s/2],j=(T,s)=>[T,s/2];break}const yt=$(g,v),dt=j(g,v);let vt=m(...dt);const Et=M(c+vt[0]),ct=M(e+vt[1]);let O=1,A=1,[f,p]=this.screenToPageTranslation(t.movementX,t.movementY);if([f,p]=q(f/i,p/h),tt){const T=Math.hypot(g,v);O=A=Math.max(Math.min(Math.hypot(dt[0]-yt[0]-f,dt[1]-yt[1]-p)/T,1/g,1/v),l/g,w/v)}else nt?O=Math.max(l,Math.min(1,Math.abs(dt[0]-yt[0]-f)))/g:A=Math.max(w,Math.min(1,Math.abs(dt[1]-yt[1]-p)))/v;const S=M(g*O),L=M(v*A);vt=m(...j(S,L));const F=Et-vt[0],H=ct-vt[1];this.width=S,this.height=L,this.x=F,this.y=H,this.setDims(i*S,h*L),this.fixAndSetPosition()}async addAltTextButton(){if(this.#n)return;const r=this.#n=document.createElement("button");r.className="altText";const t=await x._l10nPromise.get("editor_alt_text_button_label");r.textContent=t,r.setAttribute("aria-label",t),r.tabIndex="0",r.addEventListener("contextmenu",n.noContextMenu),r.addEventListener("pointerdown",i=>i.stopPropagation()),r.addEventListener("click",i=>{i.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),r.addEventListener("keydown",i=>{i.target===r&&i.key==="Enter"&&(i.preventDefault(),this._uiManager.editAltText(this))}),this.#P(),this.div.append(r),x.SMALL_EDITOR_SIZE||(x.SMALL_EDITOR_SIZE=Math.min(128,Math.round(r.getBoundingClientRect().width*1.4)))}async#P(){const r=this.#n;if(!r)return;if(!this.#t&&!this.#e){r.classList.remove("done"),this.#i?.remove();return}x._l10nPromise.get("editor_alt_text_edit_button_label").then(i=>{r.setAttribute("aria-label",i)});let t=this.#i;if(!t){this.#i=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip");const i=t.id=`alt-text-tooltip-${this.id}`;r.setAttribute("aria-describedby",i);const h=100;r.addEventListener("mouseenter",()=>{this.#o=setTimeout(()=>{this.#o=null,this.#i.classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},h)}),r.addEventListener("mouseleave",()=>{clearTimeout(this.#o),this.#o=null,this.#i?.classList.remove("show")})}r.classList.add("done"),t.innerText=this.#e?await x._l10nPromise.get("editor_alt_text_decorative_tooltip"):this.#t,t.parentNode||r.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:this.#t,decorative:this.#e}}set altTextData({altText:r,decorative:t}){this.#t===r&&this.#e===t||(this.#t=r,this.#e=t,this.#P())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#l),this.div.addEventListener("focusout",this.#c);const[r,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/r).toFixed(2)}%`,this.div.style.maxHeight=`${(100*r/t).toFixed(2)}%`);const[i,h]=this.getInitialTranslation();return this.translate(i,h),(0,u.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(r){const{isMac:t}=b.FeatureTest.platform;if(r.button!==0||r.ctrlKey&&t){r.preventDefault();return}this.#r=!0,this.#R(r)}#R(r){if(!this._isDraggable)return;const t=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let i,h;t&&(i={passive:!0,capture:!0},h=e=>{const[g,v]=this.screenToPageTranslation(e.movementX,e.movementY);this._uiManager.dragSelectedEditors(g,v)},window.addEventListener("pointermove",h,i));const c=()=>{if(window.removeEventListener("pointerup",c),window.removeEventListener("blur",c),t&&window.removeEventListener("pointermove",h,i),this.#r=!1,!this._uiManager.endDragSession()){const{isMac:e}=b.FeatureTest.platform;r.ctrlKey&&!e||r.shiftKey||r.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",c),window.addEventListener("blur",c)}moveInDOM(){this.parent?.moveEditorInDOM(this)}_setParentAndPosition(r,t,i){r.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition()}getRect(r,t){const i=this.parentScale,[h,c]=this.pageDimensions,[e,g]=this.pageTranslation,v=r/i,l=t/i,w=this.x*h,M=this.y*c,R=this.width*h,m=this.height*c;switch(this.rotation){case 0:return[w+v+e,c-M-l-m+g,w+v+R+e,c-M-l+g];case 90:return[w+l+e,c-M+v+g,w+l+m+e,c-M+v+R+g];case 180:return[w-v-R+e,c-M+l+g,w-v+e,c-M+l+m+g];case 270:return[w-l-m+e,c-M-v-R+g,w-l+e,c-M-v+g];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(r,t){const[i,h,c,e]=r,g=c-i,v=e-h;switch(this.rotation){case 0:return[i,t-e,g,v];case 90:return[i,t-h,v,g];case 180:return[c,t-h,g,v];case 270:return[c,t-e,v,g];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#h=!0}disableEditMode(){this.#h=!1}isInEditMode(){return this.#h}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#l),this.div?.addEventListener("focusout",this.#c)}serialize(r=!1,t=null){(0,b.unreachable)("An editor must be serializable")}static deserialize(r,t,i){const h=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i});h.rotation=r.rotation;const[c,e]=h.pageDimensions,[g,v,l,w]=h.getRectInCurrentCoords(r.rect,e);return h.x=g/c,h.y=v/e,h.width=l/c,h.height=w/e,h}remove(){this.div.removeEventListener("focusin",this.#l),this.div.removeEventListener("focusout",this.#c),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#n?.remove(),this.#n=null,this.#i=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#b(),this.#s.classList.remove("hidden"))}select(){this.makeResizable(),this.div?.classList.add("selectedEditor")}unselect(){this.#s?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(r,t){}disableEditing(){this.#n&&(this.#n.hidden=!0)}enableEditing(){this.#n&&(this.#n.hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return this.#f}set isEditing(r){this.#f=r,this.parent&&(r?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(r,t){this.#a=!0;const i=r/t,{style:h}=this.div;h.aspectRatio=i,h.height="auto"}static get MIN_SIZE(){return 16}}a.AnnotationEditor=x;class z extends x{constructor(r){super(r),this.annotationElementId=r.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.KeyboardManager=a.CommandManager=a.ColorManager=a.AnnotationEditorUIManager=void 0,a.bindEvents=n,a.opacityToHex=x;var u=I(1),b=I(6);function n(c,e,g){for(const v of g)e.addEventListener(v,c[v].bind(c))}function x(c){return Math.round(Math.min(255,Math.max(1,255*c))).toString(16).padStart(2,"0")}class z{#t=0;getId(){return`${u.AnnotationEditorPrefix}${this.#t++}`}}class W{#t=(0,u.getUuid)();#e=0;#n=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',v=new OffscreenCanvas(1,3).getContext("2d"),l=new Image;l.src=e;const w=l.decode().then(()=>(v.drawImage(l,0,0,1,1,0,0,1,3),new Uint32Array(v.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,u.shadow)(this,"_isSVGFittingCanvas",w)}async#i(e,g){this.#n||=new Map;let v=this.#n.get(e);if(v===null)return null;if(v?.bitmap)return v.refCounter+=1,v;try{v||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let l;if(typeof g=="string"){v.url=g;const w=await fetch(g);if(!w.ok)throw new Error(w.statusText);l=await w.blob()}else l=v.file=g;if(l.type==="image/svg+xml"){const w=W._isSVGFittingCanvas,M=new FileReader,R=new Image,m=new Promise((C,q)=>{R.onload=()=>{v.bitmap=R,v.isSvg=!0,C()},M.onload=async()=>{const $=v.svgUrl=M.result;R.src=await w?`${$}#svgView(preserveAspectRatio(none))`:$},R.onerror=M.onerror=q});M.readAsDataURL(l),await m}else v.bitmap=await createImageBitmap(l);v.refCounter=1}catch(l){console.error(l),v=null}return this.#n.set(e,v),v&&this.#n.set(v.id,v),v}async getFromFile(e){const{lastModified:g,name:v,size:l,type:w}=e;return this.#i(`${g}_${v}_${l}_${w}`,e)}async getFromUrl(e){return this.#i(e,e)}async getFromId(e){this.#n||=new Map;const g=this.#n.get(e);return g?g.bitmap?(g.refCounter+=1,g):g.file?this.getFromFile(g.file):this.getFromUrl(g.url):null}getSvgUrl(e){const g=this.#n.get(e);return g?.isSvg?g.svgUrl:null}deleteId(e){this.#n||=new Map;const g=this.#n.get(e);g&&(g.refCounter-=1,g.refCounter===0&&(g.bitmap=null))}isValidId(e){return e.startsWith(`image_${this.#t}_`)}}class r{#t=[];#e=!1;#n;#i=-1;constructor(e=128){this.#n=e}add({cmd:e,undo:g,mustExec:v,type:l=NaN,overwriteIfSameType:w=!1,keepUndo:M=!1}){if(v&&e(),this.#e)return;const R={cmd:e,undo:g,type:l};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(R);return}if(w&&this.#t[this.#i].type===l){M&&(R.undo=this.#t[this.#i].undo),this.#t[this.#i]=R;return}const m=this.#i+1;m===this.#n?this.#t.splice(0,1):(this.#i=m,m<this.#t.length&&this.#t.splice(m)),this.#t.push(R)}undo(){this.#i!==-1&&(this.#e=!0,this.#t[this.#i].undo(),this.#e=!1,this.#i-=1)}redo(){this.#i<this.#t.length-1&&(this.#i+=1,this.#e=!0,this.#t[this.#i].cmd(),this.#e=!1)}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}destroy(){this.#t=null}}a.CommandManager=r;class t{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:g}=u.FeatureTest.platform;for(const[v,l,w={}]of e)for(const M of v){const R=M.startsWith("mac+");g&&R?(this.callbacks.set(M.slice(4),{callback:l,options:w}),this.allKeys.add(M.split("+").at(-1))):!g&&!R&&(this.callbacks.set(M,{callback:l,options:w}),this.allKeys.add(M.split("+").at(-1)))}}#t(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const g=this.buffer.join("+");return this.buffer.length=0,g}exec(e,g){if(!this.allKeys.has(g.key))return;const v=this.callbacks.get(this.#t(g));if(!v)return;const{callback:l,options:{bubbles:w=!1,args:M=[],checker:R=null}}=v;R&&!R(e,g)||(l.bind(e,...M)(),w||(g.stopPropagation(),g.preventDefault()))}}a.KeyboardManager=t;class i{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return(0,b.getColorValues)(e),(0,u.shadow)(this,"_colors",e)}convert(e){const g=(0,b.getRGB)(e);if(!window.matchMedia("(forced-colors: active)").matches)return g;for(const[v,l]of this._colors)if(l.every((w,M)=>w===g[M]))return i._colorsMapping.get(v);return g}getHexCode(e){const g=this._colors.get(e);return g?u.Util.makeHexColor(...g):e}}a.ColorManager=i;class h{#t=null;#e=new Map;#n=new Map;#i=null;#o=null;#a=new r;#s=0;#l=new Set;#c=null;#r=null;#f=new Set;#h=null;#d=new z;#p=!1;#v=!1;#m=null;#g=u.AnnotationEditorType.NONE;#u=new Set;#b=null;#E=this.blur.bind(this);#S=this.focus.bind(this);#P=this.copy.bind(this);#R=this.cut.bind(this);#D=this.paste.bind(this);#I=this.keydown.bind(this);#O=this.onEditingAction.bind(this);#_=this.onPageChanging.bind(this);#L=this.onScaleChanging.bind(this);#x=this.onRotationChanging.bind(this);#k={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#y=[0,0];#T=null;#w=null;#N=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=h.prototype,g=w=>{const{activeElement:M}=document;return M&&w.#w.contains(M)&&w.hasSomethingToControl()},v=this.TRANSLATE_SMALL,l=this.TRANSLATE_BIG;return(0,u.shadow)(this,"_keyboardManager",new t([[["ctrl+a","mac+meta+a"],e.selectAll],[["ctrl+z","mac+meta+z"],e.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-v,0],checker:g}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-l,0],checker:g}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[v,0],checker:g}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[l,0],checker:g}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-v],checker:g}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-l],checker:g}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,v],checker:g}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,l],checker:g}]]))}constructor(e,g,v,l,w,M){this.#w=e,this.#N=g,this.#i=v,this._eventBus=l,this._eventBus._on("editingaction",this.#O),this._eventBus._on("pagechanging",this.#_),this._eventBus._on("scalechanging",this.#L),this._eventBus._on("rotationchanging",this.#x),this.#o=w.annotationStorage,this.#h=w.filterFactory,this.#b=M,this.viewParameters={realScale:b.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#M(),this.#j(),this._eventBus._off("editingaction",this.#O),this._eventBus._off("pagechanging",this.#_),this._eventBus._off("scalechanging",this.#L),this._eventBus._off("rotationchanging",this.#x);for(const e of this.#n.values())e.destroy();this.#n.clear(),this.#e.clear(),this.#f.clear(),this.#t=null,this.#u.clear(),this.#a.destroy(),this.#i.destroy()}get hcmFilter(){return(0,u.shadow)(this,"hcmFilter",this.#b?this.#h.addHCMFilter(this.#b.foreground,this.#b.background):"none")}get direction(){return(0,u.shadow)(this,"direction",getComputedStyle(this.#w).direction)}editAltText(e){this.#i?.editAltText(this,e)}onPageChanging({pageNumber:e}){this.#s=e-1}focusMainContainer(){this.#w.focus()}findParent(e,g){for(const v of this.#n.values()){const{x:l,y:w,width:M,height:R}=v.div.getBoundingClientRect();if(e>=l&&e<=l+M&&g>=w&&g<=w+R)return v}return null}disableUserSelect(e=!1){this.#N.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#f.add(e)}removeShouldRescale(e){this.#f.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*b.PixelsPerInch.PDF_TO_CSS_UNITS;for(const g of this.#f)g.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}addToAnnotationStorage(e){!e.isEmpty()&&this.#o&&!this.#o.has(e.id)&&this.#o.setValue(e.id,e)}#B(){window.addEventListener("focus",this.#S),window.addEventListener("blur",this.#E)}#j(){window.removeEventListener("focus",this.#S),window.removeEventListener("blur",this.#E)}blur(){if(!this.hasSelection)return;const{activeElement:e}=document;for(const g of this.#u)if(g.div.contains(e)){this.#m=[g,e],g._focusEventsAllowed=!1;break}}focus(){if(!this.#m)return;const[e,g]=this.#m;this.#m=null,g.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0}),g.focus()}#H(){window.addEventListener("keydown",this.#I,{capture:!0})}#M(){window.removeEventListener("keydown",this.#I,{capture:!0})}#F(){document.addEventListener("copy",this.#P),document.addEventListener("cut",this.#R),document.addEventListener("paste",this.#D)}#C(){document.removeEventListener("copy",this.#P),document.removeEventListener("cut",this.#R),document.removeEventListener("paste",this.#D)}addEditListeners(){this.#H(),this.#F()}removeEditListeners(){this.#M(),this.#C()}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const g=[];for(const v of this.#u){const l=v.serialize(!0);l&&g.push(l)}g.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(g))}cut(e){this.copy(e),this.delete()}paste(e){e.preventDefault();const{clipboardData:g}=e;for(const w of g.items)for(const M of this.#r)if(M.isHandlingMimeForPasting(w.type)){M.paste(w,this.currentLayer);return}let v=g.getData("application/pdfjs");if(!v)return;try{v=JSON.parse(v)}catch(w){(0,u.warn)(`paste: "${w.message}".`);return}if(!Array.isArray(v))return;this.unselectAll();const l=this.currentLayer;try{const w=[];for(const m of v){const C=l.deserialize(m);if(!C)return;w.push(C)}const M=()=>{for(const m of w)this.#z(m);this.#V(w)},R=()=>{for(const m of w)m.remove()};this.addCommands({cmd:M,undo:R,mustExec:!0})}catch(w){(0,u.warn)(`paste: "${w.message}".`)}}keydown(e){this.getActive()?.shouldGetKeyboardEvents()||h._keyboardManager.exec(this,e)}onEditingAction(e){["undo","redo","delete","selectAll"].includes(e.name)&&this[e.name]()}#A(e){Object.entries(e).some(([v,l])=>this.#k[v]!==l)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#k,e)})}#U(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#B(),this.#H(),this.#F(),this.#A({isEditing:this.#g!==u.AnnotationEditorType.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#a.hasSomethingToUndo(),hasSomethingToRedo:this.#a.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#j(),this.#M(),this.#C(),this.#A({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#r){this.#r=e;for(const g of this.#r)this.#U(g.defaultPropertiesToUpdate)}}getId(){return this.#d.getId()}get currentLayer(){return this.#n.get(this.#s)}getLayer(e){return this.#n.get(e)}get currentPageIndex(){return this.#s}addLayer(e){this.#n.set(e.pageIndex,e),this.#p?e.enable():e.disable()}removeLayer(e){this.#n.delete(e.pageIndex)}updateMode(e,g=null){if(this.#g!==e){if(this.#g=e,e===u.AnnotationEditorType.NONE){this.setEditingState(!1),this.#G();return}this.setEditingState(!0),this.#q(),this.unselectAll();for(const v of this.#n.values())v.updateMode(e);if(g){for(const v of this.#e.values())if(v.annotationElementId===g){this.setSelected(v),v.enterInEditMode();break}}}}updateToolbar(e){e!==this.#g&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,g){if(this.#r){if(e===u.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(e);return}for(const v of this.#u)v.updateParams(e,g);for(const v of this.#r)v.updateDefaultParams(e,g)}}enableWaiting(e=!1){if(this.#v!==e){this.#v=e;for(const g of this.#n.values())e?g.disableClick():g.enableClick(),g.div.classList.toggle("waiting",e)}}#q(){if(!this.#p){this.#p=!0;for(const e of this.#n.values())e.enable()}}#G(){if(this.unselectAll(),this.#p){this.#p=!1;for(const e of this.#n.values())e.disable()}}getEditors(e){const g=[];for(const v of this.#e.values())v.pageIndex===e&&g.push(v);return g}getEditor(e){return this.#e.get(e)}addEditor(e){this.#e.set(e.id,e)}removeEditor(e){this.#e.delete(e.id),this.unselect(e),(!e.annotationElementId||!this.#l.has(e.annotationElementId))&&this.#o?.remove(e.id)}addDeletedAnnotationElement(e){this.#l.add(e.annotationElementId),e.deleted=!0}isDeletedAnnotationElement(e){return this.#l.has(e)}removeDeletedAnnotationElement(e){this.#l.delete(e.annotationElementId),e.deleted=!1}#z(e){const g=this.#n.get(e.pageIndex);g?g.addOrRebuild(e):this.addEditor(e)}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#U(e.propertiesToUpdate))}toggleSelected(e){if(this.#u.has(e)){this.#u.delete(e),e.unselect(),this.#A({hasSelectedEditor:this.hasSelection});return}this.#u.add(e),e.select(),this.#U(e.propertiesToUpdate),this.#A({hasSelectedEditor:!0})}setSelected(e){for(const g of this.#u)g!==e&&g.unselect();this.#u.clear(),this.#u.add(e),e.select(),this.#U(e.propertiesToUpdate),this.#A({hasSelectedEditor:!0})}isSelected(e){return this.#u.has(e)}unselect(e){e.unselect(),this.#u.delete(e),this.#A({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#u.size!==0}undo(){this.#a.undo(),this.#A({hasSomethingToUndo:this.#a.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()})}redo(){this.#a.redo(),this.#A({hasSomethingToUndo:!0,hasSomethingToRedo:this.#a.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(e){this.#a.add(e),this.#A({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}#W(){if(this.#e.size===0)return!0;if(this.#e.size===1)for(const e of this.#e.values())return e.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const e=[...this.#u],g=()=>{for(const l of e)l.remove()},v=()=>{for(const l of e)this.#z(l)};this.addCommands({cmd:g,undo:v,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#V(e){this.#u.clear();for(const g of e)g.isEmpty()||(this.#u.add(g),g.select());this.#A({hasSelectedEditor:!0})}selectAll(){for(const e of this.#u)e.commit();this.#V(this.#e.values())}unselectAll(){if(this.#t){this.#t.commitOrRemove();return}if(this.hasSelection){for(const e of this.#u)e.unselect();this.#u.clear(),this.#A({hasSelectedEditor:!1})}}translateSelectedEditors(e,g,v=!1){if(v||this.commitOrRemove(),!this.hasSelection)return;this.#y[0]+=e,this.#y[1]+=g;const[l,w]=this.#y,M=[...this.#u],R=1e3;this.#T&&clearTimeout(this.#T),this.#T=setTimeout(()=>{this.#T=null,this.#y[0]=this.#y[1]=0,this.addCommands({cmd:()=>{for(const m of M)this.#e.has(m.id)&&m.translateInPage(l,w)},undo:()=>{for(const m of M)this.#e.has(m.id)&&m.translateInPage(-l,-w)},mustExec:!1})},R);for(const m of M)m.translateInPage(e,g)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#c=new Map;for(const e of this.#u)this.#c.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#c)return!1;this.disableUserSelect(!1);const e=this.#c;this.#c=null;let g=!1;for(const[{x:l,y:w,pageIndex:M},R]of e)R.newX=l,R.newY=w,R.newPageIndex=M,g||=l!==R.savedX||w!==R.savedY||M!==R.savedPageIndex;if(!g)return!1;const v=(l,w,M,R)=>{if(this.#e.has(l.id)){const m=this.#n.get(R);m?l._setParentAndPosition(m,w,M):(l.pageIndex=R,l.x=w,l.y=M)}};return this.addCommands({cmd:()=>{for(const[l,{newX:w,newY:M,newPageIndex:R}]of e)v(l,w,M,R)},undo:()=>{for(const[l,{savedX:w,savedY:M,savedPageIndex:R}]of e)v(l,w,M,R)},mustExec:!0}),!0}dragSelectedEditors(e,g){if(this.#c)for(const v of this.#c.keys())v.drag(e,g)}rebuild(e){if(e.parent===null){const g=this.getLayer(e.pageIndex);g?(g.changeParent(e),g.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#g}get imageManager(){return(0,u.shadow)(this,"imageManager",new W)}}a.AnnotationEditorUIManager=h}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.StatTimer=a.RenderingCancelledException=a.PixelsPerInch=a.PageViewport=a.PDFDateString=a.DOMStandardFontDataFactory=a.DOMSVGFactory=a.DOMFilterFactory=a.DOMCanvasFactory=a.DOMCMapReaderFactory=void 0,a.deprecated=q,a.getColorValues=yt,a.getCurrentTransform=dt,a.getCurrentTransformInverse=vt,a.getFilenameFromUrl=l,a.getPdfFilenameFromUrl=w,a.getRGB=nt,a.getXfaPageViewport=tt,a.isDataScheme=g,a.isPdfFile=v,a.isValidFetchUrl=R,a.loadScript=C,a.noContextMenu=m,a.setLayerDimensions=Et;var u=I(7),b=I(1);const n="http://www.w3.org/2000/svg";class x{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}a.PixelsPerInch=x;class z extends u.BaseFilterFactory{#t;#e;#n;#i;#o;#a;#s;#l;#c;#r;#f=0;constructor({docId:O,ownerDocument:A=globalThis.document}={}){super(),this.#n=O,this.#i=A}get#h(){return this.#t||=new Map}get#d(){if(!this.#e){const O=this.#i.createElement("div"),{style:A}=O;A.visibility="hidden",A.contain="strict",A.width=A.height=0,A.position="absolute",A.top=A.left=0,A.zIndex=-1;const f=this.#i.createElementNS(n,"svg");f.setAttribute("width",0),f.setAttribute("height",0),this.#e=this.#i.createElementNS(n,"defs"),O.append(f),f.append(this.#e),this.#i.body.append(O)}return this.#e}addFilter(O){if(!O)return"none";let A=this.#h.get(O);if(A)return A;let f,p,S,L;if(O.length===1){const s=O[0],_=new Array(256);for(let E=0;E<256;E++)_[E]=s[E]/255;L=f=p=S=_.join(",")}else{const[s,_,E]=O,P=new Array(256),k=new Array(256),U=new Array(256);for(let X=0;X<256;X++)P[X]=s[X]/255,k[X]=_[X]/255,U[X]=E[X]/255;f=P.join(","),p=k.join(","),S=U.join(","),L=`${f}${p}${S}`}if(A=this.#h.get(L),A)return this.#h.set(O,A),A;const F=`g_${this.#n}_transfer_map_${this.#f++}`,H=`url(#${F})`;this.#h.set(O,H),this.#h.set(L,H);const T=this.#v(F);return this.#g(f,p,S,T),H}addHCMFilter(O,A){const f=`${O}-${A}`;if(this.#a===f)return this.#s;if(this.#a=f,this.#s="none",this.#o?.remove(),!O||!A)return this.#s;const p=this.#u(O);O=b.Util.makeHexColor(...p);const S=this.#u(A);if(A=b.Util.makeHexColor(...S),this.#d.style.color="",O==="#000000"&&A==="#ffffff"||O===A)return this.#s;const L=new Array(256);for(let _=0;_<=255;_++){const E=_/255;L[_]=E<=.03928?E/12.92:((E+.055)/1.055)**2.4}const F=L.join(","),H=`g_${this.#n}_hcm_filter`,T=this.#l=this.#v(H);this.#g(F,F,F,T),this.#p(T);const s=(_,E)=>{const P=p[_]/255,k=S[_]/255,U=new Array(E+1);for(let X=0;X<=E;X++)U[X]=P+X/E*(k-P);return U.join(",")};return this.#g(s(0,5),s(1,5),s(2,5),T),this.#s=`url(#${H})`,this.#s}addHighlightHCMFilter(O,A,f,p){const S=`${O}-${A}-${f}-${p}`;if(this.#c===S)return this.#r;if(this.#c=S,this.#r="none",this.#l?.remove(),!O||!A)return this.#r;const[L,F]=[O,A].map(this.#u.bind(this));let H=Math.round(.2126*L[0]+.7152*L[1]+.0722*L[2]),T=Math.round(.2126*F[0]+.7152*F[1]+.0722*F[2]),[s,_]=[f,p].map(this.#u.bind(this));T<H&&([H,T,s,_]=[T,H,_,s]),this.#d.style.color="";const E=(U,X,it)=>{const At=new Array(256),rt=(T-H)/it,st=U/255,ut=(X-U)/(255*it);let ht=0;for(let gt=0;gt<=it;gt++){const Ct=Math.round(H+gt*rt),Lt=st+gt*ut;for(let Bt=ht;Bt<=Ct;Bt++)At[Bt]=Lt;ht=Ct+1}for(let gt=ht;gt<256;gt++)At[gt]=At[ht-1];return At.join(",")},P=`g_${this.#n}_hcm_highlight_filter`,k=this.#l=this.#v(P);return this.#p(k),this.#g(E(s[0],_[0],5),E(s[1],_[1],5),E(s[2],_[2],5),k),this.#r=`url(#${P})`,this.#r}destroy(O=!1){O&&(this.#s||this.#r)||(this.#e&&(this.#e.parentNode.parentNode.remove(),this.#e=null),this.#t&&(this.#t.clear(),this.#t=null),this.#f=0)}#p(O){const A=this.#i.createElementNS(n,"feColorMatrix");A.setAttribute("type","matrix"),A.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),O.append(A)}#v(O){const A=this.#i.createElementNS(n,"filter");return A.setAttribute("color-interpolation-filters","sRGB"),A.setAttribute("id",O),this.#d.append(A),A}#m(O,A,f){const p=this.#i.createElementNS(n,A);p.setAttribute("type","discrete"),p.setAttribute("tableValues",f),O.append(p)}#g(O,A,f,p){const S=this.#i.createElementNS(n,"feComponentTransfer");p.append(S),this.#m(S,"feFuncR",O),this.#m(S,"feFuncG",A),this.#m(S,"feFuncB",f)}#u(O){return this.#d.style.color=O,nt(getComputedStyle(this.#d).getPropertyValue("color"))}}a.DOMFilterFactory=z;class W extends u.BaseCanvasFactory{constructor({ownerDocument:O=globalThis.document}={}){super(),this._document=O}_createCanvas(O,A){const f=this._document.createElement("canvas");return f.width=O,f.height=A,f}}a.DOMCanvasFactory=W;async function r(ct,O=!1){if(R(ct,document.baseURI)){const A=await fetch(ct);if(!A.ok)throw new Error(A.statusText);return O?new Uint8Array(await A.arrayBuffer()):(0,b.stringToBytes)(await A.text())}return new Promise((A,f)=>{const p=new XMLHttpRequest;p.open("GET",ct,!0),O&&(p.responseType="arraybuffer"),p.onreadystatechange=()=>{if(p.readyState===XMLHttpRequest.DONE){if(p.status===200||p.status===0){let S;if(O&&p.response?S=new Uint8Array(p.response):!O&&p.responseText&&(S=(0,b.stringToBytes)(p.responseText)),S){A(S);return}}f(new Error(p.statusText))}},p.send(null)})}class t extends u.BaseCMapReaderFactory{_fetchData(O,A){return r(O,this.isCompressed).then(f=>({cMapData:f,compressionType:A}))}}a.DOMCMapReaderFactory=t;class i extends u.BaseStandardFontDataFactory{_fetchData(O){return r(O,!0)}}a.DOMStandardFontDataFactory=i;class h extends u.BaseSVGFactory{_createSVG(O){return document.createElementNS(n,O)}}a.DOMSVGFactory=h;class c{constructor({viewBox:O,scale:A,rotation:f,offsetX:p=0,offsetY:S=0,dontFlip:L=!1}){this.viewBox=O,this.scale=A,this.rotation=f,this.offsetX=p,this.offsetY=S;const F=(O[2]+O[0])/2,H=(O[3]+O[1])/2;let T,s,_,E;switch(f%=360,f<0&&(f+=360),f){case 180:T=-1,s=0,_=0,E=1;break;case 90:T=0,s=1,_=1,E=0;break;case 270:T=0,s=-1,_=-1,E=0;break;case 0:T=1,s=0,_=0,E=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}L&&(_=-_,E=-E);let P,k,U,X;T===0?(P=Math.abs(H-O[1])*A+p,k=Math.abs(F-O[0])*A+S,U=(O[3]-O[1])*A,X=(O[2]-O[0])*A):(P=Math.abs(F-O[0])*A+p,k=Math.abs(H-O[1])*A+S,U=(O[2]-O[0])*A,X=(O[3]-O[1])*A),this.transform=[T*A,s*A,_*A,E*A,P-T*A*F-_*A*H,k-s*A*F-E*A*H],this.width=U,this.height=X}get rawDims(){const{viewBox:O}=this;return(0,b.shadow)(this,"rawDims",{pageWidth:O[2]-O[0],pageHeight:O[3]-O[1],pageX:O[0],pageY:O[1]})}clone({scale:O=this.scale,rotation:A=this.rotation,offsetX:f=this.offsetX,offsetY:p=this.offsetY,dontFlip:S=!1}={}){return new c({viewBox:this.viewBox.slice(),scale:O,rotation:A,offsetX:f,offsetY:p,dontFlip:S})}convertToViewportPoint(O,A){return b.Util.applyTransform([O,A],this.transform)}convertToViewportRectangle(O){const A=b.Util.applyTransform([O[0],O[1]],this.transform),f=b.Util.applyTransform([O[2],O[3]],this.transform);return[A[0],A[1],f[0],f[1]]}convertToPdfPoint(O,A){return b.Util.applyInverseTransform([O,A],this.transform)}}a.PageViewport=c;class e extends b.BaseException{constructor(O,A=0){super(O,"RenderingCancelledException"),this.extraDelay=A}}a.RenderingCancelledException=e;function g(ct){const O=ct.length;let A=0;for(;A<O&&ct[A].trim()==="";)A++;return ct.substring(A,A+5).toLowerCase()==="data:"}function v(ct){return typeof ct=="string"&&/\.pdf$/i.test(ct)}function l(ct,O=!1){return O||([ct]=ct.split(/[#?]/,1)),ct.substring(ct.lastIndexOf("/")+1)}function w(ct,O="document.pdf"){if(typeof ct!="string")return O;if(g(ct))return(0,b.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),O;const A=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,f=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,p=A.exec(ct);let S=f.exec(p[1])||f.exec(p[2])||f.exec(p[3]);if(S&&(S=S[0],S.includes("%")))try{S=f.exec(decodeURIComponent(S))[0]}catch{}return S||O}class M{started=Object.create(null);times=[];time(O){O in this.started&&(0,b.warn)(`Timer is already running for ${O}`),this.started[O]=Date.now()}timeEnd(O){O in this.started||(0,b.warn)(`Timer has not been started for ${O}`),this.times.push({name:O,start:this.started[O],end:Date.now()}),delete this.started[O]}toString(){const O=[];let A=0;for(const{name:f}of this.times)A=Math.max(f.length,A);for(const{name:f,start:p,end:S}of this.times)O.push(`${f.padEnd(A)} ${S-p}ms
`);return O.join("")}}a.StatTimer=M;function R(ct,O){try{const{protocol:A}=O?new URL(ct,O):new URL(ct);return A==="http:"||A==="https:"}catch{return!1}}function m(ct){ct.preventDefault()}function C(ct,O=!1){return new Promise((A,f)=>{const p=document.createElement("script");p.src=ct,p.onload=function(S){O&&p.remove(),A(S)},p.onerror=function(){f(new Error(`Cannot load script at: ${p.src}`))},(document.head||document.documentElement).append(p)})}function q(ct){console.log("Deprecated API usage: "+ct)}let $;class j{static toDateObject(O){if(!O||typeof O!="string")return null;$||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const A=$.exec(O);if(!A)return null;const f=parseInt(A[1],10);let p=parseInt(A[2],10);p=p>=1&&p<=12?p-1:0;let S=parseInt(A[3],10);S=S>=1&&S<=31?S:1;let L=parseInt(A[4],10);L=L>=0&&L<=23?L:0;let F=parseInt(A[5],10);F=F>=0&&F<=59?F:0;let H=parseInt(A[6],10);H=H>=0&&H<=59?H:0;const T=A[7]||"Z";let s=parseInt(A[8],10);s=s>=0&&s<=23?s:0;let _=parseInt(A[9],10)||0;return _=_>=0&&_<=59?_:0,T==="-"?(L+=s,F+=_):T==="+"&&(L-=s,F-=_),new Date(Date.UTC(f,p,S,L,F,H))}}a.PDFDateString=j;function tt(ct,{scale:O=1,rotation:A=0}){const{width:f,height:p}=ct.attributes.style,S=[0,0,parseInt(f),parseInt(p)];return new c({viewBox:S,scale:O,rotation:A})}function nt(ct){if(ct.startsWith("#")){const O=parseInt(ct.slice(1),16);return[(O&16711680)>>16,(O&65280)>>8,O&255]}return ct.startsWith("rgb(")?ct.slice(4,-1).split(",").map(O=>parseInt(O)):ct.startsWith("rgba(")?ct.slice(5,-1).split(",").map(O=>parseInt(O)).slice(0,3):((0,b.warn)(`Not a valid color format: "${ct}"`),[0,0,0])}function yt(ct){const O=document.createElement("span");O.style.visibility="hidden",document.body.append(O);for(const A of ct.keys()){O.style.color=A;const f=window.getComputedStyle(O).color;ct.set(A,nt(f))}O.remove()}function dt(ct){const{a:O,b:A,c:f,d:p,e:S,f:L}=ct.getTransform();return[O,A,f,p,S,L]}function vt(ct){const{a:O,b:A,c:f,d:p,e:S,f:L}=ct.getTransform().invertSelf();return[O,A,f,p,S,L]}function Et(ct,O,A=!1,f=!0){if(O instanceof c){const{pageWidth:p,pageHeight:S}=O.rawDims,{style:L}=ct,F=b.FeatureTest.isCSSRoundSupported,H=`var(--scale-factor) * ${p}px`,T=`var(--scale-factor) * ${S}px`,s=F?`round(${H}, 1px)`:`calc(${H})`,_=F?`round(${T}, 1px)`:`calc(${T})`;!A||O.rotation%180===0?(L.width=s,L.height=_):(L.width=_,L.height=s)}f&&ct.setAttribute("data-main-rotation",O.rotation)}}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BaseStandardFontDataFactory=a.BaseSVGFactory=a.BaseFilterFactory=a.BaseCanvasFactory=a.BaseCMapReaderFactory=void 0;var u=I(1);class b{constructor(){this.constructor===b&&(0,u.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(t){return"none"}addHCMFilter(t,i){return"none"}addHighlightHCMFilter(t,i,h,c){return"none"}destroy(t=!1){}}a.BaseFilterFactory=b;class n{constructor(){this.constructor===n&&(0,u.unreachable)("Cannot initialize BaseCanvasFactory.")}create(t,i){if(t<=0||i<=0)throw new Error("Invalid canvas size");const h=this._createCanvas(t,i);return{canvas:h,context:h.getContext("2d")}}reset(t,i,h){if(!t.canvas)throw new Error("Canvas is not specified");if(i<=0||h<=0)throw new Error("Invalid canvas size");t.canvas.width=i,t.canvas.height=h}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,i){(0,u.unreachable)("Abstract method `_createCanvas` called.")}}a.BaseCanvasFactory=n;class x{constructor({baseUrl:t=null,isCompressed:i=!0}){this.constructor===x&&(0,u.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=t,this.isCompressed=i}async fetch({name:t}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!t)throw new Error("CMap name must be specified.");const i=this.baseUrl+t+(this.isCompressed?".bcmap":""),h=this.isCompressed?u.CMapCompressionType.BINARY:u.CMapCompressionType.NONE;return this._fetchData(i,h).catch(c=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${i}`)})}_fetchData(t,i){(0,u.unreachable)("Abstract method `_fetchData` called.")}}a.BaseCMapReaderFactory=x;class z{constructor({baseUrl:t=null}){this.constructor===z&&(0,u.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!t)throw new Error("Font filename must be specified.");const i=`${this.baseUrl}${t}`;return this._fetchData(i).catch(h=>{throw new Error(`Unable to load font data at: ${i}`)})}_fetchData(t){(0,u.unreachable)("Abstract method `_fetchData` called.")}}a.BaseStandardFontDataFactory=z;class W{constructor(){this.constructor===W&&(0,u.unreachable)("Cannot initialize BaseSVGFactory.")}create(t,i,h=!1){if(t<=0||i<=0)throw new Error("Invalid SVG dimensions");const c=this._createSVG("svg:svg");return c.setAttribute("version","1.1"),h||(c.setAttribute("width",`${t}px`),c.setAttribute("height",`${i}px`)),c.setAttribute("preserveAspectRatio","none"),c.setAttribute("viewBox",`0 0 ${t} ${i}`),c}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){(0,u.unreachable)("Abstract method `_createSVG` called.")}}a.BaseSVGFactory=W}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.MurmurHash3_64=void 0;var u=I(1);const b=3285377520,n=4294901760,x=65535;class z{constructor(r){this.h1=r?r&4294967295:b,this.h2=r?r&4294967295:b}update(r){let t,i;if(typeof r=="string"){t=new Uint8Array(r.length*2),i=0;for(let q=0,$=r.length;q<$;q++){const j=r.charCodeAt(q);j<=255?t[i++]=j:(t[i++]=j>>>8,t[i++]=j&255)}}else if((0,u.isArrayBuffer)(r))t=r.slice(),i=t.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const h=i>>2,c=i-h*4,e=new Uint32Array(t.buffer,0,h);let g=0,v=0,l=this.h1,w=this.h2;const M=3432918353,R=461845907,m=M&x,C=R&x;for(let q=0;q<h;q++)q&1?(g=e[q],g=g*M&n|g*m&x,g=g<<15|g>>>17,g=g*R&n|g*C&x,l^=g,l=l<<13|l>>>19,l=l*5+3864292196):(v=e[q],v=v*M&n|v*m&x,v=v<<15|v>>>17,v=v*R&n|v*C&x,w^=v,w=w<<13|w>>>19,w=w*5+3864292196);switch(g=0,c){case 3:g^=t[h*4+2]<<16;case 2:g^=t[h*4+1]<<8;case 1:g^=t[h*4],g=g*M&n|g*m&x,g=g<<15|g>>>17,g=g*R&n|g*C&x,h&1?l^=g:w^=g}this.h1=l,this.h2=w}hexdigest(){let r=this.h1,t=this.h2;return r^=t>>>1,r=r*3981806797&n|r*36045&x,t=t*4283543511&n|((t<<16|r>>>16)*2950163797&n)>>>16,r^=t>>>1,r=r*444984403&n|r*60499&x,t=t*3301882366&n|((t<<16|r>>>16)*3120437893&n)>>>16,r^=t>>>1,(r>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}a.MurmurHash3_64=z}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.FontLoader=a.FontFaceObject=void 0;var u=I(1);class b{#t=new Set;constructor({ownerDocument:z=globalThis.document,styleElement:W=null}){this._document=z,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(z){this.nativeFontFaces.add(z),this._document.fonts.add(z)}removeNativeFontFace(z){this.nativeFontFaces.delete(z),this._document.fonts.delete(z)}insertRule(z){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const W=this.styleElement.sheet;W.insertRule(z,W.cssRules.length)}clear(){for(const z of this.nativeFontFaces)this._document.fonts.delete(z);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(z){if(!(!z||this.#t.has(z.loadedName))){if((0,u.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:W,src:r,style:t}=z,i=new FontFace(W,r,t);this.addNativeFontFace(i);try{await i.load(),this.#t.add(W)}catch{(0,u.warn)(`Cannot load system font: ${z.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(i)}return}(0,u.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(z){if(z.attached||z.missingFile&&!z.systemFontInfo)return;if(z.attached=!0,z.systemFontInfo){await this.loadSystemFont(z.systemFontInfo);return}if(this.isFontLoadingAPISupported){const r=z.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(t){throw(0,u.warn)(`Failed to load font '${r.family}': '${t}'.`),z.disableFontFace=!0,t}}return}const W=z.createFontFaceRule();if(W){if(this.insertRule(W),this.isSyncFontLoadingSupported)return;await new Promise(r=>{const t=this._queueLoadingCallback(r);this._prepareFontLoadEvent(z,t)})}}get isFontLoadingAPISupported(){const z=!!this._document?.fonts;return(0,u.shadow)(this,"isFontLoadingAPISupported",z)}get isSyncFontLoadingSupported(){let z=!1;return(u.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(z=!0),(0,u.shadow)(this,"isSyncFontLoadingSupported",z)}_queueLoadingCallback(z){function W(){for((0,u.assert)(!t.done,"completeRequest() cannot be called twice."),t.done=!0;r.length>0&&r[0].done;){const i=r.shift();setTimeout(i.callback,0)}}const{loadingRequests:r}=this,t={done:!1,complete:W,callback:z};return r.push(t),t}get _loadTestFont(){const z=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,u.shadow)(this,"_loadTestFont",z)}_prepareFontLoadEvent(z,W){function r(tt,nt){return tt.charCodeAt(nt)<<24|tt.charCodeAt(nt+1)<<16|tt.charCodeAt(nt+2)<<8|tt.charCodeAt(nt+3)&255}function t(tt,nt,yt,dt){const vt=tt.substring(0,nt),Et=tt.substring(nt+yt);return vt+dt+Et}let i,h;const c=this._document.createElement("canvas");c.width=1,c.height=1;const e=c.getContext("2d");let g=0;function v(tt,nt){if(++g>30){(0,u.warn)("Load test font never loaded."),nt();return}if(e.font="30px "+tt,e.fillText(".",0,20),e.getImageData(0,0,1,1).data[3]>0){nt();return}setTimeout(v.bind(null,tt,nt))}const l=`lt${Date.now()}${this.loadTestFontId++}`;let w=this._loadTestFont;w=t(w,976,l.length,l);const R=16,m=1482184792;let C=r(w,R);for(i=0,h=l.length-3;i<h;i+=4)C=C-m+r(l,i)|0;i<l.length&&(C=C-m+r(l+"XXX",i)|0),w=t(w,R,4,(0,u.string32)(C));const q=`url(data:font/opentype;base64,${btoa(w)});`,$=`@font-face {font-family:"${l}";src:${q}}`;this.insertRule($);const j=this._document.createElement("div");j.style.visibility="hidden",j.style.width=j.style.height="10px",j.style.position="absolute",j.style.top=j.style.left="0px";for(const tt of[z.loadedName,l]){const nt=this._document.createElement("span");nt.textContent="Hi",nt.style.fontFamily=tt,j.append(nt)}this._document.body.append(j),v(l,()=>{j.remove(),W.complete()})}}a.FontLoader=b;class n{constructor(z,{isEvalSupported:W=!0,disableFontFace:r=!1,ignoreErrors:t=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const h in z)this[h]=z[h];this.isEvalSupported=W!==!1,this.disableFontFace=r===!0,this.ignoreErrors=t===!0,this._inspectFont=i}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let z;if(!this.cssFontInfo)z=new FontFace(this.loadedName,this.data,{});else{const W={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(W.style=`oblique ${this.cssFontInfo.italicAngle}deg`),z=new FontFace(this.cssFontInfo.fontFamily,this.data,W)}return this._inspectFont?.(this),z}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const z=(0,u.bytesToString)(this.data),W=`url(data:${this.mimetype};base64,${btoa(z)});`;let r;if(!this.cssFontInfo)r=`@font-face {font-family:"${this.loadedName}";src:${W}}`;else{let t=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(t+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),r=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${t}src:${W}}`}return this._inspectFont?.(this,W),r}getPathGenerator(z,W){if(this.compiledGlyphs[W]!==void 0)return this.compiledGlyphs[W];let r;try{r=z.get(this.loadedName+"_path_"+W)}catch(t){if(!this.ignoreErrors)throw t;return(0,u.warn)(`getPathGenerator - ignoring character: "${t}".`),this.compiledGlyphs[W]=function(i,h){}}if(this.isEvalSupported&&u.FeatureTest.isEvalSupported){const t=[];for(const i of r){const h=i.args!==void 0?i.args.join(","):"";t.push("c.",i.cmd,"(",h,`);
`)}return this.compiledGlyphs[W]=new Function("c","size",t.join(""))}return this.compiledGlyphs[W]=function(t,i){for(const h of r)h.cmd==="scale"&&(h.args=[i,-i]),t[h.cmd].apply(t,h.args)}}}a.FontFaceObject=n}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.NodeStandardFontDataFactory=a.NodeFilterFactory=a.NodeCanvasFactory=a.NodeCMapReaderFactory=void 0;var u=I(7);I(1);const b=function(r){return new Promise((t,i)=>{require$$5.readFile(r,(c,e)=>{if(c||!e){i(new Error(c));return}t(new Uint8Array(e))})})};class n extends u.BaseFilterFactory{}a.NodeFilterFactory=n;class x extends u.BaseCanvasFactory{_createCanvas(t,i){return require$$5.createCanvas(t,i)}}a.NodeCanvasFactory=x;class z extends u.BaseCMapReaderFactory{_fetchData(t,i){return b(t).then(h=>({cMapData:h,compressionType:i}))}}a.NodeCMapReaderFactory=z;class W extends u.BaseStandardFontDataFactory{_fetchData(t){return b(t)}}a.NodeStandardFontDataFactory=W}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.CanvasGraphics=void 0;var u=I(1),b=I(6),n=I(12),x=I(13);const z=16,W=100,r=4096,t=15,i=10,h=1e3,c=16;function e(A,f){if(A._removeMirroring)throw new Error("Context is already forwarding operations.");A.__originalSave=A.save,A.__originalRestore=A.restore,A.__originalRotate=A.rotate,A.__originalScale=A.scale,A.__originalTranslate=A.translate,A.__originalTransform=A.transform,A.__originalSetTransform=A.setTransform,A.__originalResetTransform=A.resetTransform,A.__originalClip=A.clip,A.__originalMoveTo=A.moveTo,A.__originalLineTo=A.lineTo,A.__originalBezierCurveTo=A.bezierCurveTo,A.__originalRect=A.rect,A.__originalClosePath=A.closePath,A.__originalBeginPath=A.beginPath,A._removeMirroring=()=>{A.save=A.__originalSave,A.restore=A.__originalRestore,A.rotate=A.__originalRotate,A.scale=A.__originalScale,A.translate=A.__originalTranslate,A.transform=A.__originalTransform,A.setTransform=A.__originalSetTransform,A.resetTransform=A.__originalResetTransform,A.clip=A.__originalClip,A.moveTo=A.__originalMoveTo,A.lineTo=A.__originalLineTo,A.bezierCurveTo=A.__originalBezierCurveTo,A.rect=A.__originalRect,A.closePath=A.__originalClosePath,A.beginPath=A.__originalBeginPath,delete A._removeMirroring},A.save=function(){f.save(),this.__originalSave()},A.restore=function(){f.restore(),this.__originalRestore()},A.translate=function(S,L){f.translate(S,L),this.__originalTranslate(S,L)},A.scale=function(S,L){f.scale(S,L),this.__originalScale(S,L)},A.transform=function(S,L,F,H,T,s){f.transform(S,L,F,H,T,s),this.__originalTransform(S,L,F,H,T,s)},A.setTransform=function(S,L,F,H,T,s){f.setTransform(S,L,F,H,T,s),this.__originalSetTransform(S,L,F,H,T,s)},A.resetTransform=function(){f.resetTransform(),this.__originalResetTransform()},A.rotate=function(S){f.rotate(S),this.__originalRotate(S)},A.clip=function(S){f.clip(S),this.__originalClip(S)},A.moveTo=function(p,S){f.moveTo(p,S),this.__originalMoveTo(p,S)},A.lineTo=function(p,S){f.lineTo(p,S),this.__originalLineTo(p,S)},A.bezierCurveTo=function(p,S,L,F,H,T){f.bezierCurveTo(p,S,L,F,H,T),this.__originalBezierCurveTo(p,S,L,F,H,T)},A.rect=function(p,S,L,F){f.rect(p,S,L,F),this.__originalRect(p,S,L,F)},A.closePath=function(){f.closePath(),this.__originalClosePath()},A.beginPath=function(){f.beginPath(),this.__originalBeginPath()}}class g{constructor(f){this.canvasFactory=f,this.cache=Object.create(null)}getCanvas(f,p,S){let L;return this.cache[f]!==void 0?(L=this.cache[f],this.canvasFactory.reset(L,p,S)):(L=this.canvasFactory.create(p,S),this.cache[f]=L),L}delete(f){delete this.cache[f]}clear(){for(const f in this.cache){const p=this.cache[f];this.canvasFactory.destroy(p),delete this.cache[f]}}}function v(A,f,p,S,L,F,H,T,s,_){const[E,P,k,U,X,it]=(0,b.getCurrentTransform)(A);if(P===0&&k===0){const st=H*E+X,ut=Math.round(st),ht=T*U+it,gt=Math.round(ht),Ct=(H+s)*E+X,Lt=Math.abs(Math.round(Ct)-ut)||1,Bt=(T+_)*U+it,Xt=Math.abs(Math.round(Bt)-gt)||1;return A.setTransform(Math.sign(E),0,0,Math.sign(U),ut,gt),A.drawImage(f,p,S,L,F,0,0,Lt,Xt),A.setTransform(E,P,k,U,X,it),[Lt,Xt]}if(E===0&&U===0){const st=T*k+X,ut=Math.round(st),ht=H*P+it,gt=Math.round(ht),Ct=(T+_)*k+X,Lt=Math.abs(Math.round(Ct)-ut)||1,Bt=(H+s)*P+it,Xt=Math.abs(Math.round(Bt)-gt)||1;return A.setTransform(0,Math.sign(P),Math.sign(k),0,ut,gt),A.drawImage(f,p,S,L,F,0,0,Xt,Lt),A.setTransform(E,P,k,U,X,it),[Xt,Lt]}A.drawImage(f,p,S,L,F,H,T,s,_);const At=Math.hypot(E,P),rt=Math.hypot(k,U);return[At*s,rt*_]}function l(A){const{width:f,height:p}=A;if(f>h||p>h)return null;const S=1e3,L=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),F=f+1;let H=new Uint8Array(F*(p+1)),T,s,_;const E=f+7&-8;let P=new Uint8Array(E*p),k=0;for(const rt of A.data){let st=128;for(;st>0;)P[k++]=rt&st?0:255,st>>=1}let U=0;for(k=0,P[k]!==0&&(H[0]=1,++U),s=1;s<f;s++)P[k]!==P[k+1]&&(H[s]=P[k]?2:1,++U),k++;for(P[k]!==0&&(H[s]=2,++U),T=1;T<p;T++){k=T*E,_=T*F,P[k-E]!==P[k]&&(H[_]=P[k]?1:8,++U);let rt=(P[k]?4:0)+(P[k-E]?8:0);for(s=1;s<f;s++)rt=(rt>>2)+(P[k+1]?4:0)+(P[k-E+1]?8:0),L[rt]&&(H[_+s]=L[rt],++U),k++;if(P[k-E]!==P[k]&&(H[_+s]=P[k]?2:4,++U),U>S)return null}for(k=E*(p-1),_=T*F,P[k]!==0&&(H[_]=8,++U),s=1;s<f;s++)P[k]!==P[k+1]&&(H[_+s]=P[k]?4:8,++U),k++;if(P[k]!==0&&(H[_+s]=4,++U),U>S)return null;const X=new Int32Array([0,F,-1,0,-F,0,0,0,1]),it=new Path2D;for(T=0;U&&T<=p;T++){let rt=T*F;const st=rt+f;for(;rt<st&&!H[rt];)rt++;if(rt===st)continue;it.moveTo(rt%F,T);const ut=rt;let ht=H[rt];do{const gt=X[ht];do rt+=gt;while(!H[rt]);const Ct=H[rt];Ct!==5&&Ct!==10?(ht=Ct,H[rt]=0):(ht=Ct&51*ht>>4,H[rt]&=ht>>2|ht<<2),it.lineTo(rt%F,rt/F|0),H[rt]||--U}while(ut!==rt);--T}return P=null,H=null,function(rt){rt.save(),rt.scale(1/f,-1/p),rt.translate(0,-p),rt.fill(it),rt.beginPath(),rt.restore()}}class w{constructor(f,p){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=u.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=u.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=u.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,f,p])}clone(){const f=Object.create(this);return f.clipBox=this.clipBox.slice(),f}setCurrentPoint(f,p){this.x=f,this.y=p}updatePathMinMax(f,p,S){[p,S]=u.Util.applyTransform([p,S],f),this.minX=Math.min(this.minX,p),this.minY=Math.min(this.minY,S),this.maxX=Math.max(this.maxX,p),this.maxY=Math.max(this.maxY,S)}updateRectMinMax(f,p){const S=u.Util.applyTransform(p,f),L=u.Util.applyTransform(p.slice(2),f);this.minX=Math.min(this.minX,S[0],L[0]),this.minY=Math.min(this.minY,S[1],L[1]),this.maxX=Math.max(this.maxX,S[0],L[0]),this.maxY=Math.max(this.maxY,S[1],L[1])}updateScalingPathMinMax(f,p){u.Util.scaleMinMax(f,p),this.minX=Math.min(this.minX,p[0]),this.maxX=Math.max(this.maxX,p[1]),this.minY=Math.min(this.minY,p[2]),this.maxY=Math.max(this.maxY,p[3])}updateCurvePathMinMax(f,p,S,L,F,H,T,s,_,E){const P=u.Util.bezierBoundingBox(p,S,L,F,H,T,s,_);if(E){E[0]=Math.min(E[0],P[0],P[2]),E[1]=Math.max(E[1],P[0],P[2]),E[2]=Math.min(E[2],P[1],P[3]),E[3]=Math.max(E[3],P[1],P[3]);return}this.updateRectMinMax(f,P)}getPathBoundingBox(f=n.PathType.FILL,p=null){const S=[this.minX,this.minY,this.maxX,this.maxY];if(f===n.PathType.STROKE){p||(0,u.unreachable)("Stroke bounding box must include transform.");const L=u.Util.singularValueDecompose2dScale(p),F=L[0]*this.lineWidth/2,H=L[1]*this.lineWidth/2;S[0]-=F,S[1]-=H,S[2]+=F,S[3]+=H}return S}updateClipFromPath(){const f=u.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(f||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(f){this.clipBox=f,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(f=n.PathType.FILL,p=null){return u.Util.intersect(this.clipBox,this.getPathBoundingBox(f,p))}}function M(A,f){if(typeof ImageData<"u"&&f instanceof ImageData){A.putImageData(f,0,0);return}const p=f.height,S=f.width,L=p%c,F=(p-L)/c,H=L===0?F:F+1,T=A.createImageData(S,c);let s=0,_;const E=f.data,P=T.data;let k,U,X,it;if(f.kind===u.ImageKind.GRAYSCALE_1BPP){const At=E.byteLength,rt=new Uint32Array(P.buffer,0,P.byteLength>>2),st=rt.length,ut=S+7>>3,ht=4294967295,gt=u.FeatureTest.isLittleEndian?4278190080:255;for(k=0;k<H;k++){for(X=k<F?c:L,_=0,U=0;U<X;U++){const Ct=At-s;let Lt=0;const Bt=Ct>ut?S:Ct*8-7,Xt=Bt&-8;let $t=0,ne=0;for(;Lt<Xt;Lt+=8)ne=E[s++],rt[_++]=ne&128?ht:gt,rt[_++]=ne&64?ht:gt,rt[_++]=ne&32?ht:gt,rt[_++]=ne&16?ht:gt,rt[_++]=ne&8?ht:gt,rt[_++]=ne&4?ht:gt,rt[_++]=ne&2?ht:gt,rt[_++]=ne&1?ht:gt;for(;Lt<Bt;Lt++)$t===0&&(ne=E[s++],$t=128),rt[_++]=ne&$t?ht:gt,$t>>=1}for(;_<st;)rt[_++]=0;A.putImageData(T,0,k*c)}}else if(f.kind===u.ImageKind.RGBA_32BPP){for(U=0,it=S*c*4,k=0;k<F;k++)P.set(E.subarray(s,s+it)),s+=it,A.putImageData(T,0,U),U+=c;k<H&&(it=S*L*4,P.set(E.subarray(s,s+it)),A.putImageData(T,0,U))}else if(f.kind===u.ImageKind.RGB_24BPP)for(X=c,it=S*X,k=0;k<H;k++){for(k>=F&&(X=L,it=S*X),_=0,U=it;U--;)P[_++]=E[s++],P[_++]=E[s++],P[_++]=E[s++],P[_++]=255;A.putImageData(T,0,k*c)}else throw new Error(`bad image kind: ${f.kind}`)}function R(A,f){if(f.bitmap){A.drawImage(f.bitmap,0,0);return}const p=f.height,S=f.width,L=p%c,F=(p-L)/c,H=L===0?F:F+1,T=A.createImageData(S,c);let s=0;const _=f.data,E=T.data;for(let P=0;P<H;P++){const k=P<F?c:L;({srcPos:s}=(0,x.convertBlackAndWhiteToRGBA)({src:_,srcPos:s,dest:E,width:S,height:k,nonBlackColor:0})),A.putImageData(T,0,P*c)}}function m(A,f){const p=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const S of p)A[S]!==void 0&&(f[S]=A[S]);A.setLineDash!==void 0&&(f.setLineDash(A.getLineDash()),f.lineDashOffset=A.lineDashOffset)}function C(A){if(A.strokeStyle=A.fillStyle="#000000",A.fillRule="nonzero",A.globalAlpha=1,A.lineWidth=1,A.lineCap="butt",A.lineJoin="miter",A.miterLimit=10,A.globalCompositeOperation="source-over",A.font="10px sans-serif",A.setLineDash!==void 0&&(A.setLineDash([]),A.lineDashOffset=0),!u.isNodeJS){const{filter:f}=A;f!=="none"&&f!==""&&(A.filter="none")}}function q(A,f,p,S){const L=A.length;for(let F=3;F<L;F+=4){const H=A[F];if(H===0)A[F-3]=f,A[F-2]=p,A[F-1]=S;else if(H<255){const T=255-H;A[F-3]=A[F-3]*H+f*T>>8,A[F-2]=A[F-2]*H+p*T>>8,A[F-1]=A[F-1]*H+S*T>>8}}}function $(A,f,p){const S=A.length,L=1/255;for(let F=3;F<S;F+=4){const H=p?p[A[F]]:A[F];f[F]=f[F]*H*L|0}}function j(A,f,p){const S=A.length;for(let L=3;L<S;L+=4){const F=A[L-3]*77+A[L-2]*152+A[L-1]*28;f[L]=p?f[L]*p[F>>8]>>8:f[L]*F>>16}}function tt(A,f,p,S,L,F,H,T,s,_,E){const P=!!F,k=P?F[0]:0,U=P?F[1]:0,X=P?F[2]:0,it=L==="Luminosity"?j:$,rt=Math.min(S,Math.ceil(1048576/p));for(let st=0;st<S;st+=rt){const ut=Math.min(rt,S-st),ht=A.getImageData(T-_,st+(s-E),p,ut),gt=f.getImageData(T,st+s,p,ut);P&&q(ht.data,k,U,X),it(ht.data,gt.data,H),f.putImageData(gt,T,st+s)}}function nt(A,f,p,S){const L=S[0],F=S[1],H=S[2]-L,T=S[3]-F;H===0||T===0||(tt(f.context,p,H,T,f.subtype,f.backdrop,f.transferMap,L,F,f.offsetX,f.offsetY),A.save(),A.globalAlpha=1,A.globalCompositeOperation="source-over",A.setTransform(1,0,0,1,0,0),A.drawImage(p.canvas,0,0),A.restore())}function yt(A,f){const p=u.Util.singularValueDecompose2dScale(A);p[0]=Math.fround(p[0]),p[1]=Math.fround(p[1]);const S=Math.fround((globalThis.devicePixelRatio||1)*b.PixelsPerInch.PDF_TO_CSS_UNITS);return f!==void 0?f:p[0]<=S||p[1]<=S}const dt=["butt","round","square"],vt=["miter","round","bevel"],Et={},ct={};class O{constructor(f,p,S,L,F,{optionalContentConfig:H,markedContentStack:T=null},s,_){this.ctx=f,this.current=new w(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=p,this.objs=S,this.canvasFactory=L,this.filterFactory=F,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=T||[],this.optionalContentConfig=H,this.cachedCanvases=new g(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=s,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=_,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(f,p=null){return typeof f=="string"?f.startsWith("g_")?this.commonObjs.get(f):this.objs.get(f):p}beginDrawing({transform:f,viewport:p,transparency:S=!1,background:L=null}){const F=this.ctx.canvas.width,H=this.ctx.canvas.height,T=this.ctx.fillStyle;if(this.ctx.fillStyle=L||"#ffffff",this.ctx.fillRect(0,0,F,H),this.ctx.fillStyle=T,S){const s=this.cachedCanvases.getCanvas("transparent",F,H);this.compositeCtx=this.ctx,this.transparentCanvas=s.canvas,this.ctx=s.context,this.ctx.save(),this.ctx.transform(...(0,b.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),C(this.ctx),f&&(this.ctx.transform(...f),this.outputScaleX=f[0],this.outputScaleY=f[0]),this.ctx.transform(...p.transform),this.viewportScale=p.scale,this.baseTransform=(0,b.getCurrentTransform)(this.ctx)}executeOperatorList(f,p,S,L){const F=f.argsArray,H=f.fnArray;let T=p||0;const s=F.length;if(s===T)return T;const _=s-T>i&&typeof S=="function",E=_?Date.now()+t:0;let P=0;const k=this.commonObjs,U=this.objs;let X;for(;;){if(L!==void 0&&T===L.nextBreakPoint)return L.breakIt(T,S),T;if(X=H[T],X!==u.OPS.dependency)this[X].apply(this,F[T]);else for(const it of F[T]){const At=it.startsWith("g_")?k:U;if(!At.has(it))return At.get(it,S),T}if(T++,T===s)return T;if(_&&++P>i){if(Date.now()>E)return S(),T;P=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const f of this._cachedBitmapsMap.values()){for(const p of f.values())typeof HTMLCanvasElement<"u"&&p instanceof HTMLCanvasElement&&(p.width=p.height=0);f.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const f=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(f!=="none"){const p=this.ctx.filter;this.ctx.filter=f,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=p}}}_scaleImage(f,p){const S=f.width,L=f.height;let F=Math.max(Math.hypot(p[0],p[1]),1),H=Math.max(Math.hypot(p[2],p[3]),1),T=S,s=L,_="prescale1",E,P;for(;F>2&&T>1||H>2&&s>1;){let k=T,U=s;F>2&&T>1&&(k=T>=16384?Math.floor(T/2)-1||1:Math.ceil(T/2),F/=T/k),H>2&&s>1&&(U=s>=16384?Math.floor(s/2)-1||1:Math.ceil(s)/2,H/=s/U),E=this.cachedCanvases.getCanvas(_,k,U),P=E.context,P.clearRect(0,0,k,U),P.drawImage(f,0,0,T,s,0,0,k,U),f=E.canvas,T=k,s=U,_=_==="prescale1"?"prescale2":"prescale1"}return{img:f,paintWidth:T,paintHeight:s}}_createMaskCanvas(f){const p=this.ctx,{width:S,height:L}=f,F=this.current.fillColor,H=this.current.patternFill,T=(0,b.getCurrentTransform)(p);let s,_,E,P;if((f.bitmap||f.data)&&f.count>1){const Lt=f.bitmap||f.data.buffer;_=JSON.stringify(H?T:[T.slice(0,4),F]),s=this._cachedBitmapsMap.get(Lt),s||(s=new Map,this._cachedBitmapsMap.set(Lt,s));const Bt=s.get(_);if(Bt&&!H){const Xt=Math.round(Math.min(T[0],T[2])+T[4]),$t=Math.round(Math.min(T[1],T[3])+T[5]);return{canvas:Bt,offsetX:Xt,offsetY:$t}}E=Bt}E||(P=this.cachedCanvases.getCanvas("maskCanvas",S,L),R(P.context,f));let k=u.Util.transform(T,[1/S,0,0,-1/L,0,0]);k=u.Util.transform(k,[1,0,0,1,0,-L]);const U=u.Util.applyTransform([0,0],k),X=u.Util.applyTransform([S,L],k),it=u.Util.normalizeRect([U[0],U[1],X[0],X[1]]),At=Math.round(it[2]-it[0])||1,rt=Math.round(it[3]-it[1])||1,st=this.cachedCanvases.getCanvas("fillCanvas",At,rt),ut=st.context,ht=Math.min(U[0],X[0]),gt=Math.min(U[1],X[1]);ut.translate(-ht,-gt),ut.transform(...k),E||(E=this._scaleImage(P.canvas,(0,b.getCurrentTransformInverse)(ut)),E=E.img,s&&H&&s.set(_,E)),ut.imageSmoothingEnabled=yt((0,b.getCurrentTransform)(ut),f.interpolate),v(ut,E,0,0,E.width,E.height,0,0,S,L),ut.globalCompositeOperation="source-in";const Ct=u.Util.transform((0,b.getCurrentTransformInverse)(ut),[1,0,0,1,-ht,-gt]);return ut.fillStyle=H?F.getPattern(p,this,Ct,n.PathType.FILL):F,ut.fillRect(0,0,S,L),s&&!H&&(this.cachedCanvases.delete("fillCanvas"),s.set(_,st.canvas)),{canvas:st.canvas,offsetX:Math.round(ht),offsetY:Math.round(gt)}}setLineWidth(f){f!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=f,this.ctx.lineWidth=f}setLineCap(f){this.ctx.lineCap=dt[f]}setLineJoin(f){this.ctx.lineJoin=vt[f]}setMiterLimit(f){this.ctx.miterLimit=f}setDash(f,p){const S=this.ctx;S.setLineDash!==void 0&&(S.setLineDash(f),S.lineDashOffset=p)}setRenderingIntent(f){}setFlatness(f){}setGState(f){for(const[p,S]of f)switch(p){case"LW":this.setLineWidth(S);break;case"LC":this.setLineCap(S);break;case"LJ":this.setLineJoin(S);break;case"ML":this.setMiterLimit(S);break;case"D":this.setDash(S[0],S[1]);break;case"RI":this.setRenderingIntent(S);break;case"FL":this.setFlatness(S);break;case"Font":this.setFont(S[0],S[1]);break;case"CA":this.current.strokeAlpha=S;break;case"ca":this.current.fillAlpha=S,this.ctx.globalAlpha=S;break;case"BM":this.ctx.globalCompositeOperation=S;break;case"SMask":this.current.activeSMask=S?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(S);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const f=this.inSMaskMode;this.current.activeSMask&&!f?this.beginSMaskMode():!this.current.activeSMask&&f&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const f=this.ctx.canvas.width,p=this.ctx.canvas.height,S="smaskGroupAt"+this.groupLevel,L=this.cachedCanvases.getCanvas(S,f,p);this.suspendedCtx=this.ctx,this.ctx=L.context;const F=this.ctx;F.setTransform(...(0,b.getCurrentTransform)(this.suspendedCtx)),m(this.suspendedCtx,F),e(F,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),m(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(f){if(!this.current.activeSMask)return;f?(f[0]=Math.floor(f[0]),f[1]=Math.floor(f[1]),f[2]=Math.ceil(f[2]),f[3]=Math.ceil(f[3])):f=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const p=this.current.activeSMask,S=this.suspendedCtx;nt(S,p,this.ctx,f),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(m(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const f=this.current;this.stateStack.push(f),this.current=f.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),m(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(f,p,S,L,F,H){this.ctx.transform(f,p,S,L,F,H),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(f,p,S){const L=this.ctx,F=this.current;let H=F.x,T=F.y,s,_;const E=(0,b.getCurrentTransform)(L),P=E[0]===0&&E[3]===0||E[1]===0&&E[2]===0,k=P?S.slice(0):null;for(let U=0,X=0,it=f.length;U<it;U++)switch(f[U]|0){case u.OPS.rectangle:H=p[X++],T=p[X++];const At=p[X++],rt=p[X++],st=H+At,ut=T+rt;L.moveTo(H,T),At===0||rt===0?L.lineTo(st,ut):(L.lineTo(st,T),L.lineTo(st,ut),L.lineTo(H,ut)),P||F.updateRectMinMax(E,[H,T,st,ut]),L.closePath();break;case u.OPS.moveTo:H=p[X++],T=p[X++],L.moveTo(H,T),P||F.updatePathMinMax(E,H,T);break;case u.OPS.lineTo:H=p[X++],T=p[X++],L.lineTo(H,T),P||F.updatePathMinMax(E,H,T);break;case u.OPS.curveTo:s=H,_=T,H=p[X+4],T=p[X+5],L.bezierCurveTo(p[X],p[X+1],p[X+2],p[X+3],H,T),F.updateCurvePathMinMax(E,s,_,p[X],p[X+1],p[X+2],p[X+3],H,T,k),X+=6;break;case u.OPS.curveTo2:s=H,_=T,L.bezierCurveTo(H,T,p[X],p[X+1],p[X+2],p[X+3]),F.updateCurvePathMinMax(E,s,_,H,T,p[X],p[X+1],p[X+2],p[X+3],k),H=p[X+2],T=p[X+3],X+=4;break;case u.OPS.curveTo3:s=H,_=T,H=p[X+2],T=p[X+3],L.bezierCurveTo(p[X],p[X+1],H,T,H,T),F.updateCurvePathMinMax(E,s,_,p[X],p[X+1],H,T,H,T,k),X+=4;break;case u.OPS.closePath:L.closePath();break}P&&F.updateScalingPathMinMax(E,k),F.setCurrentPoint(H,T)}closePath(){this.ctx.closePath()}stroke(f=!0){const p=this.ctx,S=this.current.strokeColor;p.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof S=="object"&&S?.getPattern?(p.save(),p.strokeStyle=S.getPattern(p,this,(0,b.getCurrentTransformInverse)(p),n.PathType.STROKE),this.rescaleAndStroke(!1),p.restore()):this.rescaleAndStroke(!0)),f&&this.consumePath(this.current.getClippedPathBoundingBox()),p.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(f=!0){const p=this.ctx,S=this.current.fillColor,L=this.current.patternFill;let F=!1;L&&(p.save(),p.fillStyle=S.getPattern(p,this,(0,b.getCurrentTransformInverse)(p),n.PathType.FILL),F=!0);const H=this.current.getClippedPathBoundingBox();this.contentVisible&&H!==null&&(this.pendingEOFill?(p.fill("evenodd"),this.pendingEOFill=!1):p.fill()),F&&p.restore(),f&&this.consumePath(H)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Et}eoClip(){this.pendingClip=ct}beginText(){this.current.textMatrix=u.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const f=this.pendingTextPaths,p=this.ctx;if(f===void 0){p.beginPath();return}p.save(),p.beginPath();for(const S of f)p.setTransform(...S.transform),p.translate(S.x,S.y),S.addToPath(p,S.fontSize);p.restore(),p.clip(),p.beginPath(),delete this.pendingTextPaths}setCharSpacing(f){this.current.charSpacing=f}setWordSpacing(f){this.current.wordSpacing=f}setHScale(f){this.current.textHScale=f/100}setLeading(f){this.current.leading=-f}setFont(f,p){const S=this.commonObjs.get(f),L=this.current;if(!S)throw new Error(`Can't find font for ${f}`);if(L.fontMatrix=S.fontMatrix||u.FONT_IDENTITY_MATRIX,(L.fontMatrix[0]===0||L.fontMatrix[3]===0)&&(0,u.warn)("Invalid font matrix for font "+f),p<0?(p=-p,L.fontDirection=-1):L.fontDirection=1,this.current.font=S,this.current.fontSize=p,S.isType3Font)return;const F=S.loadedName||"sans-serif",H=S.systemFontInfo?.css||`"${F}", ${S.fallbackName}`;let T="normal";S.black?T="900":S.bold&&(T="bold");const s=S.italic?"italic":"normal";let _=p;p<z?_=z:p>W&&(_=W),this.current.fontSizeScale=p/_,this.ctx.font=`${s} ${T} ${_}px ${H}`}setTextRenderingMode(f){this.current.textRenderingMode=f}setTextRise(f){this.current.textRise=f}moveText(f,p){this.current.x=this.current.lineX+=f,this.current.y=this.current.lineY+=p}setLeadingMoveText(f,p){this.setLeading(-p),this.moveText(f,p)}setTextMatrix(f,p,S,L,F,H){this.current.textMatrix=[f,p,S,L,F,H],this.current.textMatrixScale=Math.hypot(f,p),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(f,p,S,L){const F=this.ctx,H=this.current,T=H.font,s=H.textRenderingMode,_=H.fontSize/H.fontSizeScale,E=s&u.TextRenderingMode.FILL_STROKE_MASK,P=!!(s&u.TextRenderingMode.ADD_TO_PATH_FLAG),k=H.patternFill&&!T.missingFile;let U;(T.disableFontFace||P||k)&&(U=T.getPathGenerator(this.commonObjs,f)),T.disableFontFace||k?(F.save(),F.translate(p,S),F.beginPath(),U(F,_),L&&F.setTransform(...L),(E===u.TextRenderingMode.FILL||E===u.TextRenderingMode.FILL_STROKE)&&F.fill(),(E===u.TextRenderingMode.STROKE||E===u.TextRenderingMode.FILL_STROKE)&&F.stroke(),F.restore()):((E===u.TextRenderingMode.FILL||E===u.TextRenderingMode.FILL_STROKE)&&F.fillText(f,p,S),(E===u.TextRenderingMode.STROKE||E===u.TextRenderingMode.FILL_STROKE)&&F.strokeText(f,p,S)),P&&(this.pendingTextPaths||=[]).push({transform:(0,b.getCurrentTransform)(F),x:p,y:S,fontSize:_,addToPath:U})}get isFontSubpixelAAEnabled(){const{context:f}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);f.scale(1.5,1),f.fillText("I",0,10);const p=f.getImageData(0,0,10,10).data;let S=!1;for(let L=3;L<p.length;L+=4)if(p[L]>0&&p[L]<255){S=!0;break}return(0,u.shadow)(this,"isFontSubpixelAAEnabled",S)}showText(f){const p=this.current,S=p.font;if(S.isType3Font)return this.showType3Text(f);const L=p.fontSize;if(L===0)return;const F=this.ctx,H=p.fontSizeScale,T=p.charSpacing,s=p.wordSpacing,_=p.fontDirection,E=p.textHScale*_,P=f.length,k=S.vertical,U=k?1:-1,X=S.defaultVMetrics,it=L*p.fontMatrix[0],At=p.textRenderingMode===u.TextRenderingMode.FILL&&!S.disableFontFace&&!p.patternFill;F.save(),F.transform(...p.textMatrix),F.translate(p.x,p.y+p.textRise),_>0?F.scale(E,-1):F.scale(E,1);let rt;if(p.patternFill){F.save();const Ct=p.fillColor.getPattern(F,this,(0,b.getCurrentTransformInverse)(F),n.PathType.FILL);rt=(0,b.getCurrentTransform)(F),F.restore(),F.fillStyle=Ct}let st=p.lineWidth;const ut=p.textMatrixScale;if(ut===0||st===0){const Ct=p.textRenderingMode&u.TextRenderingMode.FILL_STROKE_MASK;(Ct===u.TextRenderingMode.STROKE||Ct===u.TextRenderingMode.FILL_STROKE)&&(st=this.getSinglePixelWidth())}else st/=ut;if(H!==1&&(F.scale(H,H),st/=H),F.lineWidth=st,S.isInvalidPDFjsFont){const Ct=[];let Lt=0;for(const Bt of f)Ct.push(Bt.unicode),Lt+=Bt.width;F.fillText(Ct.join(""),0,0),p.x+=Lt*it*E,F.restore(),this.compose();return}let ht=0,gt;for(gt=0;gt<P;++gt){const Ct=f[gt];if(typeof Ct=="number"){ht+=U*Ct*L/1e3;continue}let Lt=!1;const Bt=(Ct.isSpace?s:0)+T,Xt=Ct.fontChar,$t=Ct.accent;let ne,ke,Ae=Ct.width;if(k){const Pe=Ct.vmetric||X,Oe=-(Ct.vmetric?Pe[1]:Ae*.5)*it,qe=Pe[2]*it;Ae=Pe?-Pe[0]:Ae,ne=Oe/H,ke=(ht+qe)/H}else ne=ht/H,ke=0;if(S.remeasure&&Ae>0){const Pe=F.measureText(Xt).width*1e3/L*H;if(Ae<Pe&&this.isFontSubpixelAAEnabled){const Oe=Ae/Pe;Lt=!0,F.save(),F.scale(Oe,1),ne/=Oe}else Ae!==Pe&&(ne+=(Ae-Pe)/2e3*L/H)}if(this.contentVisible&&(Ct.isInFont||S.missingFile)){if(At&&!$t)F.fillText(Xt,ne,ke);else if(this.paintChar(Xt,ne,ke,rt),$t){const Pe=ne+L*$t.offset.x/H,Oe=ke-L*$t.offset.y/H;this.paintChar($t.fontChar,Pe,Oe,rt)}}const He=k?Ae*it-Bt*_:Ae*it+Bt*_;ht+=He,Lt&&F.restore()}k?p.y-=ht:p.x+=ht*E,F.restore(),this.compose()}showType3Text(f){const p=this.ctx,S=this.current,L=S.font,F=S.fontSize,H=S.fontDirection,T=L.vertical?1:-1,s=S.charSpacing,_=S.wordSpacing,E=S.textHScale*H,P=S.fontMatrix||u.FONT_IDENTITY_MATRIX,k=f.length,U=S.textRenderingMode===u.TextRenderingMode.INVISIBLE;let X,it,At,rt;if(!(U||F===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,p.save(),p.transform(...S.textMatrix),p.translate(S.x,S.y),p.scale(E,H),X=0;X<k;++X){if(it=f[X],typeof it=="number"){rt=T*it*F/1e3,this.ctx.translate(rt,0),S.x+=rt*E;continue}const st=(it.isSpace?_:0)+s,ut=L.charProcOperatorList[it.operatorListId];if(!ut){(0,u.warn)(`Type3 character "${it.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=it,this.save(),p.scale(F,F),p.transform(...P),this.executeOperatorList(ut),this.restore()),At=u.Util.applyTransform([it.width,0],P)[0]*F+st,p.translate(At,0),S.x+=At*E}p.restore(),this.processingType3=null}}setCharWidth(f,p){}setCharWidthAndBounds(f,p,S,L,F,H){this.ctx.rect(S,L,F-S,H-L),this.ctx.clip(),this.endPath()}getColorN_Pattern(f){let p;if(f[0]==="TilingPattern"){const S=f[1],L=this.baseTransform||(0,b.getCurrentTransform)(this.ctx),F={createCanvasGraphics:H=>new O(H,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};p=new n.TilingPattern(f,S,this.ctx,F,L)}else p=this._getPattern(f[1],f[2]);return p}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(f,p,S){const L=u.Util.makeHexColor(f,p,S);this.ctx.strokeStyle=L,this.current.strokeColor=L}setFillRGBColor(f,p,S){const L=u.Util.makeHexColor(f,p,S);this.ctx.fillStyle=L,this.current.fillColor=L,this.current.patternFill=!1}_getPattern(f,p=null){let S;return this.cachedPatterns.has(f)?S=this.cachedPatterns.get(f):(S=(0,n.getShadingPattern)(this.getObject(f)),this.cachedPatterns.set(f,S)),p&&(S.matrix=p),S}shadingFill(f){if(!this.contentVisible)return;const p=this.ctx;this.save();const S=this._getPattern(f);p.fillStyle=S.getPattern(p,this,(0,b.getCurrentTransformInverse)(p),n.PathType.SHADING);const L=(0,b.getCurrentTransformInverse)(p);if(L){const{width:F,height:H}=p.canvas,[T,s,_,E]=u.Util.getAxialAlignedBoundingBox([0,0,F,H],L);this.ctx.fillRect(T,s,_-T,E-s)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,u.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,u.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(f,p){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(f)&&f.length===6&&this.transform(...f),this.baseTransform=(0,b.getCurrentTransform)(this.ctx),p)){const S=p[2]-p[0],L=p[3]-p[1];this.ctx.rect(p[0],p[1],S,L),this.current.updateRectMinMax((0,b.getCurrentTransform)(this.ctx),p),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(f){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const p=this.ctx;f.isolated||(0,u.info)("TODO: Support non-isolated groups."),f.knockout&&(0,u.warn)("Knockout groups not supported.");const S=(0,b.getCurrentTransform)(p);if(f.matrix&&p.transform(...f.matrix),!f.bbox)throw new Error("Bounding box is required.");let L=u.Util.getAxialAlignedBoundingBox(f.bbox,(0,b.getCurrentTransform)(p));const F=[0,0,p.canvas.width,p.canvas.height];L=u.Util.intersect(L,F)||[0,0,0,0];const H=Math.floor(L[0]),T=Math.floor(L[1]);let s=Math.max(Math.ceil(L[2])-H,1),_=Math.max(Math.ceil(L[3])-T,1),E=1,P=1;s>r&&(E=s/r,s=r),_>r&&(P=_/r,_=r),this.current.startNewPathAndClipBox([0,0,s,_]);let k="groupAt"+this.groupLevel;f.smask&&(k+="_smask_"+this.smaskCounter++%2);const U=this.cachedCanvases.getCanvas(k,s,_),X=U.context;X.scale(1/E,1/P),X.translate(-H,-T),X.transform(...S),f.smask?this.smaskStack.push({canvas:U.canvas,context:X,offsetX:H,offsetY:T,scaleX:E,scaleY:P,subtype:f.smask.subtype,backdrop:f.smask.backdrop,transferMap:f.smask.transferMap||null,startTransformInverse:null}):(p.setTransform(1,0,0,1,0,0),p.translate(H,T),p.scale(E,P),p.save()),m(p,X),this.ctx=X,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(p),this.groupLevel++}endGroup(f){if(!this.contentVisible)return;this.groupLevel--;const p=this.ctx,S=this.groupStack.pop();if(this.ctx=S,this.ctx.imageSmoothingEnabled=!1,f.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const L=(0,b.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...L);const F=u.Util.getAxialAlignedBoundingBox([0,0,p.canvas.width,p.canvas.height],L);this.ctx.drawImage(p.canvas,0,0),this.ctx.restore(),this.compose(F)}}beginAnnotation(f,p,S,L,F){if(this.#t(),C(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(p)&&p.length===4){const H=p[2]-p[0],T=p[3]-p[1];if(F&&this.annotationCanvasMap){S=S.slice(),S[4]-=p[0],S[5]-=p[1],p=p.slice(),p[0]=p[1]=0,p[2]=H,p[3]=T;const[s,_]=u.Util.singularValueDecompose2dScale((0,b.getCurrentTransform)(this.ctx)),{viewportScale:E}=this,P=Math.ceil(H*this.outputScaleX*E),k=Math.ceil(T*this.outputScaleY*E);this.annotationCanvas=this.canvasFactory.create(P,k);const{canvas:U,context:X}=this.annotationCanvas;this.annotationCanvasMap.set(f,U),this.annotationCanvas.savedCtx=this.ctx,this.ctx=X,this.ctx.save(),this.ctx.setTransform(s,0,0,-_,0,T*_),C(this.ctx)}else C(this.ctx),this.ctx.rect(p[0],p[1],H,T),this.ctx.clip(),this.endPath()}this.current=new w(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...S),this.transform(...L)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(f){if(!this.contentVisible)return;const p=f.count;f=this.getObject(f.data,f),f.count=p;const S=this.ctx,L=this.processingType3;if(L&&(L.compiled===void 0&&(L.compiled=l(f)),L.compiled)){L.compiled(S);return}const F=this._createMaskCanvas(f),H=F.canvas;S.save(),S.setTransform(1,0,0,1,0,0),S.drawImage(H,F.offsetX,F.offsetY),S.restore(),this.compose()}paintImageMaskXObjectRepeat(f,p,S=0,L=0,F,H){if(!this.contentVisible)return;f=this.getObject(f.data,f);const T=this.ctx;T.save();const s=(0,b.getCurrentTransform)(T);T.transform(p,S,L,F,0,0);const _=this._createMaskCanvas(f);T.setTransform(1,0,0,1,_.offsetX-s[4],_.offsetY-s[5]);for(let E=0,P=H.length;E<P;E+=2){const k=u.Util.transform(s,[p,S,L,F,H[E],H[E+1]]),[U,X]=u.Util.applyTransform([0,0],k);T.drawImage(_.canvas,U,X)}T.restore(),this.compose()}paintImageMaskXObjectGroup(f){if(!this.contentVisible)return;const p=this.ctx,S=this.current.fillColor,L=this.current.patternFill;for(const F of f){const{data:H,width:T,height:s,transform:_}=F,E=this.cachedCanvases.getCanvas("maskCanvas",T,s),P=E.context;P.save();const k=this.getObject(H,F);R(P,k),P.globalCompositeOperation="source-in",P.fillStyle=L?S.getPattern(P,this,(0,b.getCurrentTransformInverse)(p),n.PathType.FILL):S,P.fillRect(0,0,T,s),P.restore(),p.save(),p.transform(..._),p.scale(1,-1),v(p,E.canvas,0,0,T,s,0,-1,1,1),p.restore()}this.compose()}paintImageXObject(f){if(!this.contentVisible)return;const p=this.getObject(f);if(!p){(0,u.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(p)}paintImageXObjectRepeat(f,p,S,L){if(!this.contentVisible)return;const F=this.getObject(f);if(!F){(0,u.warn)("Dependent image isn't ready yet");return}const H=F.width,T=F.height,s=[];for(let _=0,E=L.length;_<E;_+=2)s.push({transform:[p,0,0,S,L[_],L[_+1]],x:0,y:0,w:H,h:T});this.paintInlineImageXObjectGroup(F,s)}applyTransferMapsToCanvas(f){return this.current.transferMaps!=="none"&&(f.filter=this.current.transferMaps,f.drawImage(f.canvas,0,0),f.filter="none"),f.canvas}applyTransferMapsToBitmap(f){if(this.current.transferMaps==="none")return f.bitmap;const{bitmap:p,width:S,height:L}=f,F=this.cachedCanvases.getCanvas("inlineImage",S,L),H=F.context;return H.filter=this.current.transferMaps,H.drawImage(p,0,0),H.filter="none",F.canvas}paintInlineImageXObject(f){if(!this.contentVisible)return;const p=f.width,S=f.height,L=this.ctx;if(this.save(),!u.isNodeJS){const{filter:T}=L;T!=="none"&&T!==""&&(L.filter="none")}L.scale(1/p,-1/S);let F;if(f.bitmap)F=this.applyTransferMapsToBitmap(f);else if(typeof HTMLElement=="function"&&f instanceof HTMLElement||!f.data)F=f;else{const s=this.cachedCanvases.getCanvas("inlineImage",p,S).context;M(s,f),F=this.applyTransferMapsToCanvas(s)}const H=this._scaleImage(F,(0,b.getCurrentTransformInverse)(L));L.imageSmoothingEnabled=yt((0,b.getCurrentTransform)(L),f.interpolate),v(L,H.img,0,0,H.paintWidth,H.paintHeight,0,-S,p,S),this.compose(),this.restore()}paintInlineImageXObjectGroup(f,p){if(!this.contentVisible)return;const S=this.ctx;let L;if(f.bitmap)L=f.bitmap;else{const F=f.width,H=f.height,s=this.cachedCanvases.getCanvas("inlineImage",F,H).context;M(s,f),L=this.applyTransferMapsToCanvas(s)}for(const F of p)S.save(),S.transform(...F.transform),S.scale(1,-1),v(S,L,F.x,F.y,F.w,F.h,0,-1,1,1),S.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(f){}markPointProps(f,p){}beginMarkedContent(f){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(f,p){f==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(p)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(f){const p=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(f);const S=this.ctx;this.pendingClip&&(p||(this.pendingClip===ct?S.clip("evenodd"):S.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),S.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const f=(0,b.getCurrentTransform)(this.ctx);if(f[1]===0&&f[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(f[0]),Math.abs(f[3]));else{const p=Math.abs(f[0]*f[3]-f[2]*f[1]),S=Math.hypot(f[0],f[2]),L=Math.hypot(f[1],f[3]);this._cachedGetSinglePixelWidth=Math.max(S,L)/p}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:f}=this.current,{a:p,b:S,c:L,d:F}=this.ctx.getTransform();let H,T;if(S===0&&L===0){const s=Math.abs(p),_=Math.abs(F);if(s===_)if(f===0)H=T=1/s;else{const E=s*f;H=T=E<1?1/E:1}else if(f===0)H=1/s,T=1/_;else{const E=s*f,P=_*f;H=E<1?1/E:1,T=P<1?1/P:1}}else{const s=Math.abs(p*F-S*L),_=Math.hypot(p,S),E=Math.hypot(L,F);if(f===0)H=E/s,T=_/s;else{const P=f*s;H=E>P?E/P:1,T=_>P?_/P:1}}this._cachedScaleForStroking[0]=H,this._cachedScaleForStroking[1]=T}return this._cachedScaleForStroking}rescaleAndStroke(f){const{ctx:p}=this,{lineWidth:S}=this.current,[L,F]=this.getScaleForStroking();if(p.lineWidth=S||1,L===1&&F===1){p.stroke();return}const H=p.getLineDash();if(f&&p.save(),p.scale(L,F),H.length>0){const T=Math.max(L,F);p.setLineDash(H.map(s=>s/T)),p.lineDashOffset/=T}p.stroke(),f&&p.restore()}isContentVisible(){for(let f=this.markedContentStack.length-1;f>=0;f--)if(!this.markedContentStack[f].visible)return!1;return!0}}a.CanvasGraphics=O;for(const A in u.OPS)O.prototype[A]!==void 0&&(O.prototype[u.OPS[A]]=O.prototype[A])}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.TilingPattern=a.PathType=void 0,a.getShadingPattern=c;var u=I(1),b=I(6);const n={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};a.PathType=n;function x(v,l){if(!l)return;const w=l[2]-l[0],M=l[3]-l[1],R=new Path2D;R.rect(l[0],l[1],w,M),v.clip(R)}class z{constructor(){this.constructor===z&&(0,u.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,u.unreachable)("Abstract method `getPattern` called.")}}class W extends z{constructor(l){super(),this._type=l[1],this._bbox=l[2],this._colorStops=l[3],this._p0=l[4],this._p1=l[5],this._r0=l[6],this._r1=l[7],this.matrix=null}_createGradient(l){let w;this._type==="axial"?w=l.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(w=l.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const M of this._colorStops)w.addColorStop(M[0],M[1]);return w}getPattern(l,w,M,R){let m;if(R===n.STROKE||R===n.FILL){const C=w.current.getClippedPathBoundingBox(R,(0,b.getCurrentTransform)(l))||[0,0,0,0],q=Math.ceil(C[2]-C[0])||1,$=Math.ceil(C[3]-C[1])||1,j=w.cachedCanvases.getCanvas("pattern",q,$,!0),tt=j.context;tt.clearRect(0,0,tt.canvas.width,tt.canvas.height),tt.beginPath(),tt.rect(0,0,tt.canvas.width,tt.canvas.height),tt.translate(-C[0],-C[1]),M=u.Util.transform(M,[1,0,0,1,C[0],C[1]]),tt.transform(...w.baseTransform),this.matrix&&tt.transform(...this.matrix),x(tt,this._bbox),tt.fillStyle=this._createGradient(tt),tt.fill(),m=l.createPattern(j.canvas,"no-repeat");const nt=new DOMMatrix(M);m.setTransform(nt)}else x(l,this._bbox),m=this._createGradient(l);return m}}function r(v,l,w,M,R,m,C,q){const $=l.coords,j=l.colors,tt=v.data,nt=v.width*4;let yt;$[w+1]>$[M+1]&&(yt=w,w=M,M=yt,yt=m,m=C,C=yt),$[M+1]>$[R+1]&&(yt=M,M=R,R=yt,yt=C,C=q,q=yt),$[w+1]>$[M+1]&&(yt=w,w=M,M=yt,yt=m,m=C,C=yt);const dt=($[w]+l.offsetX)*l.scaleX,vt=($[w+1]+l.offsetY)*l.scaleY,Et=($[M]+l.offsetX)*l.scaleX,ct=($[M+1]+l.offsetY)*l.scaleY,O=($[R]+l.offsetX)*l.scaleX,A=($[R+1]+l.offsetY)*l.scaleY;if(vt>=A)return;const f=j[m],p=j[m+1],S=j[m+2],L=j[C],F=j[C+1],H=j[C+2],T=j[q],s=j[q+1],_=j[q+2],E=Math.round(vt),P=Math.round(A);let k,U,X,it,At,rt,st,ut;for(let ht=E;ht<=P;ht++){if(ht<ct){const Xt=ht<vt?0:(vt-ht)/(vt-ct);k=dt-(dt-Et)*Xt,U=f-(f-L)*Xt,X=p-(p-F)*Xt,it=S-(S-H)*Xt}else{let Xt;ht>A?Xt=1:ct===A?Xt=0:Xt=(ct-ht)/(ct-A),k=Et-(Et-O)*Xt,U=L-(L-T)*Xt,X=F-(F-s)*Xt,it=H-(H-_)*Xt}let gt;ht<vt?gt=0:ht>A?gt=1:gt=(vt-ht)/(vt-A),At=dt-(dt-O)*gt,rt=f-(f-T)*gt,st=p-(p-s)*gt,ut=S-(S-_)*gt;const Ct=Math.round(Math.min(k,At)),Lt=Math.round(Math.max(k,At));let Bt=nt*ht+Ct*4;for(let Xt=Ct;Xt<=Lt;Xt++)gt=(k-Xt)/(k-At),gt<0?gt=0:gt>1&&(gt=1),tt[Bt++]=U-(U-rt)*gt|0,tt[Bt++]=X-(X-st)*gt|0,tt[Bt++]=it-(it-ut)*gt|0,tt[Bt++]=255}}function t(v,l,w){const M=l.coords,R=l.colors;let m,C;switch(l.type){case"lattice":const q=l.verticesPerRow,$=Math.floor(M.length/q)-1,j=q-1;for(m=0;m<$;m++){let tt=m*q;for(let nt=0;nt<j;nt++,tt++)r(v,w,M[tt],M[tt+1],M[tt+q],R[tt],R[tt+1],R[tt+q]),r(v,w,M[tt+q+1],M[tt+1],M[tt+q],R[tt+q+1],R[tt+1],R[tt+q])}break;case"triangles":for(m=0,C=M.length;m<C;m+=3)r(v,w,M[m],M[m+1],M[m+2],R[m],R[m+1],R[m+2]);break;default:throw new Error("illegal figure")}}class i extends z{constructor(l){super(),this._coords=l[2],this._colors=l[3],this._figures=l[4],this._bounds=l[5],this._bbox=l[7],this._background=l[8],this.matrix=null}_createMeshCanvas(l,w,M){const q=Math.floor(this._bounds[0]),$=Math.floor(this._bounds[1]),j=Math.ceil(this._bounds[2])-q,tt=Math.ceil(this._bounds[3])-$,nt=Math.min(Math.ceil(Math.abs(j*l[0]*1.1)),3e3),yt=Math.min(Math.ceil(Math.abs(tt*l[1]*1.1)),3e3),dt=j/nt,vt=tt/yt,Et={coords:this._coords,colors:this._colors,offsetX:-q,offsetY:-$,scaleX:1/dt,scaleY:1/vt},ct=nt+4,O=yt+4,A=M.getCanvas("mesh",ct,O,!1),f=A.context,p=f.createImageData(nt,yt);if(w){const L=p.data;for(let F=0,H=L.length;F<H;F+=4)L[F]=w[0],L[F+1]=w[1],L[F+2]=w[2],L[F+3]=255}for(const L of this._figures)t(p,L,Et);return f.putImageData(p,2,2),{canvas:A.canvas,offsetX:q-2*dt,offsetY:$-2*vt,scaleX:dt,scaleY:vt}}getPattern(l,w,M,R){x(l,this._bbox);let m;if(R===n.SHADING)m=u.Util.singularValueDecompose2dScale((0,b.getCurrentTransform)(l));else if(m=u.Util.singularValueDecompose2dScale(w.baseTransform),this.matrix){const q=u.Util.singularValueDecompose2dScale(this.matrix);m=[m[0]*q[0],m[1]*q[1]]}const C=this._createMeshCanvas(m,R===n.SHADING?null:this._background,w.cachedCanvases);return R!==n.SHADING&&(l.setTransform(...w.baseTransform),this.matrix&&l.transform(...this.matrix)),l.translate(C.offsetX,C.offsetY),l.scale(C.scaleX,C.scaleY),l.createPattern(C.canvas,"no-repeat")}}class h extends z{getPattern(){return"hotpink"}}function c(v){switch(v[0]){case"RadialAxial":return new W(v);case"Mesh":return new i(v);case"Dummy":return new h}throw new Error(`Unknown IR type: ${v[0]}`)}const e={COLORED:1,UNCOLORED:2};class g{static MAX_PATTERN_SIZE=3e3;constructor(l,w,M,R,m){this.operatorList=l[2],this.matrix=l[3]||[1,0,0,1,0,0],this.bbox=l[4],this.xstep=l[5],this.ystep=l[6],this.paintType=l[7],this.tilingType=l[8],this.color=w,this.ctx=M,this.canvasGraphicsFactory=R,this.baseTransform=m}createPatternCanvas(l){const w=this.operatorList,M=this.bbox,R=this.xstep,m=this.ystep,C=this.paintType,q=this.tilingType,$=this.color,j=this.canvasGraphicsFactory;(0,u.info)("TilingType: "+q);const tt=M[0],nt=M[1],yt=M[2],dt=M[3],vt=u.Util.singularValueDecompose2dScale(this.matrix),Et=u.Util.singularValueDecompose2dScale(this.baseTransform),ct=[vt[0]*Et[0],vt[1]*Et[1]],O=this.getSizeAndScale(R,this.ctx.canvas.width,ct[0]),A=this.getSizeAndScale(m,this.ctx.canvas.height,ct[1]),f=l.cachedCanvases.getCanvas("pattern",O.size,A.size,!0),p=f.context,S=j.createCanvasGraphics(p);S.groupLevel=l.groupLevel,this.setFillAndStrokeStyleToContext(S,C,$);let L=tt,F=nt,H=yt,T=dt;return tt<0&&(L=0,H+=Math.abs(tt)),nt<0&&(F=0,T+=Math.abs(nt)),p.translate(-(O.scale*L),-(A.scale*F)),S.transform(O.scale,0,0,A.scale,0,0),p.save(),this.clipBbox(S,L,F,H,T),S.baseTransform=(0,b.getCurrentTransform)(S.ctx),S.executeOperatorList(w),S.endDrawing(),{canvas:f.canvas,scaleX:O.scale,scaleY:A.scale,offsetX:L,offsetY:F}}getSizeAndScale(l,w,M){l=Math.abs(l);const R=Math.max(g.MAX_PATTERN_SIZE,w);let m=Math.ceil(l*M);return m>=R?m=R:M=m/l,{scale:M,size:m}}clipBbox(l,w,M,R,m){const C=R-w,q=m-M;l.ctx.rect(w,M,C,q),l.current.updateRectMinMax((0,b.getCurrentTransform)(l.ctx),[w,M,R,m]),l.clip(),l.endPath()}setFillAndStrokeStyleToContext(l,w,M){const R=l.ctx,m=l.current;switch(w){case e.COLORED:const C=this.ctx;R.fillStyle=C.fillStyle,R.strokeStyle=C.strokeStyle,m.fillColor=C.fillStyle,m.strokeColor=C.strokeStyle;break;case e.UNCOLORED:const q=u.Util.makeHexColor(M[0],M[1],M[2]);R.fillStyle=q,R.strokeStyle=q,m.fillColor=q,m.strokeColor=q;break;default:throw new u.FormatError(`Unsupported paint type: ${w}`)}}getPattern(l,w,M,R){let m=M;R!==n.SHADING&&(m=u.Util.transform(m,w.baseTransform),this.matrix&&(m=u.Util.transform(m,this.matrix)));const C=this.createPatternCanvas(w);let q=new DOMMatrix(m);q=q.translate(C.offsetX,C.offsetY),q=q.scale(1/C.scaleX,1/C.scaleY);const $=l.createPattern(C.canvas,"repeat");return $.setTransform(q),$}}a.TilingPattern=g}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.convertBlackAndWhiteToRGBA=n,a.convertToRGBA=b,a.grayToRGBA=z;var u=I(1);function b(W){switch(W.kind){case u.ImageKind.GRAYSCALE_1BPP:return n(W);case u.ImageKind.RGB_24BPP:return x(W)}return null}function n({src:W,srcPos:r=0,dest:t,width:i,height:h,nonBlackColor:c=4294967295,inverseDecode:e=!1}){const g=u.FeatureTest.isLittleEndian?4278190080:255,[v,l]=e?[c,g]:[g,c],w=i>>3,M=i&7,R=W.length;t=new Uint32Array(t.buffer);let m=0;for(let C=0;C<h;C++){for(const $=r+w;r<$;r++){const j=r<R?W[r]:255;t[m++]=j&128?l:v,t[m++]=j&64?l:v,t[m++]=j&32?l:v,t[m++]=j&16?l:v,t[m++]=j&8?l:v,t[m++]=j&4?l:v,t[m++]=j&2?l:v,t[m++]=j&1?l:v}if(M===0)continue;const q=r<R?W[r++]:255;for(let $=0;$<M;$++)t[m++]=q&1<<7-$?l:v}return{srcPos:r,destPos:m}}function x({src:W,srcPos:r=0,dest:t,destPos:i=0,width:h,height:c}){let e=0;const g=W.length>>2,v=new Uint32Array(W.buffer,r,g);if(u.FeatureTest.isLittleEndian){for(;e<g-2;e+=3,i+=4){const l=v[e],w=v[e+1],M=v[e+2];t[i]=l|4278190080,t[i+1]=l>>>24|w<<8|4278190080,t[i+2]=w>>>16|M<<16|4278190080,t[i+3]=M>>>8|4278190080}for(let l=e*4,w=W.length;l<w;l+=3)t[i++]=W[l]|W[l+1]<<8|W[l+2]<<16|4278190080}else{for(;e<g-2;e+=3,i+=4){const l=v[e],w=v[e+1],M=v[e+2];t[i]=l|255,t[i+1]=l<<24|w>>>8|255,t[i+2]=w<<16|M>>>16|255,t[i+3]=M<<8|255}for(let l=e*4,w=W.length;l<w;l+=3)t[i++]=W[l]<<24|W[l+1]<<16|W[l+2]<<8|255}return{srcPos:r,destPos:i}}function z(W,r){if(u.FeatureTest.isLittleEndian)for(let t=0,i=W.length;t<i;t++)r[t]=W[t]*65793|4278190080;else for(let t=0,i=W.length;t<i;t++)r[t]=W[t]*16843008|255}}),((d,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.GlobalWorkerOptions=void 0;const I=Object.create(null);a.GlobalWorkerOptions=I,I.workerPort=null,I.workerSrc=""}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.MessageHandler=void 0;var u=I(1);const b={DATA:1,ERROR:2},n={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function x(W){switch(W instanceof Error||typeof W=="object"&&W!==null||(0,u.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),W.name){case"AbortException":return new u.AbortException(W.message);case"MissingPDFException":return new u.MissingPDFException(W.message);case"PasswordException":return new u.PasswordException(W.message,W.code);case"UnexpectedResponseException":return new u.UnexpectedResponseException(W.message,W.status);case"UnknownErrorException":return new u.UnknownErrorException(W.message,W.details);default:return new u.UnknownErrorException(W.message,W.toString())}}class z{constructor(r,t,i){this.sourceName=r,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=h=>{const c=h.data;if(c.targetName!==this.sourceName)return;if(c.stream){this.#e(c);return}if(c.callback){const g=c.callbackId,v=this.callbackCapabilities[g];if(!v)throw new Error(`Cannot resolve callback ${g}`);if(delete this.callbackCapabilities[g],c.callback===b.DATA)v.resolve(c.data);else if(c.callback===b.ERROR)v.reject(x(c.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[c.action];if(!e)throw new Error(`Unknown action from worker: ${c.action}`);if(c.callbackId){const g=this.sourceName,v=c.sourceName;new Promise(function(l){l(e(c.data))}).then(function(l){i.postMessage({sourceName:g,targetName:v,callback:b.DATA,callbackId:c.callbackId,data:l})},function(l){i.postMessage({sourceName:g,targetName:v,callback:b.ERROR,callbackId:c.callbackId,reason:x(l)})});return}if(c.streamId){this.#t(c);return}e(c.data)},i.addEventListener("message",this._onComObjOnMessage)}on(r,t){const i=this.actionHandler;if(i[r])throw new Error(`There is already an actionName called "${r}"`);i[r]=t}send(r,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:r,data:t},i)}sendWithPromise(r,t,i){const h=this.callbackId++,c=new u.PromiseCapability;this.callbackCapabilities[h]=c;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:r,callbackId:h,data:t},i)}catch(e){c.reject(e)}return c.promise}sendWithStream(r,t,i,h){const c=this.streamId++,e=this.sourceName,g=this.targetName,v=this.comObj;return new ReadableStream({start:l=>{const w=new u.PromiseCapability;return this.streamControllers[c]={controller:l,startCall:w,pullCall:null,cancelCall:null,isClosed:!1},v.postMessage({sourceName:e,targetName:g,action:r,streamId:c,data:t,desiredSize:l.desiredSize},h),w.promise},pull:l=>{const w=new u.PromiseCapability;return this.streamControllers[c].pullCall=w,v.postMessage({sourceName:e,targetName:g,stream:n.PULL,streamId:c,desiredSize:l.desiredSize}),w.promise},cancel:l=>{(0,u.assert)(l instanceof Error,"cancel must have a valid reason");const w=new u.PromiseCapability;return this.streamControllers[c].cancelCall=w,this.streamControllers[c].isClosed=!0,v.postMessage({sourceName:e,targetName:g,stream:n.CANCEL,streamId:c,reason:x(l)}),w.promise}},i)}#t(r){const t=r.streamId,i=this.sourceName,h=r.sourceName,c=this.comObj,e=this,g=this.actionHandler[r.action],v={enqueue(l,w=1,M){if(this.isCancelled)return;const R=this.desiredSize;this.desiredSize-=w,R>0&&this.desiredSize<=0&&(this.sinkCapability=new u.PromiseCapability,this.ready=this.sinkCapability.promise),c.postMessage({sourceName:i,targetName:h,stream:n.ENQUEUE,streamId:t,chunk:l},M)},close(){this.isCancelled||(this.isCancelled=!0,c.postMessage({sourceName:i,targetName:h,stream:n.CLOSE,streamId:t}),delete e.streamSinks[t])},error(l){(0,u.assert)(l instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,c.postMessage({sourceName:i,targetName:h,stream:n.ERROR,streamId:t,reason:x(l)}))},sinkCapability:new u.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:r.desiredSize,ready:null};v.sinkCapability.resolve(),v.ready=v.sinkCapability.promise,this.streamSinks[t]=v,new Promise(function(l){l(g(r.data,v))}).then(function(){c.postMessage({sourceName:i,targetName:h,stream:n.START_COMPLETE,streamId:t,success:!0})},function(l){c.postMessage({sourceName:i,targetName:h,stream:n.START_COMPLETE,streamId:t,reason:x(l)})})}#e(r){const t=r.streamId,i=this.sourceName,h=r.sourceName,c=this.comObj,e=this.streamControllers[t],g=this.streamSinks[t];switch(r.stream){case n.START_COMPLETE:r.success?e.startCall.resolve():e.startCall.reject(x(r.reason));break;case n.PULL_COMPLETE:r.success?e.pullCall.resolve():e.pullCall.reject(x(r.reason));break;case n.PULL:if(!g){c.postMessage({sourceName:i,targetName:h,stream:n.PULL_COMPLETE,streamId:t,success:!0});break}g.desiredSize<=0&&r.desiredSize>0&&g.sinkCapability.resolve(),g.desiredSize=r.desiredSize,new Promise(function(v){v(g.onPull?.())}).then(function(){c.postMessage({sourceName:i,targetName:h,stream:n.PULL_COMPLETE,streamId:t,success:!0})},function(v){c.postMessage({sourceName:i,targetName:h,stream:n.PULL_COMPLETE,streamId:t,reason:x(v)})});break;case n.ENQUEUE:if((0,u.assert)(e,"enqueue should have stream controller"),e.isClosed)break;e.controller.enqueue(r.chunk);break;case n.CLOSE:if((0,u.assert)(e,"close should have stream controller"),e.isClosed)break;e.isClosed=!0,e.controller.close(),this.#n(e,t);break;case n.ERROR:(0,u.assert)(e,"error should have stream controller"),e.controller.error(x(r.reason)),this.#n(e,t);break;case n.CANCEL_COMPLETE:r.success?e.cancelCall.resolve():e.cancelCall.reject(x(r.reason)),this.#n(e,t);break;case n.CANCEL:if(!g)break;new Promise(function(v){v(g.onCancel?.(x(r.reason)))}).then(function(){c.postMessage({sourceName:i,targetName:h,stream:n.CANCEL_COMPLETE,streamId:t,success:!0})},function(v){c.postMessage({sourceName:i,targetName:h,stream:n.CANCEL_COMPLETE,streamId:t,reason:x(v)})}),g.sinkCapability.reject(x(r.reason)),g.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#n(r,t){await Promise.allSettled([r.startCall?.promise,r.pullCall?.promise,r.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}a.MessageHandler=z}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Metadata=void 0;var u=I(1);class b{#t;#e;constructor({parsedData:x,rawData:z}){this.#t=x,this.#e=z}getRaw(){return this.#e}get(x){return this.#t.get(x)??null}getAll(){return(0,u.objectFromMap)(this.#t)}has(x){return this.#t.has(x)}}a.Metadata=b}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.OptionalContentConfig=void 0;var u=I(1),b=I(8);const n=Symbol("INTERNAL");class x{#t=!0;constructor(r,t){this.name=r,this.intent=t}get visible(){return this.#t}_setVisible(r,t){r!==n&&(0,u.unreachable)("Internal method `_setVisible` called."),this.#t=t}}class z{#t=null;#e=new Map;#n=null;#i=null;constructor(r){if(this.name=null,this.creator=null,r!==null){this.name=r.name,this.creator=r.creator,this.#i=r.order;for(const t of r.groups)this.#e.set(t.id,new x(t.name,t.intent));if(r.baseState==="OFF")for(const t of this.#e.values())t._setVisible(n,!1);for(const t of r.on)this.#e.get(t)._setVisible(n,!0);for(const t of r.off)this.#e.get(t)._setVisible(n,!1);this.#n=this.getHash()}}#o(r){const t=r.length;if(t<2)return!0;const i=r[0];for(let h=1;h<t;h++){const c=r[h];let e;if(Array.isArray(c))e=this.#o(c);else if(this.#e.has(c))e=this.#e.get(c).visible;else return(0,u.warn)(`Optional content group not found: ${c}`),!0;switch(i){case"And":if(!e)return!1;break;case"Or":if(e)return!0;break;case"Not":return!e;default:return!0}}return i==="And"}isVisible(r){if(this.#e.size===0)return!0;if(!r)return(0,u.warn)("Optional content group not defined."),!0;if(r.type==="OCG")return this.#e.has(r.id)?this.#e.get(r.id).visible:((0,u.warn)(`Optional content group not found: ${r.id}`),!0);if(r.type==="OCMD"){if(r.expression)return this.#o(r.expression);if(!r.policy||r.policy==="AnyOn"){for(const t of r.ids){if(!this.#e.has(t))return(0,u.warn)(`Optional content group not found: ${t}`),!0;if(this.#e.get(t).visible)return!0}return!1}else if(r.policy==="AllOn"){for(const t of r.ids){if(!this.#e.has(t))return(0,u.warn)(`Optional content group not found: ${t}`),!0;if(!this.#e.get(t).visible)return!1}return!0}else if(r.policy==="AnyOff"){for(const t of r.ids){if(!this.#e.has(t))return(0,u.warn)(`Optional content group not found: ${t}`),!0;if(!this.#e.get(t).visible)return!0}return!1}else if(r.policy==="AllOff"){for(const t of r.ids){if(!this.#e.has(t))return(0,u.warn)(`Optional content group not found: ${t}`),!0;if(this.#e.get(t).visible)return!1}return!0}return(0,u.warn)(`Unknown optional content policy ${r.policy}.`),!0}return(0,u.warn)(`Unknown group type ${r.type}.`),!0}setVisibility(r,t=!0){if(!this.#e.has(r)){(0,u.warn)(`Optional content group not found: ${r}`);return}this.#e.get(r)._setVisible(n,!!t),this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?(0,u.objectFromMap)(this.#e):null}getGroup(r){return this.#e.get(r)||null}getHash(){if(this.#t!==null)return this.#t;const r=new b.MurmurHash3_64;for(const[t,i]of this.#e)r.update(`${t}:${i.visible}`);return this.#t=r.hexdigest()}}a.OptionalContentConfig=z}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFDataTransportStream=void 0;var u=I(1),b=I(6);class n{constructor({length:r,initialData:t,progressiveDone:i=!1,contentDispositionFilename:h=null,disableRange:c=!1,disableStream:e=!1},g){if((0,u.assert)(g,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=i,this._contentDispositionFilename=h,t?.length>0){const v=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;this._queuedChunks.push(v)}this._pdfDataRangeTransport=g,this._isStreamingSupported=!e,this._isRangeSupported=!c,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((v,l)=>{this._onReceiveData({begin:v,chunk:l})}),this._pdfDataRangeTransport.addProgressListener((v,l)=>{this._onProgress({loaded:v,total:l})}),this._pdfDataRangeTransport.addProgressiveReadListener(v=>{this._onReceiveData({chunk:v})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:r,chunk:t}){const i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(r===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const h=this._rangeReaders.some(function(c){return c._begin!==r?!1:(c._enqueue(i),!0)});(0,u.assert)(h,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(r){r.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:r.loaded}):this._fullRequestReader?.onProgress?.({loaded:r.loaded,total:r.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(r){const t=this._rangeReaders.indexOf(r);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){(0,u.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const r=this._queuedChunks;return this._queuedChunks=null,new x(this,r,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(r,t){if(t<=this._progressiveDataLength)return null;const i=new z(this,r,t);return this._pdfDataRangeTransport.requestDataRange(r,t),this._rangeReaders.push(i),i}cancelAllRequests(r){this._fullRequestReader?.cancel(r);for(const t of this._rangeReaders.slice(0))t.cancel(r);this._pdfDataRangeTransport.abort()}}a.PDFDataTransportStream=n;class x{constructor(r,t,i=!1,h=null){this._stream=r,this._done=i||!1,this._filename=(0,b.isPdfFile)(h)?h:null,this._queuedChunks=t||[],this._loaded=0;for(const c of this._queuedChunks)this._loaded+=c.byteLength;this._requests=[],this._headersReady=Promise.resolve(),r._fullRequestReader=this,this.onProgress=null}_enqueue(r){this._done||(this._requests.length>0?this._requests.shift().resolve({value:r,done:!1}):this._queuedChunks.push(r),this._loaded+=r.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const r=new u.PromiseCapability;return this._requests.push(r),r.promise}cancel(r){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class z{constructor(r,t,i){this._stream=r,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(r){if(!this._done){if(this._requests.length===0)this._queuedChunk=r;else{this._requests.shift().resolve({value:r,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const r=new u.PromiseCapability;return this._requests.push(r),r.promise}cancel(r){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFFetchStream=void 0;var u=I(1),b=I(20);function n(i,h,c){return{method:"GET",headers:i,signal:c.signal,mode:"cors",credentials:h?"include":"same-origin",redirect:"follow"}}function x(i){const h=new Headers;for(const c in i){const e=i[c];e!==void 0&&h.append(c,e)}return h}function z(i){return i instanceof Uint8Array?i.buffer:i instanceof ArrayBuffer?i:((0,u.warn)(`getArrayBuffer - unexpected data format: ${i}`),new Uint8Array(i).buffer)}class W{constructor(h){this.source=h,this.isHttp=/^https?:/i.test(h.url),this.httpHeaders=this.isHttp&&h.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,u.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new r(this),this._fullRequestReader}getRangeReader(h,c){if(c<=this._progressiveDataLength)return null;const e=new t(this,h,c);return this._rangeRequestReaders.push(e),e}cancelAllRequests(h){this._fullRequestReader?.cancel(h);for(const c of this._rangeRequestReaders.slice(0))c.cancel(h)}}a.PDFFetchStream=W;class r{constructor(h){this._stream=h,this._reader=null,this._loaded=0,this._filename=null;const c=h.source;this._withCredentials=c.withCredentials||!1,this._contentLength=c.length,this._headersCapability=new u.PromiseCapability,this._disableRange=c.disableRange||!1,this._rangeChunkSize=c.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!c.disableStream,this._isRangeSupported=!c.disableRange,this._headers=x(this._stream.httpHeaders);const e=c.url;fetch(e,n(this._headers,this._withCredentials,this._abortController)).then(g=>{if(!(0,b.validateResponseStatus)(g.status))throw(0,b.createResponseStatusError)(g.status,e);this._reader=g.body.getReader(),this._headersCapability.resolve();const v=M=>g.headers.get(M),{allowRangeRequests:l,suggestedLength:w}=(0,b.validateRangeRequestCapabilities)({getResponseHeader:v,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=w||this._contentLength,this._filename=(0,b.extractFilenameFromHeader)(v),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new u.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:h,done:c}=await this._reader.read();return c?{value:h,done:c}:(this._loaded+=h.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:z(h),done:!1})}cancel(h){this._reader?.cancel(h),this._abortController.abort()}}class t{constructor(h,c,e){this._stream=h,this._reader=null,this._loaded=0;const g=h.source;this._withCredentials=g.withCredentials||!1,this._readCapability=new u.PromiseCapability,this._isStreamingSupported=!g.disableStream,this._abortController=new AbortController,this._headers=x(this._stream.httpHeaders),this._headers.append("Range",`bytes=${c}-${e-1}`);const v=g.url;fetch(v,n(this._headers,this._withCredentials,this._abortController)).then(l=>{if(!(0,b.validateResponseStatus)(l.status))throw(0,b.createResponseStatusError)(l.status,v);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:h,done:c}=await this._reader.read();return c?{value:h,done:c}:(this._loaded+=h.byteLength,this.onProgress?.({loaded:this._loaded}),{value:z(h),done:!1})}cancel(h){this._reader?.cancel(h),this._abortController.abort()}}}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createResponseStatusError=W,a.extractFilenameFromHeader=z,a.validateRangeRequestCapabilities=x,a.validateResponseStatus=r;var u=I(1),b=I(21),n=I(6);function x({getResponseHeader:t,isHttp:i,rangeChunkSize:h,disableRange:c}){const e={allowRangeRequests:!1,suggestedLength:void 0},g=parseInt(t("Content-Length"),10);return!Number.isInteger(g)||(e.suggestedLength=g,g<=2*h)||c||!i||t("Accept-Ranges")!=="bytes"||(t("Content-Encoding")||"identity")!=="identity"||(e.allowRangeRequests=!0),e}function z(t){const i=t("Content-Disposition");if(i){let h=(0,b.getFilenameFromContentDispositionHeader)(i);if(h.includes("%"))try{h=decodeURIComponent(h)}catch{}if((0,n.isPdfFile)(h))return h}return null}function W(t,i){return t===404||t===0&&i.startsWith("file:")?new u.MissingPDFException('Missing PDF "'+i+'".'):new u.UnexpectedResponseException(`Unexpected server response (${t}) while retrieving PDF "${i}".`,t)}function r(t){return t===200||t===206}}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.getFilenameFromContentDispositionHeader=b;var u=I(1);function b(n){let x=!0,z=W("filename\\*","i").exec(n);if(z){z=z[1];let g=h(z);return g=unescape(g),g=c(g),g=e(g),t(g)}if(z=i(n),z){const g=e(z);return t(g)}if(z=W("filename","i").exec(n),z){z=z[1];let g=h(z);return g=e(g),t(g)}function W(g,v){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',v)}function r(g,v){if(g){if(!/^[\x00-\xFF]+$/.test(v))return v;try{const l=new TextDecoder(g,{fatal:!0}),w=(0,u.stringToBytes)(v);v=l.decode(w),x=!1}catch{}}return v}function t(g){return x&&/[\x80-\xff]/.test(g)&&(g=r("utf-8",g),x&&(g=r("iso-8859-1",g))),g}function i(g){const v=[];let l;const w=W("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(l=w.exec(g))!==null;){let[,R,m,C]=l;if(R=parseInt(R,10),R in v){if(R===0)break;continue}v[R]=[m,C]}const M=[];for(let R=0;R<v.length&&R in v;++R){let[m,C]=v[R];C=h(C),m&&(C=unescape(C),R===0&&(C=c(C))),M.push(C)}return M.join("")}function h(g){if(g.startsWith('"')){const v=g.slice(1).split('\\"');for(let l=0;l<v.length;++l){const w=v[l].indexOf('"');w!==-1&&(v[l]=v[l].slice(0,w),v.length=l+1),v[l]=v[l].replaceAll(/\\(.)/g,"$1")}g=v.join('"')}return g}function c(g){const v=g.indexOf("'");if(v===-1)return g;const l=g.slice(0,v),M=g.slice(v+1).replace(/^[^']*'/,"");return r(l,M)}function e(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(v,l,w,M){if(w==="q"||w==="Q")return M=M.replaceAll("_"," "),M=M.replaceAll(/=([0-9a-fA-F]{2})/g,function(R,m){return String.fromCharCode(parseInt(m,16))}),r(l,M);try{M=atob(M)}catch{}return r(l,M)})}return""}}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFNetworkStream=void 0;var u=I(1),b=I(20);const n=200,x=206;function z(h){const c=h.response;return typeof c!="string"?c:(0,u.stringToBytes)(c).buffer}class W{constructor(c,e={}){this.url=c,this.isHttp=/^https?:/i.test(c),this.httpHeaders=this.isHttp&&e.httpHeaders||Object.create(null),this.withCredentials=e.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(c,e,g){const v={begin:c,end:e};for(const l in g)v[l]=g[l];return this.request(v)}requestFull(c){return this.request(c)}request(c){const e=new XMLHttpRequest,g=this.currXhrId++,v=this.pendingRequests[g]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const l in this.httpHeaders){const w=this.httpHeaders[l];w!==void 0&&e.setRequestHeader(l,w)}return this.isHttp&&"begin"in c&&"end"in c?(e.setRequestHeader("Range",`bytes=${c.begin}-${c.end-1}`),v.expectedStatus=x):v.expectedStatus=n,e.responseType="arraybuffer",c.onError&&(e.onerror=function(l){c.onError(e.status)}),e.onreadystatechange=this.onStateChange.bind(this,g),e.onprogress=this.onProgress.bind(this,g),v.onHeadersReceived=c.onHeadersReceived,v.onDone=c.onDone,v.onError=c.onError,v.onProgress=c.onProgress,e.send(null),g}onProgress(c,e){const g=this.pendingRequests[c];g&&g.onProgress?.(e)}onStateChange(c,e){const g=this.pendingRequests[c];if(!g)return;const v=g.xhr;if(v.readyState>=2&&g.onHeadersReceived&&(g.onHeadersReceived(),delete g.onHeadersReceived),v.readyState!==4||!(c in this.pendingRequests))return;if(delete this.pendingRequests[c],v.status===0&&this.isHttp){g.onError?.(v.status);return}const l=v.status||n;if(!(l===n&&g.expectedStatus===x)&&l!==g.expectedStatus){g.onError?.(v.status);return}const M=z(v);if(l===x){const R=v.getResponseHeader("Content-Range"),m=/bytes (\d+)-(\d+)\/(\d+)/.exec(R);g.onDone({begin:parseInt(m[1],10),chunk:M})}else M?g.onDone({begin:0,chunk:M}):g.onError?.(v.status)}getRequestXhr(c){return this.pendingRequests[c].xhr}isPendingRequest(c){return c in this.pendingRequests}abortRequest(c){const e=this.pendingRequests[c].xhr;delete this.pendingRequests[c],e.abort()}}class r{constructor(c){this._source=c,this._manager=new W(c.url,{httpHeaders:c.httpHeaders,withCredentials:c.withCredentials}),this._rangeChunkSize=c.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(c){const e=this._rangeRequestReaders.indexOf(c);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return(0,u.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new t(this._manager,this._source),this._fullRequestReader}getRangeReader(c,e){const g=new i(this._manager,c,e);return g.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(g),g}cancelAllRequests(c){this._fullRequestReader?.cancel(c);for(const e of this._rangeRequestReaders.slice(0))e.cancel(c)}}a.PDFNetworkStream=r;class t{constructor(c,e){this._manager=c;const g={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._fullRequestId=c.requestFull(g),this._headersReceivedCapability=new u.PromiseCapability,this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const c=this._fullRequestId,e=this._manager.getRequestXhr(c),g=w=>e.getResponseHeader(w),{allowRangeRequests:v,suggestedLength:l}=(0,b.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});v&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=(0,b.extractFilenameFromHeader)(g),this._isRangeSupported&&this._manager.abortRequest(c),this._headersReceivedCapability.resolve()}_onDone(c){if(c&&(this._requests.length>0?this._requests.shift().resolve({value:c.chunk,done:!1}):this._cachedChunks.push(c.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(c){this._storedError=(0,b.createResponseStatusError)(c,this._url),this._headersReceivedCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(c){this.onProgress?.({loaded:c.loaded,total:c.lengthComputable?c.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const c=new u.PromiseCapability;return this._requests.push(c),c.promise}cancel(c){this._done=!0,this._headersReceivedCapability.reject(c);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class i{constructor(c,e,g){this._manager=c;const v={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=c.url,this._requestId=c.requestRange(e,g,v),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(c){const e=c.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(c){this._storedError=(0,b.createResponseStatusError)(c,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(c){this.isStreamingSupported||this.onProgress?.({loaded:c.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const c=new u.PromiseCapability;return this._requests.push(c),c.promise}cancel(c){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PDFNodeStream=void 0;var u=I(1),b=I(20);const n=/^file:\/\/\/[a-zA-Z]:\//;function x(g){const v=require$$5,l=v.parse(g);return l.protocol==="file:"||l.host?l:/^[a-z]:[/\\]/i.test(g)?v.parse(`file:///${g}`):(l.host||(l.protocol="file:"),l)}class z{constructor(v){this.source=v,this.url=x(v.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&v.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,u.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new c(this):new i(this),this._fullRequestReader}getRangeReader(v,l){if(l<=this._progressiveDataLength)return null;const w=this.isFsUrl?new e(this,v,l):new h(this,v,l);return this._rangeRequestReaders.push(w),w}cancelAllRequests(v){this._fullRequestReader?.cancel(v);for(const l of this._rangeRequestReaders.slice(0))l.cancel(v)}}a.PDFNodeStream=z;class W{constructor(v){this._url=v.url,this._done=!1,this._storedError=null,this.onProgress=null;const l=v.source;this._contentLength=l.length,this._loaded=0,this._filename=null,this._disableRange=l.disableRange||!1,this._rangeChunkSize=l.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!l.disableStream,this._isRangeSupported=!l.disableRange,this._readableStream=null,this._readCapability=new u.PromiseCapability,this._headersCapability=new u.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const v=this._readableStream.read();return v===null?(this._readCapability=new u.PromiseCapability,this.read()):(this._loaded+=v.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(v).buffer,done:!1})}cancel(v){if(!this._readableStream){this._error(v);return}this._readableStream.destroy(v)}_error(v){this._storedError=v,this._readCapability.resolve()}_setReadableStream(v){this._readableStream=v,v.on("readable",()=>{this._readCapability.resolve()}),v.on("end",()=>{v.destroy(),this._done=!0,this._readCapability.resolve()}),v.on("error",l=>{this._error(l)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new u.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class r{constructor(v){this._url=v.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new u.PromiseCapability;const l=v.source;this._isStreamingSupported=!l.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const v=this._readableStream.read();return v===null?(this._readCapability=new u.PromiseCapability,this.read()):(this._loaded+=v.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(v).buffer,done:!1})}cancel(v){if(!this._readableStream){this._error(v);return}this._readableStream.destroy(v)}_error(v){this._storedError=v,this._readCapability.resolve()}_setReadableStream(v){this._readableStream=v,v.on("readable",()=>{this._readCapability.resolve()}),v.on("end",()=>{v.destroy(),this._done=!0,this._readCapability.resolve()}),v.on("error",l=>{this._error(l)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function t(g,v){return{protocol:g.protocol,auth:g.auth,host:g.hostname,port:g.port,path:g.path,method:"GET",headers:v}}class i extends W{constructor(v){super(v);const l=w=>{if(w.statusCode===404){const C=new u.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=C,this._headersCapability.reject(C);return}this._headersCapability.resolve(),this._setReadableStream(w);const M=C=>this._readableStream.headers[C.toLowerCase()],{allowRangeRequests:R,suggestedLength:m}=(0,b.validateRangeRequestCapabilities)({getResponseHeader:M,isHttp:v.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=R,this._contentLength=m||this._contentLength,this._filename=(0,b.extractFilenameFromHeader)(M)};if(this._request=null,this._url.protocol==="http:"){const w=require$$5;this._request=w.request(t(this._url,v.httpHeaders),l)}else{const w=require$$5;this._request=w.request(t(this._url,v.httpHeaders),l)}this._request.on("error",w=>{this._storedError=w,this._headersCapability.reject(w)}),this._request.end()}}class h extends r{constructor(v,l,w){super(v),this._httpHeaders={};for(const R in v.httpHeaders){const m=v.httpHeaders[R];m!==void 0&&(this._httpHeaders[R]=m)}this._httpHeaders.Range=`bytes=${l}-${w-1}`;const M=R=>{if(R.statusCode===404){const m=new u.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=m;return}this._setReadableStream(R)};if(this._request=null,this._url.protocol==="http:"){const R=require$$5;this._request=R.request(t(this._url,this._httpHeaders),M)}else{const R=require$$5;this._request=R.request(t(this._url,this._httpHeaders),M)}this._request.on("error",R=>{this._storedError=R}),this._request.end()}}class c extends W{constructor(v){super(v);let l=decodeURIComponent(this._url.path);n.test(this._url.href)&&(l=l.replace(/^\//,""));const w=require$$5;w.lstat(l,(M,R)=>{if(M){M.code==="ENOENT"&&(M=new u.MissingPDFException(`Missing PDF "${l}".`)),this._storedError=M,this._headersCapability.reject(M);return}this._contentLength=R.size,this._setReadableStream(w.createReadStream(l)),this._headersCapability.resolve()})}}class e extends r{constructor(v,l,w){super(v);let M=decodeURIComponent(this._url.path);n.test(this._url.href)&&(M=M.replace(/^\//,""));const R=require$$5;this._setReadableStream(R.createReadStream(M,{start:l,end:w-1}))}}}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.SVGGraphics=void 0;var u=I(6),b=I(1);const n={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},x="http://www.w3.org/XML/1998/namespace",z="http://www.w3.org/1999/xlink",W=["butt","round","square"],r=["miter","round","bevel"],t=function(R,m="",C=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!C)return URL.createObjectURL(new Blob([R],{type:m}));const q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let $=`data:${m};base64,`;for(let j=0,tt=R.length;j<tt;j+=3){const nt=R[j]&255,yt=R[j+1]&255,dt=R[j+2]&255,vt=nt>>2,Et=(nt&3)<<4|yt>>4,ct=j+1<tt?(yt&15)<<2|dt>>6:64,O=j+2<tt?dt&63:64;$+=q[vt]+q[Et]+q[ct]+q[O]}return $},i=(function(){const R=new Uint8Array([137,80,78,71,13,10,26,10]),m=12,C=new Int32Array(256);for(let dt=0;dt<256;dt++){let vt=dt;for(let Et=0;Et<8;Et++)vt=vt&1?3988292384^vt>>1&2147483647:vt>>1&2147483647;C[dt]=vt}function q(dt,vt,Et){let ct=-1;for(let O=vt;O<Et;O++){const A=(ct^dt[O])&255,f=C[A];ct=ct>>>8^f}return ct^-1}function $(dt,vt,Et,ct){let O=ct;const A=vt.length;Et[O]=A>>24&255,Et[O+1]=A>>16&255,Et[O+2]=A>>8&255,Et[O+3]=A&255,O+=4,Et[O]=dt.charCodeAt(0)&255,Et[O+1]=dt.charCodeAt(1)&255,Et[O+2]=dt.charCodeAt(2)&255,Et[O+3]=dt.charCodeAt(3)&255,O+=4,Et.set(vt,O),O+=vt.length;const f=q(Et,ct+4,O);Et[O]=f>>24&255,Et[O+1]=f>>16&255,Et[O+2]=f>>8&255,Et[O+3]=f&255}function j(dt,vt,Et){let ct=1,O=0;for(let A=vt;A<Et;++A)ct=(ct+(dt[A]&255))%65521,O=(O+ct)%65521;return O<<16|ct}function tt(dt){if(!b.isNodeJS)return nt(dt);try{const vt=parseInt(process.versions.node)>=8?dt:Buffer.from(dt),Et=require$$5.deflateSync(vt,{level:9});return Et instanceof Uint8Array?Et:new Uint8Array(Et)}catch(vt){(0,b.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+vt)}return nt(dt)}function nt(dt){let vt=dt.length;const Et=65535,ct=Math.ceil(vt/Et),O=new Uint8Array(2+vt+ct*5+4);let A=0;O[A++]=120,O[A++]=156;let f=0;for(;vt>Et;)O[A++]=0,O[A++]=255,O[A++]=255,O[A++]=0,O[A++]=0,O.set(dt.subarray(f,f+Et),A),A+=Et,f+=Et,vt-=Et;O[A++]=1,O[A++]=vt&255,O[A++]=vt>>8&255,O[A++]=~vt&65535&255,O[A++]=(~vt&65535)>>8&255,O.set(dt.subarray(f),A),A+=dt.length-f;const p=j(dt,0,dt.length);return O[A++]=p>>24&255,O[A++]=p>>16&255,O[A++]=p>>8&255,O[A++]=p&255,O}function yt(dt,vt,Et,ct){const O=dt.width,A=dt.height;let f,p,S;const L=dt.data;switch(vt){case b.ImageKind.GRAYSCALE_1BPP:p=0,f=1,S=O+7>>3;break;case b.ImageKind.RGB_24BPP:p=2,f=8,S=O*3;break;case b.ImageKind.RGBA_32BPP:p=6,f=8,S=O*4;break;default:throw new Error("invalid format")}const F=new Uint8Array((1+S)*A);let H=0,T=0;for(let U=0;U<A;++U)F[H++]=0,F.set(L.subarray(T,T+S),H),T+=S,H+=S;if(vt===b.ImageKind.GRAYSCALE_1BPP&&ct){H=0;for(let U=0;U<A;U++){H++;for(let X=0;X<S;X++)F[H++]^=255}}const s=new Uint8Array([O>>24&255,O>>16&255,O>>8&255,O&255,A>>24&255,A>>16&255,A>>8&255,A&255,f,p,0,0,0]),_=tt(F),E=R.length+m*3+s.length+_.length,P=new Uint8Array(E);let k=0;return P.set(R,k),k+=R.length,$("IHDR",s,P,k),k+=m+s.length,$("IDATA",_,P,k),k+=m+_.length,$("IEND",new Uint8Array(0),P,k),t(P,"image/png",Et)}return function(vt,Et,ct){const O=vt.kind===void 0?b.ImageKind.GRAYSCALE_1BPP:vt.kind;return yt(vt,O,Et,ct)}})();class h{constructor(){this.fontSizeScale=1,this.fontWeight=n.fontWeight,this.fontSize=0,this.textMatrix=b.IDENTITY_MATRIX,this.fontMatrix=b.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=b.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=n.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(m,C){this.x=m,this.y=C}}function c(R){let m=[];const C=[];for(const q of R){if(q.fn==="save"){m.push({fnId:92,fn:"group",items:[]}),C.push(m),m=m.at(-1).items;continue}q.fn==="restore"?m=C.pop():m.push(q)}return m}function e(R){if(Number.isInteger(R))return R.toString();const m=R.toFixed(10);let C=m.length-1;if(m[C]!=="0")return m;do C--;while(m[C]==="0");return m.substring(0,m[C]==="."?C:C+1)}function g(R){if(R[4]===0&&R[5]===0){if(R[1]===0&&R[2]===0)return R[0]===1&&R[3]===1?"":`scale(${e(R[0])} ${e(R[3])})`;if(R[0]===R[3]&&R[1]===-R[2]){const m=Math.acos(R[0])*180/Math.PI;return`rotate(${e(m)})`}}else if(R[0]===1&&R[1]===0&&R[2]===0&&R[3]===1)return`translate(${e(R[4])} ${e(R[5])})`;return`matrix(${e(R[0])} ${e(R[1])} ${e(R[2])} ${e(R[3])} ${e(R[4])} ${e(R[5])})`}let v=0,l=0,w=0;class M{constructor(m,C,q=!1){(0,u.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new u.DOMSVGFactory,this.current=new h,this.transformMatrix=b.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=m,this.objs=C,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!q,this._operatorIdMapping=[];for(const $ in b.OPS)this._operatorIdMapping[b.OPS[$]]=$}getObject(m,C=null){return typeof m=="string"?m.startsWith("g_")?this.commonObjs.get(m):this.objs.get(m):C}save(){this.transformStack.push(this.transformMatrix);const m=this.current;this.extraStack.push(m),this.current=m.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(m){this.save(),this.executeOpTree(m),this.restore()}loadDependencies(m){const C=m.fnArray,q=m.argsArray;for(let $=0,j=C.length;$<j;$++)if(C[$]===b.OPS.dependency)for(const tt of q[$]){const nt=tt.startsWith("g_")?this.commonObjs:this.objs,yt=new Promise(dt=>{nt.get(tt,dt)});this.current.dependencies.push(yt)}return Promise.all(this.current.dependencies)}transform(m,C,q,$,j,tt){const nt=[m,C,q,$,j,tt];this.transformMatrix=b.Util.transform(this.transformMatrix,nt),this.tgrp=null}getSVG(m,C){this.viewport=C;const q=this._initialize(C);return this.loadDependencies(m).then(()=>(this.transformMatrix=b.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(m)),q))}convertOpList(m){const C=this._operatorIdMapping,q=m.argsArray,$=m.fnArray,j=[];for(let tt=0,nt=$.length;tt<nt;tt++){const yt=$[tt];j.push({fnId:yt,fn:C[yt],args:q[tt]})}return c(j)}executeOpTree(m){for(const C of m){const q=C.fn,$=C.fnId,j=C.args;switch($|0){case b.OPS.beginText:this.beginText();break;case b.OPS.dependency:break;case b.OPS.setLeading:this.setLeading(j);break;case b.OPS.setLeadingMoveText:this.setLeadingMoveText(j[0],j[1]);break;case b.OPS.setFont:this.setFont(j);break;case b.OPS.showText:this.showText(j[0]);break;case b.OPS.showSpacedText:this.showText(j[0]);break;case b.OPS.endText:this.endText();break;case b.OPS.moveText:this.moveText(j[0],j[1]);break;case b.OPS.setCharSpacing:this.setCharSpacing(j[0]);break;case b.OPS.setWordSpacing:this.setWordSpacing(j[0]);break;case b.OPS.setHScale:this.setHScale(j[0]);break;case b.OPS.setTextMatrix:this.setTextMatrix(j[0],j[1],j[2],j[3],j[4],j[5]);break;case b.OPS.setTextRise:this.setTextRise(j[0]);break;case b.OPS.setTextRenderingMode:this.setTextRenderingMode(j[0]);break;case b.OPS.setLineWidth:this.setLineWidth(j[0]);break;case b.OPS.setLineJoin:this.setLineJoin(j[0]);break;case b.OPS.setLineCap:this.setLineCap(j[0]);break;case b.OPS.setMiterLimit:this.setMiterLimit(j[0]);break;case b.OPS.setFillRGBColor:this.setFillRGBColor(j[0],j[1],j[2]);break;case b.OPS.setStrokeRGBColor:this.setStrokeRGBColor(j[0],j[1],j[2]);break;case b.OPS.setStrokeColorN:this.setStrokeColorN(j);break;case b.OPS.setFillColorN:this.setFillColorN(j);break;case b.OPS.shadingFill:this.shadingFill(j[0]);break;case b.OPS.setDash:this.setDash(j[0],j[1]);break;case b.OPS.setRenderingIntent:this.setRenderingIntent(j[0]);break;case b.OPS.setFlatness:this.setFlatness(j[0]);break;case b.OPS.setGState:this.setGState(j[0]);break;case b.OPS.fill:this.fill();break;case b.OPS.eoFill:this.eoFill();break;case b.OPS.stroke:this.stroke();break;case b.OPS.fillStroke:this.fillStroke();break;case b.OPS.eoFillStroke:this.eoFillStroke();break;case b.OPS.clip:this.clip("nonzero");break;case b.OPS.eoClip:this.clip("evenodd");break;case b.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case b.OPS.paintImageXObject:this.paintImageXObject(j[0]);break;case b.OPS.paintInlineImageXObject:this.paintInlineImageXObject(j[0]);break;case b.OPS.paintImageMaskXObject:this.paintImageMaskXObject(j[0]);break;case b.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(j[0],j[1]);break;case b.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case b.OPS.closePath:this.closePath();break;case b.OPS.closeStroke:this.closeStroke();break;case b.OPS.closeFillStroke:this.closeFillStroke();break;case b.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case b.OPS.nextLine:this.nextLine();break;case b.OPS.transform:this.transform(j[0],j[1],j[2],j[3],j[4],j[5]);break;case b.OPS.constructPath:this.constructPath(j[0],j[1]);break;case b.OPS.endPath:this.endPath();break;case 92:this.group(C.items);break;default:(0,b.warn)(`Unimplemented operator ${q}`);break}}}setWordSpacing(m){this.current.wordSpacing=m}setCharSpacing(m){this.current.charSpacing=m}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(m,C,q,$,j,tt){const nt=this.current;nt.textMatrix=nt.lineMatrix=[m,C,q,$,j,tt],nt.textMatrixScale=Math.hypot(m,C),nt.x=nt.lineX=0,nt.y=nt.lineY=0,nt.xcoords=[],nt.ycoords=[],nt.tspan=this.svgFactory.createElement("svg:tspan"),nt.tspan.setAttributeNS(null,"font-family",nt.fontFamily),nt.tspan.setAttributeNS(null,"font-size",`${e(nt.fontSize)}px`),nt.tspan.setAttributeNS(null,"y",e(-nt.y)),nt.txtElement=this.svgFactory.createElement("svg:text"),nt.txtElement.append(nt.tspan)}beginText(){const m=this.current;m.x=m.lineX=0,m.y=m.lineY=0,m.textMatrix=b.IDENTITY_MATRIX,m.lineMatrix=b.IDENTITY_MATRIX,m.textMatrixScale=1,m.tspan=this.svgFactory.createElement("svg:tspan"),m.txtElement=this.svgFactory.createElement("svg:text"),m.txtgrp=this.svgFactory.createElement("svg:g"),m.xcoords=[],m.ycoords=[]}moveText(m,C){const q=this.current;q.x=q.lineX+=m,q.y=q.lineY+=C,q.xcoords=[],q.ycoords=[],q.tspan=this.svgFactory.createElement("svg:tspan"),q.tspan.setAttributeNS(null,"font-family",q.fontFamily),q.tspan.setAttributeNS(null,"font-size",`${e(q.fontSize)}px`),q.tspan.setAttributeNS(null,"y",e(-q.y))}showText(m){const C=this.current,q=C.font,$=C.fontSize;if($===0)return;const j=C.fontSizeScale,tt=C.charSpacing,nt=C.wordSpacing,yt=C.fontDirection,dt=C.textHScale*yt,vt=q.vertical,Et=vt?1:-1,ct=q.defaultVMetrics,O=$*C.fontMatrix[0];let A=0;for(const S of m){if(S===null){A+=yt*nt;continue}else if(typeof S=="number"){A+=Et*S*$/1e3;continue}const L=(S.isSpace?nt:0)+tt,F=S.fontChar;let H,T,s=S.width;if(vt){let E;const P=S.vmetric||ct;E=S.vmetric?P[1]:s*.5,E=-E*O;const k=P[2]*O;s=P?-P[0]:s,H=E/j,T=(A+k)/j}else H=A/j,T=0;(S.isInFont||q.missingFile)&&(C.xcoords.push(C.x+H),vt&&C.ycoords.push(-C.y+T),C.tspan.textContent+=F);const _=vt?s*O-L*yt:s*O+L*yt;A+=_}C.tspan.setAttributeNS(null,"x",C.xcoords.map(e).join(" ")),vt?C.tspan.setAttributeNS(null,"y",C.ycoords.map(e).join(" ")):C.tspan.setAttributeNS(null,"y",e(-C.y)),vt?C.y-=A:C.x+=A*dt,C.tspan.setAttributeNS(null,"font-family",C.fontFamily),C.tspan.setAttributeNS(null,"font-size",`${e(C.fontSize)}px`),C.fontStyle!==n.fontStyle&&C.tspan.setAttributeNS(null,"font-style",C.fontStyle),C.fontWeight!==n.fontWeight&&C.tspan.setAttributeNS(null,"font-weight",C.fontWeight);const f=C.textRenderingMode&b.TextRenderingMode.FILL_STROKE_MASK;if(f===b.TextRenderingMode.FILL||f===b.TextRenderingMode.FILL_STROKE?(C.fillColor!==n.fillColor&&C.tspan.setAttributeNS(null,"fill",C.fillColor),C.fillAlpha<1&&C.tspan.setAttributeNS(null,"fill-opacity",C.fillAlpha)):C.textRenderingMode===b.TextRenderingMode.ADD_TO_PATH?C.tspan.setAttributeNS(null,"fill","transparent"):C.tspan.setAttributeNS(null,"fill","none"),f===b.TextRenderingMode.STROKE||f===b.TextRenderingMode.FILL_STROKE){const S=1/(C.textMatrixScale||1);this._setStrokeAttributes(C.tspan,S)}let p=C.textMatrix;C.textRise!==0&&(p=p.slice(),p[5]+=C.textRise),C.txtElement.setAttributeNS(null,"transform",`${g(p)} scale(${e(dt)}, -1)`),C.txtElement.setAttributeNS(x,"xml:space","preserve"),C.txtElement.append(C.tspan),C.txtgrp.append(C.txtElement),this._ensureTransformGroup().append(C.txtElement)}setLeadingMoveText(m,C){this.setLeading(-C),this.moveText(m,C)}addFontStyle(m){if(!m.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const C=t(m.data,m.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${m.loadedName}"; src: url(${C}); }
`}setFont(m){const C=this.current,q=this.commonObjs.get(m[0]);let $=m[1];C.font=q,this.embedFonts&&!q.missingFile&&!this.embeddedFonts[q.loadedName]&&(this.addFontStyle(q),this.embeddedFonts[q.loadedName]=q),C.fontMatrix=q.fontMatrix||b.FONT_IDENTITY_MATRIX;let j="normal";q.black?j="900":q.bold&&(j="bold");const tt=q.italic?"italic":"normal";$<0?($=-$,C.fontDirection=-1):C.fontDirection=1,C.fontSize=$,C.fontFamily=q.loadedName,C.fontWeight=j,C.fontStyle=tt,C.tspan=this.svgFactory.createElement("svg:tspan"),C.tspan.setAttributeNS(null,"y",e(-C.y)),C.xcoords=[],C.ycoords=[]}endText(){const m=this.current;m.textRenderingMode&b.TextRenderingMode.ADD_TO_PATH_FLAG&&m.txtElement?.hasChildNodes()&&(m.element=m.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(m){m>0&&(this.current.lineWidth=m)}setLineCap(m){this.current.lineCap=W[m]}setLineJoin(m){this.current.lineJoin=r[m]}setMiterLimit(m){this.current.miterLimit=m}setStrokeAlpha(m){this.current.strokeAlpha=m}setStrokeRGBColor(m,C,q){this.current.strokeColor=b.Util.makeHexColor(m,C,q)}setFillAlpha(m){this.current.fillAlpha=m}setFillRGBColor(m,C,q){this.current.fillColor=b.Util.makeHexColor(m,C,q),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(m){this.current.strokeColor=this._makeColorN_Pattern(m)}setFillColorN(m){this.current.fillColor=this._makeColorN_Pattern(m)}shadingFill(m){const{width:C,height:q}=this.viewport,$=b.Util.inverseTransform(this.transformMatrix),[j,tt,nt,yt]=b.Util.getAxialAlignedBoundingBox([0,0,C,q],$),dt=this.svgFactory.createElement("svg:rect");dt.setAttributeNS(null,"x",j),dt.setAttributeNS(null,"y",tt),dt.setAttributeNS(null,"width",nt-j),dt.setAttributeNS(null,"height",yt-tt),dt.setAttributeNS(null,"fill",this._makeShadingPattern(m)),this.current.fillAlpha<1&&dt.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(dt)}_makeColorN_Pattern(m){return m[0]==="TilingPattern"?this._makeTilingPattern(m):this._makeShadingPattern(m)}_makeTilingPattern(m){const C=m[1],q=m[2],$=m[3]||b.IDENTITY_MATRIX,[j,tt,nt,yt]=m[4],dt=m[5],vt=m[6],Et=m[7],ct=`shading${w++}`,[O,A,f,p]=b.Util.normalizeRect([...b.Util.applyTransform([j,tt],$),...b.Util.applyTransform([nt,yt],$)]),[S,L]=b.Util.singularValueDecompose2dScale($),F=dt*S,H=vt*L,T=this.svgFactory.createElement("svg:pattern");T.setAttributeNS(null,"id",ct),T.setAttributeNS(null,"patternUnits","userSpaceOnUse"),T.setAttributeNS(null,"width",F),T.setAttributeNS(null,"height",H),T.setAttributeNS(null,"x",`${O}`),T.setAttributeNS(null,"y",`${A}`);const s=this.svg,_=this.transformMatrix,E=this.current.fillColor,P=this.current.strokeColor,k=this.svgFactory.create(f-O,p-A);if(this.svg=k,this.transformMatrix=$,Et===2){const U=b.Util.makeHexColor(...C);this.current.fillColor=U,this.current.strokeColor=U}return this.executeOpTree(this.convertOpList(q)),this.svg=s,this.transformMatrix=_,this.current.fillColor=E,this.current.strokeColor=P,T.append(k.childNodes[0]),this.defs.append(T),`url(#${ct})`}_makeShadingPattern(m){switch(typeof m=="string"&&(m=this.objs.get(m)),m[0]){case"RadialAxial":const C=`shading${w++}`,q=m[3];let $;switch(m[1]){case"axial":const j=m[4],tt=m[5];$=this.svgFactory.createElement("svg:linearGradient"),$.setAttributeNS(null,"id",C),$.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),$.setAttributeNS(null,"x1",j[0]),$.setAttributeNS(null,"y1",j[1]),$.setAttributeNS(null,"x2",tt[0]),$.setAttributeNS(null,"y2",tt[1]);break;case"radial":const nt=m[4],yt=m[5],dt=m[6],vt=m[7];$=this.svgFactory.createElement("svg:radialGradient"),$.setAttributeNS(null,"id",C),$.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),$.setAttributeNS(null,"cx",yt[0]),$.setAttributeNS(null,"cy",yt[1]),$.setAttributeNS(null,"r",vt),$.setAttributeNS(null,"fx",nt[0]),$.setAttributeNS(null,"fy",nt[1]),$.setAttributeNS(null,"fr",dt);break;default:throw new Error(`Unknown RadialAxial type: ${m[1]}`)}for(const j of q){const tt=this.svgFactory.createElement("svg:stop");tt.setAttributeNS(null,"offset",j[0]),tt.setAttributeNS(null,"stop-color",j[1]),$.append(tt)}return this.defs.append($),`url(#${C})`;case"Mesh":return(0,b.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${m[0]}`)}}setDash(m,C){this.current.dashArray=m,this.current.dashPhase=C}constructPath(m,C){const q=this.current;let $=q.x,j=q.y,tt=[],nt=0;for(const yt of m)switch(yt|0){case b.OPS.rectangle:$=C[nt++],j=C[nt++];const dt=C[nt++],vt=C[nt++],Et=$+dt,ct=j+vt;tt.push("M",e($),e(j),"L",e(Et),e(j),"L",e(Et),e(ct),"L",e($),e(ct),"Z");break;case b.OPS.moveTo:$=C[nt++],j=C[nt++],tt.push("M",e($),e(j));break;case b.OPS.lineTo:$=C[nt++],j=C[nt++],tt.push("L",e($),e(j));break;case b.OPS.curveTo:$=C[nt+4],j=C[nt+5],tt.push("C",e(C[nt]),e(C[nt+1]),e(C[nt+2]),e(C[nt+3]),e($),e(j)),nt+=6;break;case b.OPS.curveTo2:tt.push("C",e($),e(j),e(C[nt]),e(C[nt+1]),e(C[nt+2]),e(C[nt+3])),$=C[nt+2],j=C[nt+3],nt+=4;break;case b.OPS.curveTo3:$=C[nt+2],j=C[nt+3],tt.push("C",e(C[nt]),e(C[nt+1]),e($),e(j),e($),e(j)),nt+=4;break;case b.OPS.closePath:tt.push("Z");break}tt=tt.join(" "),q.path&&m.length>0&&m[0]!==b.OPS.rectangle&&m[0]!==b.OPS.moveTo?tt=q.path.getAttributeNS(null,"d")+tt:(q.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(q.path)),q.path.setAttributeNS(null,"d",tt),q.path.setAttributeNS(null,"fill","none"),q.element=q.path,q.setCurrentPoint($,j)}endPath(){const m=this.current;if(m.path=null,!this.pendingClip)return;if(!m.element){this.pendingClip=null;return}const C=`clippath${v++}`,q=this.svgFactory.createElement("svg:clipPath");q.setAttributeNS(null,"id",C),q.setAttributeNS(null,"transform",g(this.transformMatrix));const $=m.element.cloneNode(!0);if(this.pendingClip==="evenodd"?$.setAttributeNS(null,"clip-rule","evenodd"):$.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,q.append($),this.defs.append(q),m.activeClipUrl){m.clipGroup=null;for(const j of this.extraStack)j.clipGroup=null;q.setAttributeNS(null,"clip-path",m.activeClipUrl)}m.activeClipUrl=`url(#${C})`,this.tgrp=null}clip(m){this.pendingClip=m}closePath(){const m=this.current;if(m.path){const C=`${m.path.getAttributeNS(null,"d")}Z`;m.path.setAttributeNS(null,"d",C)}}setLeading(m){this.current.leading=-m}setTextRise(m){this.current.textRise=m}setTextRenderingMode(m){this.current.textRenderingMode=m}setHScale(m){this.current.textHScale=m/100}setRenderingIntent(m){}setFlatness(m){}setGState(m){for(const[C,q]of m)switch(C){case"LW":this.setLineWidth(q);break;case"LC":this.setLineCap(q);break;case"LJ":this.setLineJoin(q);break;case"ML":this.setMiterLimit(q);break;case"D":this.setDash(q[0],q[1]);break;case"RI":this.setRenderingIntent(q);break;case"FL":this.setFlatness(q);break;case"Font":this.setFont(q);break;case"CA":this.setStrokeAlpha(q);break;case"ca":this.setFillAlpha(q);break;default:(0,b.warn)(`Unimplemented graphic state operator ${C}`);break}}fill(){const m=this.current;m.element&&(m.element.setAttributeNS(null,"fill",m.fillColor),m.element.setAttributeNS(null,"fill-opacity",m.fillAlpha),this.endPath())}stroke(){const m=this.current;m.element&&(this._setStrokeAttributes(m.element),m.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(m,C=1){const q=this.current;let $=q.dashArray;C!==1&&$.length>0&&($=$.map(function(j){return C*j})),m.setAttributeNS(null,"stroke",q.strokeColor),m.setAttributeNS(null,"stroke-opacity",q.strokeAlpha),m.setAttributeNS(null,"stroke-miterlimit",e(q.miterLimit)),m.setAttributeNS(null,"stroke-linecap",q.lineCap),m.setAttributeNS(null,"stroke-linejoin",q.lineJoin),m.setAttributeNS(null,"stroke-width",e(C*q.lineWidth)+"px"),m.setAttributeNS(null,"stroke-dasharray",$.map(e).join(" ")),m.setAttributeNS(null,"stroke-dashoffset",e(C*q.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const m=this.svgFactory.createElement("svg:rect");m.setAttributeNS(null,"x","0"),m.setAttributeNS(null,"y","0"),m.setAttributeNS(null,"width","1px"),m.setAttributeNS(null,"height","1px"),m.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(m)}paintImageXObject(m){const C=this.getObject(m);if(!C){(0,b.warn)(`Dependent image with object ID ${m} is not ready yet`);return}this.paintInlineImageXObject(C)}paintInlineImageXObject(m,C){const q=m.width,$=m.height,j=i(m,this.forceDataSchema,!!C),tt=this.svgFactory.createElement("svg:rect");tt.setAttributeNS(null,"x","0"),tt.setAttributeNS(null,"y","0"),tt.setAttributeNS(null,"width",e(q)),tt.setAttributeNS(null,"height",e($)),this.current.element=tt,this.clip("nonzero");const nt=this.svgFactory.createElement("svg:image");nt.setAttributeNS(z,"xlink:href",j),nt.setAttributeNS(null,"x","0"),nt.setAttributeNS(null,"y",e(-$)),nt.setAttributeNS(null,"width",e(q)+"px"),nt.setAttributeNS(null,"height",e($)+"px"),nt.setAttributeNS(null,"transform",`scale(${e(1/q)} ${e(-1/$)})`),C?C.append(nt):this._ensureTransformGroup().append(nt)}paintImageMaskXObject(m){const C=this.getObject(m.data,m);if(C.bitmap){(0,b.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const q=this.current,$=C.width,j=C.height,tt=q.fillColor;q.maskId=`mask${l++}`;const nt=this.svgFactory.createElement("svg:mask");nt.setAttributeNS(null,"id",q.maskId);const yt=this.svgFactory.createElement("svg:rect");yt.setAttributeNS(null,"x","0"),yt.setAttributeNS(null,"y","0"),yt.setAttributeNS(null,"width",e($)),yt.setAttributeNS(null,"height",e(j)),yt.setAttributeNS(null,"fill",tt),yt.setAttributeNS(null,"mask",`url(#${q.maskId})`),this.defs.append(nt),this._ensureTransformGroup().append(yt),this.paintInlineImageXObject(C,nt)}paintFormXObjectBegin(m,C){if(Array.isArray(m)&&m.length===6&&this.transform(m[0],m[1],m[2],m[3],m[4],m[5]),C){const q=C[2]-C[0],$=C[3]-C[1],j=this.svgFactory.createElement("svg:rect");j.setAttributeNS(null,"x",C[0]),j.setAttributeNS(null,"y",C[1]),j.setAttributeNS(null,"width",e(q)),j.setAttributeNS(null,"height",e($)),this.current.element=j,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(m){const C=this.svgFactory.create(m.width,m.height),q=this.svgFactory.createElement("svg:defs");C.append(q),this.defs=q;const $=this.svgFactory.createElement("svg:g");return $.setAttributeNS(null,"transform",g(m.transform)),C.append($),this.svg=$,C}_ensureClipGroup(){if(!this.current.clipGroup){const m=this.svgFactory.createElement("svg:g");m.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(m),this.current.clipGroup=m}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",g(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}a.SVGGraphics=M}),((d,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.XfaText=void 0;class I{static textContent(b){const n=[],x={items:n,styles:Object.create(null)};function z(W){if(!W)return;let r=null;const t=W.name;if(t==="#text")r=W.value;else if(I.shouldBuildText(t))W?.attributes?.textContent?r=W.attributes.textContent:W.value&&(r=W.value);else return;if(r!==null&&n.push({str:r}),!!W.children)for(const i of W.children)z(i)}return z(b),x}static shouldBuildText(b){return!(b==="textarea"||b==="input"||b==="option"||b==="select")}}a.XfaText=I}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.TextLayerRenderTask=void 0,a.renderTextLayer=g,a.updateTextLayer=v;var u=I(1),b=I(6);const n=1e5,x=30,z=.8,W=new Map;function r(l,w){let M;if(w&&u.FeatureTest.isOffscreenCanvasSupported)M=new OffscreenCanvas(l,l).getContext("2d",{alpha:!1});else{const R=document.createElement("canvas");R.width=R.height=l,M=R.getContext("2d",{alpha:!1})}return M}function t(l,w){const M=W.get(l);if(M)return M;const R=r(x,w);R.font=`${x}px ${l}`;const m=R.measureText("");let C=m.fontBoundingBoxAscent,q=Math.abs(m.fontBoundingBoxDescent);if(C){const j=C/(C+q);return W.set(l,j),R.canvas.width=R.canvas.height=0,j}R.strokeStyle="red",R.clearRect(0,0,x,x),R.strokeText("g",0,0);let $=R.getImageData(0,0,x,x).data;q=0;for(let j=$.length-1-3;j>=0;j-=4)if($[j]>0){q=Math.ceil(j/4/x);break}R.clearRect(0,0,x,x),R.strokeText("A",0,x),$=R.getImageData(0,0,x,x).data,C=0;for(let j=0,tt=$.length;j<tt;j+=4)if($[j]>0){C=x-Math.floor(j/4/x);break}if(R.canvas.width=R.canvas.height=0,C){const j=C/(C+q);return W.set(l,j),j}return W.set(l,z),z}function i(l,w,M){const R=document.createElement("span"),m={angle:0,canvasWidth:0,hasText:w.str!=="",hasEOL:w.hasEOL,fontSize:0};l._textDivs.push(R);const C=u.Util.transform(l._transform,w.transform);let q=Math.atan2(C[1],C[0]);const $=M[w.fontName];$.vertical&&(q+=Math.PI/2);const j=Math.hypot(C[2],C[3]),tt=j*t($.fontFamily,l._isOffscreenCanvasSupported);let nt,yt;q===0?(nt=C[4],yt=C[5]-tt):(nt=C[4]+tt*Math.sin(q),yt=C[5]-tt*Math.cos(q));const dt="calc(var(--scale-factor)*",vt=R.style;l._container===l._rootContainer?(vt.left=`${(100*nt/l._pageWidth).toFixed(2)}%`,vt.top=`${(100*yt/l._pageHeight).toFixed(2)}%`):(vt.left=`${dt}${nt.toFixed(2)}px)`,vt.top=`${dt}${yt.toFixed(2)}px)`),vt.fontSize=`${dt}${j.toFixed(2)}px)`,vt.fontFamily=$.fontFamily,m.fontSize=j,R.setAttribute("role","presentation"),R.textContent=w.str,R.dir=w.dir,l._fontInspectorEnabled&&(R.dataset.fontName=w.fontName),q!==0&&(m.angle=q*(180/Math.PI));let Et=!1;if(w.str.length>1)Et=!0;else if(w.str!==" "&&w.transform[0]!==w.transform[3]){const ct=Math.abs(w.transform[0]),O=Math.abs(w.transform[3]);ct!==O&&Math.max(ct,O)/Math.min(ct,O)>1.5&&(Et=!0)}Et&&(m.canvasWidth=$.vertical?w.height:w.width),l._textDivProperties.set(R,m),l._isReadableStream&&l._layoutText(R)}function h(l){const{div:w,scale:M,properties:R,ctx:m,prevFontSize:C,prevFontFamily:q}=l,{style:$}=w;let j="";if(R.canvasWidth!==0&&R.hasText){const{fontFamily:tt}=$,{canvasWidth:nt,fontSize:yt}=R;(C!==yt||q!==tt)&&(m.font=`${yt*M}px ${tt}`,l.prevFontSize=yt,l.prevFontFamily=tt);const{width:dt}=m.measureText(w.textContent);dt>0&&(j=`scaleX(${nt*M/dt})`)}R.angle!==0&&(j=`rotate(${R.angle}deg) ${j}`),j.length>0&&($.transform=j)}function c(l){if(l._canceled)return;const w=l._textDivs,M=l._capability;if(w.length>n){M.resolve();return}if(!l._isReadableStream)for(const m of w)l._layoutText(m);M.resolve()}class e{constructor({textContentSource:w,container:M,viewport:R,textDivs:m,textDivProperties:C,textContentItemsStr:q,isOffscreenCanvasSupported:$}){this._textContentSource=w,this._isReadableStream=w instanceof ReadableStream,this._container=this._rootContainer=M,this._textDivs=m||[],this._textContentItemsStr=q||[],this._isOffscreenCanvasSupported=$,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=C||new WeakMap,this._canceled=!1,this._capability=new u.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:R.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:r(0,$)};const{pageWidth:j,pageHeight:tt,pageX:nt,pageY:yt}=R.rawDims;this._transform=[1,0,0,-1,-nt,yt+tt],this._pageWidth=j,this._pageHeight=tt,(0,b.setLayerDimensions)(M,R),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new u.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new u.AbortException("TextLayer task cancelled."))}_processItems(w,M){for(const R of w){if(R.str===void 0){if(R.type==="beginMarkedContentProps"||R.type==="beginMarkedContent"){const m=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),R.id!==null&&this._container.setAttribute("id",`${R.id}`),m.append(this._container)}else R.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(R.str),i(this,R,M)}}_layoutText(w){const M=this._layoutTextParams.properties=this._textDivProperties.get(w);if(this._layoutTextParams.div=w,h(this._layoutTextParams),M.hasText&&this._container.append(w),M.hasEOL){const R=document.createElement("br");R.setAttribute("role","presentation"),this._container.append(R)}}_render(){const w=new u.PromiseCapability;let M=Object.create(null);if(this._isReadableStream){const R=()=>{this._reader.read().then(({value:m,done:C})=>{if(C){w.resolve();return}Object.assign(M,m.styles),this._processItems(m.items,M),R()},w.reject)};this._reader=this._textContentSource.getReader(),R()}else if(this._textContentSource){const{items:R,styles:m}=this._textContentSource;this._processItems(R,m),w.resolve()}else throw new Error('No "textContentSource" parameter specified.');w.promise.then(()=>{M=null,c(this)},this._capability.reject)}}a.TextLayerRenderTask=e;function g(l){!l.textContentSource&&(l.textContent||l.textContentStream)&&((0,b.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),l.textContentSource=l.textContent||l.textContentStream);const{container:w,viewport:M}=l,R=getComputedStyle(w),m=R.getPropertyValue("visibility"),C=parseFloat(R.getPropertyValue("--scale-factor"));m==="visible"&&(!C||Math.abs(C-M.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const q=new e(l);return q._render(),q}function v({container:l,viewport:w,textDivs:M,textDivProperties:R,isOffscreenCanvasSupported:m,mustRotate:C=!0,mustRescale:q=!0}){if(C&&(0,b.setLayerDimensions)(l,{rotation:w.rotation}),q){const $=r(0,m),tt={prevFontSize:null,prevFontFamily:null,div:null,scale:w.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:$};for(const nt of M)tt.properties=R.get(nt),tt.div=nt,h(tt)}}}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.AnnotationEditorLayer=void 0;var u=I(1),b=I(4),n=I(28),x=I(33),z=I(6),W=I(34);class r{#t;#e=!1;#n=null;#i=this.pointerup.bind(this);#o=this.pointerdown.bind(this);#a=new Map;#s=!1;#l=!1;#c=!1;#r;static _initialized=!1;constructor({uiManager:i,pageIndex:h,div:c,accessibilityManager:e,annotationLayer:g,viewport:v,l10n:l}){const w=[n.FreeTextEditor,x.InkEditor,W.StampEditor];if(!r._initialized){r._initialized=!0;for(const M of w)M.initialize(l)}i.registerEditorTypes(w),this.#r=i,this.pageIndex=h,this.div=c,this.#t=e,this.#n=g,this.viewport=v,this.#r.addLayer(this)}get isEmpty(){return this.#a.size===0}updateToolbar(i){this.#r.updateToolbar(i)}updateMode(i=this.#r.getMode()){this.#p(),i===u.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),i!==u.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",i===u.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",i===u.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",i===u.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(i){if(!i&&this.#r.getMode()!==u.AnnotationEditorType.INK)return;if(!i){for(const c of this.#a.values())if(c.isEmpty()){c.setInBackground();return}}this.#h({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(i){this.#r.setEditingState(i)}addCommands(i){this.#r.addCommands(i)}enable(){this.div.style.pointerEvents="auto";const i=new Set;for(const c of this.#a.values())c.enableEditing(),c.annotationElementId&&i.add(c.annotationElementId);if(!this.#n)return;const h=this.#n.getEditableAnnotations();for(const c of h){if(c.hide(),this.#r.isDeletedAnnotationElement(c.data.id)||i.has(c.data.id))continue;const e=this.deserialize(c);e&&(this.addOrRebuild(e),e.enableEditing())}}disable(){this.#c=!0,this.div.style.pointerEvents="none";const i=new Set;for(const h of this.#a.values()){if(h.disableEditing(),!h.annotationElementId||h.serialize()!==null){i.add(h.annotationElementId);continue}this.getEditableAnnotation(h.annotationElementId)?.show(),h.remove()}if(this.#n){const h=this.#n.getEditableAnnotations();for(const c of h){const{id:e}=c.data;i.has(e)||this.#r.isDeletedAnnotationElement(e)||c.show()}}this.#p(),this.isEmpty&&(this.div.hidden=!0),this.#c=!1}getEditableAnnotation(i){return this.#n?.getEditableAnnotation(i)||null}setActiveEditor(i){this.#r.getActive()!==i&&this.#r.setActiveEditor(i)}enableClick(){this.div.addEventListener("pointerdown",this.#o),this.div.addEventListener("pointerup",this.#i)}disableClick(){this.div.removeEventListener("pointerdown",this.#o),this.div.removeEventListener("pointerup",this.#i)}attach(i){this.#a.set(i.id,i);const{annotationElementId:h}=i;h&&this.#r.isDeletedAnnotationElement(h)&&this.#r.removeDeletedAnnotationElement(i)}detach(i){this.#a.delete(i.id),this.#t?.removePointerInTextLayer(i.contentDiv),!this.#c&&i.annotationElementId&&this.#r.addDeletedAnnotationElement(i)}remove(i){this.detach(i),this.#r.removeEditor(i),i.div.contains(document.activeElement)&&setTimeout(()=>{this.#r.focusMainContainer()},0),i.div.remove(),i.isAttachedToDOM=!1,this.#l||this.addInkEditorIfNeeded(!1)}changeParent(i){i.parent!==this&&(i.annotationElementId&&(this.#r.addDeletedAnnotationElement(i.annotationElementId),b.AnnotationEditor.deleteAnnotationElement(i),i.annotationElementId=null),this.attach(i),i.parent?.detach(i),i.setParent(this),i.div&&i.isAttachedToDOM&&(i.div.remove(),this.div.append(i.div)))}add(i){if(this.changeParent(i),this.#r.addEditor(i),this.attach(i),!i.isAttachedToDOM){const h=i.render();this.div.append(h),i.isAttachedToDOM=!0}i.fixAndSetPosition(),i.onceAdded(),this.#r.addToAnnotationStorage(i)}moveEditorInDOM(i){if(!i.isAttachedToDOM)return;const{activeElement:h}=document;i.div.contains(h)&&(i._focusEventsAllowed=!1,setTimeout(()=>{i.div.contains(document.activeElement)?i._focusEventsAllowed=!0:(i.div.addEventListener("focusin",()=>{i._focusEventsAllowed=!0},{once:!0}),h.focus())},0)),i._structTreeParentId=this.#t?.moveElementInDOM(this.div,i.div,i.contentDiv,!0)}addOrRebuild(i){i.needsToBeRebuilt()?i.rebuild():this.add(i)}addUndoableEditor(i){const h=()=>i._uiManager.rebuild(i),c=()=>{i.remove()};this.addCommands({cmd:h,undo:c,mustExec:!1})}getNextId(){return this.#r.getId()}#f(i){switch(this.#r.getMode()){case u.AnnotationEditorType.FREETEXT:return new n.FreeTextEditor(i);case u.AnnotationEditorType.INK:return new x.InkEditor(i);case u.AnnotationEditorType.STAMP:return new W.StampEditor(i)}return null}pasteEditor(i,h){this.#r.updateToolbar(i),this.#r.updateMode(i);const{offsetX:c,offsetY:e}=this.#d(),g=this.getNextId(),v=this.#f({parent:this,id:g,x:c,y:e,uiManager:this.#r,isCentered:!0,...h});v&&this.add(v)}deserialize(i){switch(i.annotationType??i.annotationEditorType){case u.AnnotationEditorType.FREETEXT:return n.FreeTextEditor.deserialize(i,this,this.#r);case u.AnnotationEditorType.INK:return x.InkEditor.deserialize(i,this,this.#r);case u.AnnotationEditorType.STAMP:return W.StampEditor.deserialize(i,this,this.#r)}return null}#h(i,h){const c=this.getNextId(),e=this.#f({parent:this,id:c,x:i.offsetX,y:i.offsetY,uiManager:this.#r,isCentered:h});return e&&this.add(e),e}#d(){const{x:i,y:h,width:c,height:e}=this.div.getBoundingClientRect(),g=Math.max(0,i),v=Math.max(0,h),l=Math.min(window.innerWidth,i+c),w=Math.min(window.innerHeight,h+e),M=(g+l)/2-i,R=(v+w)/2-h,[m,C]=this.viewport.rotation%180===0?[M,R]:[R,M];return{offsetX:m,offsetY:C}}addNewEditor(){this.#h(this.#d(),!0)}setSelected(i){this.#r.setSelected(i)}toggleSelected(i){this.#r.toggleSelected(i)}isSelected(i){return this.#r.isSelected(i)}unselect(i){this.#r.unselect(i)}pointerup(i){const{isMac:h}=u.FeatureTest.platform;if(!(i.button!==0||i.ctrlKey&&h)&&i.target===this.div&&this.#s){if(this.#s=!1,!this.#e){this.#e=!0;return}if(this.#r.getMode()===u.AnnotationEditorType.STAMP){this.#r.unselectAll();return}this.#h(i,!1)}}pointerdown(i){if(this.#s){this.#s=!1;return}const{isMac:h}=u.FeatureTest.platform;if(i.button!==0||i.ctrlKey&&h||i.target!==this.div)return;this.#s=!0;const c=this.#r.getActive();this.#e=!c||c.isEmpty()}findNewParent(i,h,c){const e=this.#r.findParent(h,c);return e===null||e===this?!1:(e.changeParent(i),!0)}destroy(){this.#r.getActive()?.parent===this&&(this.#r.commitOrRemove(),this.#r.setActiveEditor(null));for(const i of this.#a.values())this.#t?.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,this.#a.clear(),this.#r.removeLayer(this)}#p(){this.#l=!0;for(const i of this.#a.values())i.isEmpty()&&i.remove();this.#l=!1}render({viewport:i}){this.viewport=i,(0,z.setLayerDimensions)(this.div,i);for(const h of this.#r.getEditors(this.pageIndex))this.add(h);this.updateMode()}update({viewport:i}){this.#r.commitOrRemove(),this.viewport=i,(0,z.setLayerDimensions)(this.div,{rotation:i.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:i,pageHeight:h}=this.viewport.rawDims;return[i,h]}}a.AnnotationEditorLayer=r}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.FreeTextEditor=void 0;var u=I(1),b=I(5),n=I(4),x=I(29);class z extends n.AnnotationEditor{#t=this.editorDivBlur.bind(this);#e=this.editorDivFocus.bind(this);#n=this.editorDivInput.bind(this);#i=this.editorDivKeydown.bind(this);#o;#a="";#s=`${this.id}-editor`;#l;#c=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const r=z.prototype,t=c=>c.isEmpty(),i=b.AnnotationEditorUIManager.TRANSLATE_SMALL,h=b.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,u.shadow)(this,"_keyboardManager",new b.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],r.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],r.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],r._translateEmpty,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],r._translateEmpty,{args:[-h,0],checker:t}],[["ArrowRight","mac+ArrowRight"],r._translateEmpty,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],r._translateEmpty,{args:[h,0],checker:t}],[["ArrowUp","mac+ArrowUp"],r._translateEmpty,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],r._translateEmpty,{args:[0,-h],checker:t}],[["ArrowDown","mac+ArrowDown"],r._translateEmpty,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],r._translateEmpty,{args:[0,h],checker:t}]]))}static _type="freetext";constructor(r){super({...r,name:"freeTextEditor"}),this.#o=r.color||z._defaultColor||n.AnnotationEditor._defaultLineColor,this.#l=r.fontSize||z._defaultFontSize}static initialize(r){n.AnnotationEditor.initialize(r,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const t=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(t.getPropertyValue("--freetext-padding"))}static updateDefaultParams(r,t){switch(r){case u.AnnotationEditorParamsType.FREETEXT_SIZE:z._defaultFontSize=t;break;case u.AnnotationEditorParamsType.FREETEXT_COLOR:z._defaultColor=t;break}}updateParams(r,t){switch(r){case u.AnnotationEditorParamsType.FREETEXT_SIZE:this.#r(t);break;case u.AnnotationEditorParamsType.FREETEXT_COLOR:this.#f(t);break}}static get defaultPropertiesToUpdate(){return[[u.AnnotationEditorParamsType.FREETEXT_SIZE,z._defaultFontSize],[u.AnnotationEditorParamsType.FREETEXT_COLOR,z._defaultColor||n.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[u.AnnotationEditorParamsType.FREETEXT_SIZE,this.#l],[u.AnnotationEditorParamsType.FREETEXT_COLOR,this.#o]]}#r(r){const t=h=>{this.editorDiv.style.fontSize=`calc(${h}px * var(--scale-factor))`,this.translate(0,-(h-this.#l)*this.parentScale),this.#l=h,this.#d()},i=this.#l;this.addCommands({cmd:()=>{t(r)},undo:()=>{t(i)},mustExec:!0,type:u.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#f(r){const t=this.#o;this.addCommands({cmd:()=>{this.#o=this.editorDiv.style.color=r},undo:()=>{this.#o=this.editorDiv.style.color=t},mustExec:!0,type:u.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(r,t){this._uiManager.translateSelectedEditors(r,t,!0)}getInitialTranslation(){const r=this.parentScale;return[-z._internalPadding*r,-(z._internalPadding+this.#l)*r]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(u.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#i),this.editorDiv.addEventListener("focus",this.#e),this.editorDiv.addEventListener("blur",this.#t),this.editorDiv.addEventListener("input",this.#n))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#s),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",this.#i),this.editorDiv.removeEventListener("focus",this.#e),this.editorDiv.removeEventListener("blur",this.#t),this.editorDiv.removeEventListener("input",this.#n),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(r){this._focusEventsAllowed&&(super.focusin(r),r.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){if(this.width){this.#m();return}this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}#h(){const r=this.editorDiv.getElementsByTagName("div");if(r.length===0)return this.editorDiv.innerText;const t=[];for(const i of r)t.push(i.innerText.replace(/\r\n?|\n/,""));return t.join(`
`)}#d(){const[r,t]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:h,div:c}=this,e=c.style.display;c.style.display="hidden",h.div.append(this.div),i=c.getBoundingClientRect(),c.remove(),c.style.display=e}this.rotation%180===this.parentRotation%180?(this.width=i.width/r,this.height=i.height/t):(this.width=i.height/r,this.height=i.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const r=this.#a,t=this.#a=this.#h().trimEnd();if(r===t)return;const i=h=>{if(this.#a=h,!h){this.remove();return}this.#p(),this._uiManager.rebuild(this),this.#d()};this.addCommands({cmd:()=>{i(t)},undo:()=>{i(r)},mustExec:!1}),this.#d()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(r){this.enterInEditMode()}keydown(r){r.target===this.div&&r.key==="Enter"&&(this.enterInEditMode(),r.preventDefault())}editorDivKeydown(r){z._keyboardManager.exec(this,r)}editorDivFocus(r){this.isEditing=!0}editorDivBlur(r){this.isEditing=!1}editorDivInput(r){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let r,t;this.width&&(r=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#s),this.enableEditing(),n.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(h=>this.editorDiv?.setAttribute("aria-label",h)),n.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(h=>this.editorDiv?.setAttribute("default-content",h)),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#l}px * var(--scale-factor))`,i.color=this.#o,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,b.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[h,c]=this.parentDimensions;if(this.annotationElementId){const{position:e}=this.#c;let[g,v]=this.getInitialTranslation();[g,v]=this.pageTranslationToScreen(g,v);const[l,w]=this.pageDimensions,[M,R]=this.pageTranslation;let m,C;switch(this.rotation){case 0:m=r+(e[0]-M)/l,C=t+this.height-(e[1]-R)/w;break;case 90:m=r+(e[0]-M)/l,C=t-(e[1]-R)/w,[g,v]=[v,-g];break;case 180:m=r-this.width+(e[0]-M)/l,C=t-(e[1]-R)/w,[g,v]=[-g,-v];break;case 270:m=r+(e[0]-M-this.height*w)/l,C=t+(e[1]-R-this.width*l)/w,[g,v]=[-v,g];break}this.setAt(m*h,C*c,g,v)}else this.setAt(r*h,t*c,this.width*h,this.height*c);this.#p(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}#p(){if(this.editorDiv.replaceChildren(),!!this.#a)for(const r of this.#a.split(`
`)){const t=document.createElement("div");t.append(r?document.createTextNode(r):document.createElement("br")),this.editorDiv.append(t)}}get contentDiv(){return this.editorDiv}static deserialize(r,t,i){let h=null;if(r instanceof x.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:e,fontColor:g},rect:v,rotation:l,id:w},textContent:M,textPosition:R,parent:{page:{pageNumber:m}}}=r;if(!M||M.length===0)return null;h=r={annotationType:u.AnnotationEditorType.FREETEXT,color:Array.from(g),fontSize:e,value:M.join(`
`),position:R,pageIndex:m-1,rect:v,rotation:l,id:w,deleted:!1}}const c=super.deserialize(r,t,i);return c.#l=r.fontSize,c.#o=u.Util.makeHexColor(...r.color),c.#a=r.value,c.annotationElementId=r.id||null,c.#c=h,c}serialize(r=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const t=z._internalPadding*this.parentScale,i=this.getRect(t,t),h=n.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#o),c={annotationType:u.AnnotationEditorType.FREETEXT,color:h,fontSize:this.#l,value:this.#a,pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return r?c:this.annotationElementId&&!this.#v(c)?null:(c.id=this.annotationElementId,c)}#v(r){const{value:t,fontSize:i,color:h,rect:c,pageIndex:e}=this.#c;return r.value!==t||r.fontSize!==i||r.rect.some((g,v)=>Math.abs(g-c[v])>=1)||r.color.some((g,v)=>g!==h[v])||r.pageIndex!==e}#m(r=!1){if(!this.annotationElementId)return;if(this.#d(),!r&&(this.width===0||this.height===0)){setTimeout(()=>this.#m(!0),0);return}const t=z._internalPadding*this.parentScale;this.#c.rect=this.getRect(t,t)}}a.FreeTextEditor=z}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.StampAnnotationElement=a.InkAnnotationElement=a.FreeTextAnnotationElement=a.AnnotationLayer=void 0;var u=I(1),b=I(6),n=I(3),x=I(30),z=I(31),W=I(32);const r=1e3,t=9,i=new WeakSet;function h(T){return{width:T[2]-T[0],height:T[3]-T[1]}}class c{static create(s){switch(s.data.annotationType){case u.AnnotationType.LINK:return new g(s);case u.AnnotationType.TEXT:return new v(s);case u.AnnotationType.WIDGET:switch(s.data.fieldType){case"Tx":return new w(s);case"Btn":return s.data.radioButton?new m(s):s.data.checkBox?new R(s):new C(s);case"Ch":return new q(s);case"Sig":return new M(s)}return new l(s);case u.AnnotationType.POPUP:return new $(s);case u.AnnotationType.FREETEXT:return new tt(s);case u.AnnotationType.LINE:return new nt(s);case u.AnnotationType.SQUARE:return new yt(s);case u.AnnotationType.CIRCLE:return new dt(s);case u.AnnotationType.POLYLINE:return new vt(s);case u.AnnotationType.CARET:return new ct(s);case u.AnnotationType.INK:return new O(s);case u.AnnotationType.POLYGON:return new Et(s);case u.AnnotationType.HIGHLIGHT:return new A(s);case u.AnnotationType.UNDERLINE:return new f(s);case u.AnnotationType.SQUIGGLY:return new p(s);case u.AnnotationType.STRIKEOUT:return new S(s);case u.AnnotationType.STAMP:return new L(s);case u.AnnotationType.FILEATTACHMENT:return new F(s);default:return new e(s)}}}class e{#t=!1;constructor(s,{isRenderable:_=!1,ignoreBorder:E=!1,createQuadrilaterals:P=!1}={}){this.isRenderable=_,this.data=s.data,this.layer=s.layer,this.linkService=s.linkService,this.downloadManager=s.downloadManager,this.imageResourcesPath=s.imageResourcesPath,this.renderForms=s.renderForms,this.svgFactory=s.svgFactory,this.annotationStorage=s.annotationStorage,this.enableScripting=s.enableScripting,this.hasJSActions=s.hasJSActions,this._fieldObjects=s.fieldObjects,this.parent=s.parent,_&&(this.container=this._createContainer(E)),P&&this._createQuadrilaterals()}static _hasPopupData({titleObj:s,contentsObj:_,richText:E}){return!!(s?.str||_?.str||E?.str)}get hasPopupData(){return e._hasPopupData(this.data)}_createContainer(s){const{data:_,parent:{page:E,viewport:P}}=this,k=document.createElement("section");k.setAttribute("data-annotation-id",_.id),this instanceof l||(k.tabIndex=r),k.style.zIndex=this.parent.zIndex++,this.data.popupRef&&k.setAttribute("aria-haspopup","dialog"),_.noRotate&&k.classList.add("norotate");const{pageWidth:U,pageHeight:X,pageX:it,pageY:At}=P.rawDims;if(!_.rect||this instanceof $){const{rotation:gt}=_;return!_.hasOwnCanvas&&gt!==0&&this.setRotation(gt,k),k}const{width:rt,height:st}=h(_.rect),ut=u.Util.normalizeRect([_.rect[0],E.view[3]-_.rect[1]+E.view[1],_.rect[2],E.view[3]-_.rect[3]+E.view[1]]);if(!s&&_.borderStyle.width>0){k.style.borderWidth=`${_.borderStyle.width}px`;const gt=_.borderStyle.horizontalCornerRadius,Ct=_.borderStyle.verticalCornerRadius;if(gt>0||Ct>0){const Bt=`calc(${gt}px * var(--scale-factor)) / calc(${Ct}px * var(--scale-factor))`;k.style.borderRadius=Bt}else if(this instanceof m){const Bt=`calc(${rt}px * var(--scale-factor)) / calc(${st}px * var(--scale-factor))`;k.style.borderRadius=Bt}switch(_.borderStyle.style){case u.AnnotationBorderStyleType.SOLID:k.style.borderStyle="solid";break;case u.AnnotationBorderStyleType.DASHED:k.style.borderStyle="dashed";break;case u.AnnotationBorderStyleType.BEVELED:(0,u.warn)("Unimplemented border style: beveled");break;case u.AnnotationBorderStyleType.INSET:(0,u.warn)("Unimplemented border style: inset");break;case u.AnnotationBorderStyleType.UNDERLINE:k.style.borderBottomStyle="solid";break}const Lt=_.borderColor||null;Lt?(this.#t=!0,k.style.borderColor=u.Util.makeHexColor(Lt[0]|0,Lt[1]|0,Lt[2]|0)):k.style.borderWidth=0}k.style.left=`${100*(ut[0]-it)/U}%`,k.style.top=`${100*(ut[1]-At)/X}%`;const{rotation:ht}=_;return _.hasOwnCanvas||ht===0?(k.style.width=`${100*rt/U}%`,k.style.height=`${100*st/X}%`):this.setRotation(ht,k),k}setRotation(s,_=this.container){if(!this.data.rect)return;const{pageWidth:E,pageHeight:P}=this.parent.viewport.rawDims,{width:k,height:U}=h(this.data.rect);let X,it;s%180===0?(X=100*k/E,it=100*U/P):(X=100*U/E,it=100*k/P),_.style.width=`${X}%`,_.style.height=`${it}%`,_.setAttribute("data-main-rotation",(360-s)%360)}get _commonActions(){const s=(_,E,P)=>{const k=P.detail[_],U=k[0],X=k.slice(1);P.target.style[E]=x.ColorConverters[`${U}_HTML`](X),this.annotationStorage.setValue(this.data.id,{[E]:x.ColorConverters[`${U}_rgb`](X)})};return(0,u.shadow)(this,"_commonActions",{display:_=>{const{display:E}=_.detail,P=E%2===1;this.container.style.visibility=P?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:P,noPrint:E===1||E===2})},print:_=>{this.annotationStorage.setValue(this.data.id,{noPrint:!_.detail.print})},hidden:_=>{const{hidden:E}=_.detail;this.container.style.visibility=E?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:E,noView:E})},focus:_=>{setTimeout(()=>_.target.focus({preventScroll:!1}),0)},userName:_=>{_.target.title=_.detail.userName},readonly:_=>{_.target.disabled=_.detail.readonly},required:_=>{this._setRequired(_.target,_.detail.required)},bgColor:_=>{s("bgColor","backgroundColor",_)},fillColor:_=>{s("fillColor","backgroundColor",_)},fgColor:_=>{s("fgColor","color",_)},textColor:_=>{s("textColor","color",_)},borderColor:_=>{s("borderColor","borderColor",_)},strokeColor:_=>{s("strokeColor","borderColor",_)},rotation:_=>{const E=_.detail.rotation;this.setRotation(E),this.annotationStorage.setValue(this.data.id,{rotation:E})}})}_dispatchEventFromSandbox(s,_){const E=this._commonActions;for(const P of Object.keys(_.detail))(s[P]||E[P])?.(_)}_setDefaultPropertiesFromJS(s){if(!this.enableScripting)return;const _=this.annotationStorage.getRawValue(this.data.id);if(!_)return;const E=this._commonActions;for(const[P,k]of Object.entries(_)){const U=E[P];if(U){const X={detail:{[P]:k},target:s};U(X),delete _[P]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:s}=this.data;if(!s)return;const[_,E,P,k]=this.data.rect;if(s.length===1){const[,{x:Ct,y:Lt},{x:Bt,y:Xt}]=s[0];if(P===Ct&&k===Lt&&_===Bt&&E===Xt)return}const{style:U}=this.container;let X;if(this.#t){const{borderColor:Ct,borderWidth:Lt}=U;U.borderWidth=0,X=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Ct}" stroke-width="${Lt}">`],this.container.classList.add("hasBorder")}const it=P-_,At=k-E,{svgFactory:rt}=this,st=rt.createElement("svg");st.classList.add("quadrilateralsContainer"),st.setAttribute("width",0),st.setAttribute("height",0);const ut=rt.createElement("defs");st.append(ut);const ht=rt.createElement("clipPath"),gt=`clippath_${this.data.id}`;ht.setAttribute("id",gt),ht.setAttribute("clipPathUnits","objectBoundingBox"),ut.append(ht);for(const[,{x:Ct,y:Lt},{x:Bt,y:Xt}]of s){const $t=rt.createElement("rect"),ne=(Bt-_)/it,ke=(k-Lt)/At,Ae=(Ct-Bt)/it,He=(Lt-Xt)/At;$t.setAttribute("x",ne),$t.setAttribute("y",ke),$t.setAttribute("width",Ae),$t.setAttribute("height",He),ht.append($t),X?.push(`<rect vector-effect="non-scaling-stroke" x="${ne}" y="${ke}" width="${Ae}" height="${He}"/>`)}this.#t&&(X.push("</g></svg>')"),U.backgroundImage=X.join("")),this.container.append(st),this.container.style.clipPath=`url(#${gt})`}_createPopup(){const{container:s,data:_}=this;s.setAttribute("aria-haspopup","dialog");const E=new $({data:{color:_.color,titleObj:_.titleObj,modificationDate:_.modificationDate,contentsObj:_.contentsObj,richText:_.richText,parentRect:_.rect,borderStyle:0,id:`popup_${_.id}`,rotation:_.rotation},parent:this.parent,elements:[this]});this.parent.div.append(E.render())}render(){(0,u.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(s,_=null){const E=[];if(this._fieldObjects){const P=this._fieldObjects[s];if(P)for(const{page:k,id:U,exportValues:X}of P){if(k===-1||U===_)continue;const it=typeof X=="string"?X:null,At=document.querySelector(`[data-element-id="${U}"]`);if(At&&!i.has(At)){(0,u.warn)(`_getElementsByName - element not allowed: ${U}`);continue}E.push({id:U,exportValue:it,domElement:At})}return E}for(const P of document.getElementsByName(s)){const{exportValue:k}=P,U=P.getAttribute("data-element-id");U!==_&&i.has(P)&&E.push({id:U,exportValue:k,domElement:P})}return E}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const s=this.getElementsToTriggerPopup();if(Array.isArray(s))for(const _ of s)_.classList.add("highlightArea");else s.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:s,data:{id:_}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:s,editId:_})})}}class g extends e{constructor(s,_=null){super(s,{isRenderable:!0,ignoreBorder:!!_?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=s.data.isTooltipOnly}render(){const{data:s,linkService:_}=this,E=document.createElement("a");E.setAttribute("data-element-id",s.id);let P=!1;return s.url?(_.addLinkAttributes(E,s.url,s.newWindow),P=!0):s.action?(this._bindNamedAction(E,s.action),P=!0):s.attachment?(this._bindAttachment(E,s.attachment),P=!0):s.setOCGState?(this.#e(E,s.setOCGState),P=!0):s.dest?(this._bindLink(E,s.dest),P=!0):(s.actions&&(s.actions.Action||s.actions["Mouse Up"]||s.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(E,s),P=!0),s.resetForm?(this._bindResetFormAction(E,s.resetForm),P=!0):this.isTooltipOnly&&!P&&(this._bindLink(E,""),P=!0)),this.container.classList.add("linkAnnotation"),P&&this.container.append(E),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(s,_){s.href=this.linkService.getDestinationHash(_),s.onclick=()=>(_&&this.linkService.goToDestination(_),!1),(_||_==="")&&this.#t()}_bindNamedAction(s,_){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>(this.linkService.executeNamedAction(_),!1),this.#t()}_bindAttachment(s,_){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,_.content,_.filename),!1),this.#t()}#e(s,_){s.href=this.linkService.getAnchorUrl(""),s.onclick=()=>(this.linkService.executeSetOCGState(_),!1),this.#t()}_bindJSAction(s,_){s.href=this.linkService.getAnchorUrl("");const E=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const P of Object.keys(_.actions)){const k=E.get(P);k&&(s[k]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:_.id,name:P}}),!1))}s.onclick||(s.onclick=()=>!1),this.#t()}_bindResetFormAction(s,_){const E=s.onclick;if(E||(s.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){(0,u.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),E||(s.onclick=()=>!1);return}s.onclick=()=>{E?.();const{fields:P,refs:k,include:U}=_,X=[];if(P.length!==0||k.length!==0){const rt=new Set(k);for(const st of P){const ut=this._fieldObjects[st]||[];for(const{id:ht}of ut)rt.add(ht)}for(const st of Object.values(this._fieldObjects))for(const ut of st)rt.has(ut.id)===U&&X.push(ut)}else for(const rt of Object.values(this._fieldObjects))X.push(...rt);const it=this.annotationStorage,At=[];for(const rt of X){const{id:st}=rt;switch(At.push(st),rt.type){case"text":{const ht=rt.defaultValue||"";it.setValue(st,{value:ht});break}case"checkbox":case"radiobutton":{const ht=rt.defaultValue===rt.exportValues;it.setValue(st,{value:ht});break}case"combobox":case"listbox":{const ht=rt.defaultValue||"";it.setValue(st,{value:ht});break}default:continue}const ut=document.querySelector(`[data-element-id="${st}"]`);if(ut){if(!i.has(ut)){(0,u.warn)(`_bindResetFormAction - element not allowed: ${st}`);continue}}else continue;ut.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:At,name:"ResetForm"}}),!1}}}class v extends e{constructor(s){super(s,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const s=document.createElement("img");return s.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",s.alt="[{{type}} Annotation]",s.dataset.l10nId="text_annotation_type",s.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(s),this.container}}class l extends e{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(s){this.data.hasOwnCanvas&&(s.previousSibling?.nodeName==="CANVAS"&&(s.previousSibling.hidden=!0),s.hidden=!1)}_getKeyModifier(s){const{isWin:_,isMac:E}=u.FeatureTest.platform;return _&&s.ctrlKey||E&&s.metaKey}_setEventListener(s,_,E,P,k){E.includes("mouse")?s.addEventListener(E,U=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:P,value:k(U),shift:U.shiftKey,modifier:this._getKeyModifier(U)}})}):s.addEventListener(E,U=>{if(E==="blur"){if(!_.focused||!U.relatedTarget)return;_.focused=!1}else if(E==="focus"){if(_.focused)return;_.focused=!0}k&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:P,value:k(U)}})})}_setEventListeners(s,_,E,P){for(const[k,U]of E)(U==="Action"||this.data.actions?.[U])&&((U==="Focus"||U==="Blur")&&(_||={focused:!1}),this._setEventListener(s,_,k,U,P),U==="Focus"&&!this.data.actions?.Blur?this._setEventListener(s,_,"blur","Blur",null):U==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(s,_,"focus","Focus",null))}_setBackgroundColor(s){const _=this.data.backgroundColor||null;s.style.backgroundColor=_===null?"transparent":u.Util.makeHexColor(_[0],_[1],_[2])}_setTextStyle(s){const _=["left","center","right"],{fontColor:E}=this.data.defaultAppearanceData,P=this.data.defaultAppearanceData.fontSize||t,k=s.style;let U;const X=2,it=At=>Math.round(10*At)/10;if(this.data.multiLine){const At=Math.abs(this.data.rect[3]-this.data.rect[1]-X),rt=Math.round(At/(u.LINE_FACTOR*P))||1,st=At/rt;U=Math.min(P,it(st/u.LINE_FACTOR))}else{const At=Math.abs(this.data.rect[3]-this.data.rect[1]-X);U=Math.min(P,it(At/u.LINE_FACTOR))}k.fontSize=`calc(${U}px * var(--scale-factor))`,k.color=u.Util.makeHexColor(E[0],E[1],E[2]),this.data.textAlignment!==null&&(k.textAlign=_[this.data.textAlignment])}_setRequired(s,_){_?s.setAttribute("required",!0):s.removeAttribute("required"),s.setAttribute("aria-required",_)}}class w extends l{constructor(s){const _=s.renderForms||!s.data.hasAppearance&&!!s.data.fieldValue;super(s,{isRenderable:_})}setPropertyOnSiblings(s,_,E,P){const k=this.annotationStorage;for(const U of this._getElementsByName(s.name,s.id))U.domElement&&(U.domElement[_]=E),k.setValue(U.id,{[P]:E})}render(){const s=this.annotationStorage,_=this.data.id;this.container.classList.add("textWidgetAnnotation");let E=null;if(this.renderForms){const P=s.getValue(_,{value:this.data.fieldValue});let k=P.value||"";const U=s.getValue(_,{charLimit:this.data.maxLen}).charLimit;U&&k.length>U&&(k=k.slice(0,U));let X=P.formattedValue||this.data.textContent?.join(`
`)||null;X&&this.data.comb&&(X=X.replaceAll(/\s+/g,""));const it={userValue:k,formattedValue:X,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(E=document.createElement("textarea"),E.textContent=X??k,this.data.doNotScroll&&(E.style.overflowY="hidden")):(E=document.createElement("input"),E.type="text",E.setAttribute("value",X??k),this.data.doNotScroll&&(E.style.overflowX="hidden")),this.data.hasOwnCanvas&&(E.hidden=!0),i.add(E),E.setAttribute("data-element-id",_),E.disabled=this.data.readOnly,E.name=this.data.fieldName,E.tabIndex=r,this._setRequired(E,this.data.required),U&&(E.maxLength=U),E.addEventListener("input",rt=>{s.setValue(_,{value:rt.target.value}),this.setPropertyOnSiblings(E,"value",rt.target.value,"value"),it.formattedValue=null}),E.addEventListener("resetform",rt=>{const st=this.data.defaultFieldValue??"";E.value=it.userValue=st,it.formattedValue=null});let At=rt=>{const{formattedValue:st}=it;st!=null&&(rt.target.value=st),rt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){E.addEventListener("focus",st=>{if(it.focused)return;const{target:ut}=st;it.userValue&&(ut.value=it.userValue),it.lastCommittedValue=ut.value,it.commitKey=1,it.focused=!0}),E.addEventListener("updatefromsandbox",st=>{this.showElementAndHideCanvas(st.target);const ut={value(ht){it.userValue=ht.detail.value??"",s.setValue(_,{value:it.userValue.toString()}),ht.target.value=it.userValue},formattedValue(ht){const{formattedValue:gt}=ht.detail;it.formattedValue=gt,gt!=null&&ht.target!==document.activeElement&&(ht.target.value=gt),s.setValue(_,{formattedValue:gt})},selRange(ht){ht.target.setSelectionRange(...ht.detail.selRange)},charLimit:ht=>{const{charLimit:gt}=ht.detail,{target:Ct}=ht;if(gt===0){Ct.removeAttribute("maxLength");return}Ct.setAttribute("maxLength",gt);let Lt=it.userValue;!Lt||Lt.length<=gt||(Lt=Lt.slice(0,gt),Ct.value=it.userValue=Lt,s.setValue(_,{value:Lt}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:_,name:"Keystroke",value:Lt,willCommit:!0,commitKey:1,selStart:Ct.selectionStart,selEnd:Ct.selectionEnd}}))}};this._dispatchEventFromSandbox(ut,st)}),E.addEventListener("keydown",st=>{it.commitKey=1;let ut=-1;if(st.key==="Escape"?ut=0:st.key==="Enter"&&!this.data.multiLine?ut=2:st.key==="Tab"&&(it.commitKey=3),ut===-1)return;const{value:ht}=st.target;it.lastCommittedValue!==ht&&(it.lastCommittedValue=ht,it.userValue=ht,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:_,name:"Keystroke",value:ht,willCommit:!0,commitKey:ut,selStart:st.target.selectionStart,selEnd:st.target.selectionEnd}}))});const rt=At;At=null,E.addEventListener("blur",st=>{if(!it.focused||!st.relatedTarget)return;it.focused=!1;const{value:ut}=st.target;it.userValue=ut,it.lastCommittedValue!==ut&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:_,name:"Keystroke",value:ut,willCommit:!0,commitKey:it.commitKey,selStart:st.target.selectionStart,selEnd:st.target.selectionEnd}}),rt(st)}),this.data.actions?.Keystroke&&E.addEventListener("beforeinput",st=>{it.lastCommittedValue=null;const{data:ut,target:ht}=st,{value:gt,selectionStart:Ct,selectionEnd:Lt}=ht;let Bt=Ct,Xt=Lt;switch(st.inputType){case"deleteWordBackward":{const $t=gt.substring(0,Ct).match(/\w*[^\w]*$/);$t&&(Bt-=$t[0].length);break}case"deleteWordForward":{const $t=gt.substring(Ct).match(/^[^\w]*\w*/);$t&&(Xt+=$t[0].length);break}case"deleteContentBackward":Ct===Lt&&(Bt-=1);break;case"deleteContentForward":Ct===Lt&&(Xt+=1);break}st.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:_,name:"Keystroke",value:gt,change:ut||"",willCommit:!1,selStart:Bt,selEnd:Xt}})}),this._setEventListeners(E,it,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],st=>st.target.value)}if(At&&E.addEventListener("blur",At),this.data.comb){const st=(this.data.rect[2]-this.data.rect[0])/U;E.classList.add("comb"),E.style.letterSpacing=`calc(${st}px * var(--scale-factor) - 1ch)`}}else E=document.createElement("div"),E.textContent=this.data.fieldValue,E.style.verticalAlign="middle",E.style.display="table-cell";return this._setTextStyle(E),this._setBackgroundColor(E),this._setDefaultPropertiesFromJS(E),this.container.append(E),this.container}}class M extends l{constructor(s){super(s,{isRenderable:!!s.data.hasOwnCanvas})}}class R extends l{constructor(s){super(s,{isRenderable:s.renderForms})}render(){const s=this.annotationStorage,_=this.data,E=_.id;let P=s.getValue(E,{value:_.exportValue===_.fieldValue}).value;typeof P=="string"&&(P=P!=="Off",s.setValue(E,{value:P})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const k=document.createElement("input");return i.add(k),k.setAttribute("data-element-id",E),k.disabled=_.readOnly,this._setRequired(k,this.data.required),k.type="checkbox",k.name=_.fieldName,P&&k.setAttribute("checked",!0),k.setAttribute("exportValue",_.exportValue),k.tabIndex=r,k.addEventListener("change",U=>{const{name:X,checked:it}=U.target;for(const At of this._getElementsByName(X,E)){const rt=it&&At.exportValue===_.exportValue;At.domElement&&(At.domElement.checked=rt),s.setValue(At.id,{value:rt})}s.setValue(E,{value:it})}),k.addEventListener("resetform",U=>{const X=_.defaultFieldValue||"Off";U.target.checked=X===_.exportValue}),this.enableScripting&&this.hasJSActions&&(k.addEventListener("updatefromsandbox",U=>{const X={value(it){it.target.checked=it.detail.value!=="Off",s.setValue(E,{value:it.target.checked})}};this._dispatchEventFromSandbox(X,U)}),this._setEventListeners(k,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],U=>U.target.checked)),this._setBackgroundColor(k),this._setDefaultPropertiesFromJS(k),this.container.append(k),this.container}}class m extends l{constructor(s){super(s,{isRenderable:s.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const s=this.annotationStorage,_=this.data,E=_.id;let P=s.getValue(E,{value:_.fieldValue===_.buttonValue}).value;typeof P=="string"&&(P=P!==_.buttonValue,s.setValue(E,{value:P}));const k=document.createElement("input");if(i.add(k),k.setAttribute("data-element-id",E),k.disabled=_.readOnly,this._setRequired(k,this.data.required),k.type="radio",k.name=_.fieldName,P&&k.setAttribute("checked",!0),k.tabIndex=r,k.addEventListener("change",U=>{const{name:X,checked:it}=U.target;for(const At of this._getElementsByName(X,E))s.setValue(At.id,{value:!1});s.setValue(E,{value:it})}),k.addEventListener("resetform",U=>{const X=_.defaultFieldValue;U.target.checked=X!=null&&X===_.buttonValue}),this.enableScripting&&this.hasJSActions){const U=_.buttonValue;k.addEventListener("updatefromsandbox",X=>{const it={value:At=>{const rt=U===At.detail.value;for(const st of this._getElementsByName(At.target.name)){const ut=rt&&st.id===E;st.domElement&&(st.domElement.checked=ut),s.setValue(st.id,{value:ut})}}};this._dispatchEventFromSandbox(it,X)}),this._setEventListeners(k,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],X=>X.target.checked)}return this._setBackgroundColor(k),this._setDefaultPropertiesFromJS(k),this.container.append(k),this.container}}class C extends g{constructor(s){super(s,{ignoreBorder:s.data.hasAppearance})}render(){const s=super.render();s.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(s.title=this.data.alternativeText);const _=s.lastChild;return this.enableScripting&&this.hasJSActions&&_&&(this._setDefaultPropertiesFromJS(_),_.addEventListener("updatefromsandbox",E=>{this._dispatchEventFromSandbox({},E)})),s}}class q extends l{constructor(s){super(s,{isRenderable:s.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const s=this.annotationStorage,_=this.data.id,E=s.getValue(_,{value:this.data.fieldValue}),P=document.createElement("select");i.add(P),P.setAttribute("data-element-id",_),P.disabled=this.data.readOnly,this._setRequired(P,this.data.required),P.name=this.data.fieldName,P.tabIndex=r;let k=this.data.combo&&this.data.options.length>0;this.data.combo||(P.size=this.data.options.length,this.data.multiSelect&&(P.multiple=!0)),P.addEventListener("resetform",rt=>{const st=this.data.defaultFieldValue;for(const ut of P.options)ut.selected=ut.value===st});for(const rt of this.data.options){const st=document.createElement("option");st.textContent=rt.displayValue,st.value=rt.exportValue,E.value.includes(rt.exportValue)&&(st.setAttribute("selected",!0),k=!1),P.append(st)}let U=null;if(k){const rt=document.createElement("option");rt.value=" ",rt.setAttribute("hidden",!0),rt.setAttribute("selected",!0),P.prepend(rt),U=()=>{rt.remove(),P.removeEventListener("input",U),U=null},P.addEventListener("input",U)}const X=rt=>{const st=rt?"value":"textContent",{options:ut,multiple:ht}=P;return ht?Array.prototype.filter.call(ut,gt=>gt.selected).map(gt=>gt[st]):ut.selectedIndex===-1?null:ut[ut.selectedIndex][st]};let it=X(!1);const At=rt=>{const st=rt.target.options;return Array.prototype.map.call(st,ut=>({displayValue:ut.textContent,exportValue:ut.value}))};return this.enableScripting&&this.hasJSActions?(P.addEventListener("updatefromsandbox",rt=>{const st={value(ut){U?.();const ht=ut.detail.value,gt=new Set(Array.isArray(ht)?ht:[ht]);for(const Ct of P.options)Ct.selected=gt.has(Ct.value);s.setValue(_,{value:X(!0)}),it=X(!1)},multipleSelection(ut){P.multiple=!0},remove(ut){const ht=P.options,gt=ut.detail.remove;ht[gt].selected=!1,P.remove(gt),ht.length>0&&Array.prototype.findIndex.call(ht,Lt=>Lt.selected)===-1&&(ht[0].selected=!0),s.setValue(_,{value:X(!0),items:At(ut)}),it=X(!1)},clear(ut){for(;P.length!==0;)P.remove(0);s.setValue(_,{value:null,items:[]}),it=X(!1)},insert(ut){const{index:ht,displayValue:gt,exportValue:Ct}=ut.detail.insert,Lt=P.children[ht],Bt=document.createElement("option");Bt.textContent=gt,Bt.value=Ct,Lt?Lt.before(Bt):P.append(Bt),s.setValue(_,{value:X(!0),items:At(ut)}),it=X(!1)},items(ut){const{items:ht}=ut.detail;for(;P.length!==0;)P.remove(0);for(const gt of ht){const{displayValue:Ct,exportValue:Lt}=gt,Bt=document.createElement("option");Bt.textContent=Ct,Bt.value=Lt,P.append(Bt)}P.options.length>0&&(P.options[0].selected=!0),s.setValue(_,{value:X(!0),items:At(ut)}),it=X(!1)},indices(ut){const ht=new Set(ut.detail.indices);for(const gt of ut.target.options)gt.selected=ht.has(gt.index);s.setValue(_,{value:X(!0)}),it=X(!1)},editable(ut){ut.target.disabled=!ut.detail.editable}};this._dispatchEventFromSandbox(st,rt)}),P.addEventListener("input",rt=>{const st=X(!0);s.setValue(_,{value:st}),rt.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:_,name:"Keystroke",value:it,changeEx:st,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(P,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],rt=>rt.target.value)):P.addEventListener("input",function(rt){s.setValue(_,{value:X(!0)})}),this.data.combo&&this._setTextStyle(P),this._setBackgroundColor(P),this._setDefaultPropertiesFromJS(P),this.container.append(P),this.container}}class $ extends e{constructor(s){const{data:_,elements:E}=s;super(s,{isRenderable:e._hasPopupData(_)}),this.elements=E}render(){this.container.classList.add("popupAnnotation");const s=new j({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),_=[];for(const E of this.elements)E.popup=s,_.push(E.data.id),E.addHighlightArea();return this.container.setAttribute("aria-controls",_.map(E=>`${u.AnnotationPrefix}${E}`).join(",")),this.container}}class j{#t=null;#e=this.#u.bind(this);#n=this.#S.bind(this);#i=this.#E.bind(this);#o=this.#b.bind(this);#a=null;#s=null;#l=null;#c=null;#r=null;#f=null;#h=!1;#d=null;#p=null;#v=null;#m=null;#g=!1;constructor({container:s,color:_,elements:E,titleObj:P,modificationDate:k,contentsObj:U,richText:X,parent:it,rect:At,parentRect:rt,open:st}){this.#s=s,this.#m=P,this.#l=U,this.#v=X,this.#r=it,this.#a=_,this.#p=At,this.#f=rt,this.#c=E;const ut=b.PDFDateString.toDateObject(k);ut&&(this.#t=it.l10n.get("annotation_date_string",{date:ut.toLocaleDateString(),time:ut.toLocaleTimeString()})),this.trigger=E.flatMap(ht=>ht.getElementsToTriggerPopup());for(const ht of this.trigger)ht.addEventListener("click",this.#o),ht.addEventListener("mouseenter",this.#i),ht.addEventListener("mouseleave",this.#n),ht.classList.add("popupTriggerArea");for(const ht of E)ht.container?.addEventListener("keydown",this.#e);this.#s.hidden=!0,st&&this.#b()}render(){if(this.#d)return;const{page:{view:s},viewport:{rawDims:{pageWidth:_,pageHeight:E,pageX:P,pageY:k}}}=this.#r,U=this.#d=document.createElement("div");if(U.className="popup",this.#a){const $t=U.style.outlineColor=u.Util.makeHexColor(...this.#a);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?U.style.backgroundColor=`color-mix(in srgb, ${$t} 30%, white)`:U.style.backgroundColor=u.Util.makeHexColor(...this.#a.map(ke=>Math.floor(.7*(255-ke)+ke)))}const X=document.createElement("span");X.className="header";const it=document.createElement("h1");if(X.append(it),{dir:it.dir,str:it.textContent}=this.#m,U.append(X),this.#t){const $t=document.createElement("span");$t.classList.add("popupDate"),this.#t.then(ne=>{$t.textContent=ne}),X.append($t)}const At=this.#l,rt=this.#v;if(rt?.str&&(!At?.str||At.str===rt.str))W.XfaLayer.render({xfaHtml:rt.html,intent:"richText",div:U}),U.lastChild.classList.add("richText","popupContent");else{const $t=this._formatContents(At);U.append($t)}let st=!!this.#f,ut=st?this.#f:this.#p;for(const $t of this.#c)if(!ut||u.Util.intersect($t.data.rect,ut)!==null){ut=$t.data.rect,st=!0;break}const ht=u.Util.normalizeRect([ut[0],s[3]-ut[1]+s[1],ut[2],s[3]-ut[3]+s[1]]),Ct=st?ut[2]-ut[0]+5:0,Lt=ht[0]+Ct,Bt=ht[1],{style:Xt}=this.#s;Xt.left=`${100*(Lt-P)/_}%`,Xt.top=`${100*(Bt-k)/E}%`,this.#s.append(U)}_formatContents({str:s,dir:_}){const E=document.createElement("p");E.classList.add("popupContent"),E.dir=_;const P=s.split(/(?:\r\n?|\n)/);for(let k=0,U=P.length;k<U;++k){const X=P[k];E.append(document.createTextNode(X)),k<U-1&&E.append(document.createElement("br"))}return E}#u(s){s.altKey||s.shiftKey||s.ctrlKey||s.metaKey||(s.key==="Enter"||s.key==="Escape"&&this.#h)&&this.#b()}#b(){this.#h=!this.#h,this.#h?(this.#E(),this.#s.addEventListener("click",this.#o),this.#s.addEventListener("keydown",this.#e)):(this.#S(),this.#s.removeEventListener("click",this.#o),this.#s.removeEventListener("keydown",this.#e))}#E(){this.#d||this.render(),this.isVisible?this.#h&&this.#s.classList.add("focused"):(this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#S(){this.#s.classList.remove("focused"),!(this.#h||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#g=this.isVisible,this.#g&&(this.#s.hidden=!0)}maybeShow(){this.#g&&(this.#g=!1,this.#s.hidden=!1)}get isVisible(){return this.#s.hidden===!1}}class tt extends e{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0}),this.textContent=s.data.textContent,this.textPosition=s.data.textPosition,this.annotationEditorType=u.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const s=document.createElement("div");s.classList.add("annotationTextContent"),s.setAttribute("role","comment");for(const _ of this.textContent){const E=document.createElement("span");E.textContent=_,s.append(E)}this.container.append(s)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}a.FreeTextAnnotationElement=tt;class nt extends e{#t=null;constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const s=this.data,{width:_,height:E}=h(s.rect),P=this.svgFactory.create(_,E,!0),k=this.#t=this.svgFactory.createElement("svg:line");return k.setAttribute("x1",s.rect[2]-s.lineCoordinates[0]),k.setAttribute("y1",s.rect[3]-s.lineCoordinates[1]),k.setAttribute("x2",s.rect[2]-s.lineCoordinates[2]),k.setAttribute("y2",s.rect[3]-s.lineCoordinates[3]),k.setAttribute("stroke-width",s.borderStyle.width||1),k.setAttribute("stroke","transparent"),k.setAttribute("fill","transparent"),P.append(k),this.container.append(P),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class yt extends e{#t=null;constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const s=this.data,{width:_,height:E}=h(s.rect),P=this.svgFactory.create(_,E,!0),k=s.borderStyle.width,U=this.#t=this.svgFactory.createElement("svg:rect");return U.setAttribute("x",k/2),U.setAttribute("y",k/2),U.setAttribute("width",_-k),U.setAttribute("height",E-k),U.setAttribute("stroke-width",k||1),U.setAttribute("stroke","transparent"),U.setAttribute("fill","transparent"),P.append(U),this.container.append(P),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class dt extends e{#t=null;constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const s=this.data,{width:_,height:E}=h(s.rect),P=this.svgFactory.create(_,E,!0),k=s.borderStyle.width,U=this.#t=this.svgFactory.createElement("svg:ellipse");return U.setAttribute("cx",_/2),U.setAttribute("cy",E/2),U.setAttribute("rx",_/2-k/2),U.setAttribute("ry",E/2-k/2),U.setAttribute("stroke-width",k||1),U.setAttribute("stroke","transparent"),U.setAttribute("fill","transparent"),P.append(U),this.container.append(P),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class vt extends e{#t=null;constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const s=this.data,{width:_,height:E}=h(s.rect),P=this.svgFactory.create(_,E,!0);let k=[];for(const X of s.vertices){const it=X.x-s.rect[0],At=s.rect[3]-X.y;k.push(it+","+At)}k=k.join(" ");const U=this.#t=this.svgFactory.createElement(this.svgElementName);return U.setAttribute("points",k),U.setAttribute("stroke-width",s.borderStyle.width||1),U.setAttribute("stroke","transparent"),U.setAttribute("fill","transparent"),P.append(U),this.container.append(P),!s.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Et extends vt{constructor(s){super(s),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class ct extends e{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class O extends e{#t=[];constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=u.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const s=this.data,{width:_,height:E}=h(s.rect),P=this.svgFactory.create(_,E,!0);for(const k of s.inkLists){let U=[];for(const it of k){const At=it.x-s.rect[0],rt=s.rect[3]-it.y;U.push(`${At},${rt}`)}U=U.join(" ");const X=this.svgFactory.createElement(this.svgElementName);this.#t.push(X),X.setAttribute("points",U),X.setAttribute("stroke-width",s.borderStyle.width||1),X.setAttribute("stroke","transparent"),X.setAttribute("fill","transparent"),!s.popupRef&&this.hasPopupData&&this._createPopup(),P.append(X)}return this.container.append(P),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}a.InkAnnotationElement=O;class A extends e{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class f extends e{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class p extends e{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class S extends e{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class L extends e{constructor(s){super(s,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}a.StampAnnotationElement=L;class F extends e{#t=null;constructor(s){super(s,{isRenderable:!0});const{filename:_,content:E}=this.data.file;this.filename=(0,b.getFilenameFromUrl)(_,!0),this.content=E,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:_,content:E})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:s,data:_}=this;let E;_.hasAppearance||_.fillAlpha===0?E=document.createElement("div"):(E=document.createElement("img"),E.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(_.name)?"paperclip":"pushpin"}.svg`,_.fillAlpha&&_.fillAlpha<1&&(E.style=`filter: opacity(${Math.round(_.fillAlpha*100)}%);`)),E.addEventListener("dblclick",this.#e.bind(this)),this.#t=E;const{isMac:P}=u.FeatureTest.platform;return s.addEventListener("keydown",k=>{k.key==="Enter"&&(P?k.metaKey:k.ctrlKey)&&this.#e()}),!_.popupRef&&this.hasPopupData?this._createPopup():E.classList.add("popupTriggerArea"),s.append(E),s}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class H{#t=null;#e=null;#n=new Map;constructor({div:s,accessibilityManager:_,annotationCanvasMap:E,l10n:P,page:k,viewport:U}){this.div=s,this.#t=_,this.#e=E,this.l10n=P,this.page=k,this.viewport=U,this.zIndex=0,this.l10n||=z.NullL10n}#i(s,_){const E=s.firstChild||s;E.id=`${u.AnnotationPrefix}${_}`,this.div.append(s),this.#t?.moveElementInDOM(this.div,s,E,!1)}async render(s){const{annotations:_}=s,E=this.div;(0,b.setLayerDimensions)(E,this.viewport);const P=new Map,k={data:null,layer:E,linkService:s.linkService,downloadManager:s.downloadManager,imageResourcesPath:s.imageResourcesPath||"",renderForms:s.renderForms!==!1,svgFactory:new b.DOMSVGFactory,annotationStorage:s.annotationStorage||new n.AnnotationStorage,enableScripting:s.enableScripting===!0,hasJSActions:s.hasJSActions,fieldObjects:s.fieldObjects,parent:this,elements:null};for(const U of _){if(U.noHTML)continue;const X=U.annotationType===u.AnnotationType.POPUP;if(X){const rt=P.get(U.id);if(!rt)continue;k.elements=rt}else{const{width:rt,height:st}=h(U.rect);if(rt<=0||st<=0)continue}k.data=U;const it=c.create(k);if(!it.isRenderable)continue;if(!X&&U.popupRef){const rt=P.get(U.popupRef);rt?rt.push(it):P.set(U.popupRef,[it])}it.annotationEditorType>0&&this.#n.set(it.data.id,it);const At=it.render();U.hidden&&(At.style.visibility="hidden"),this.#i(At,U.id)}this.#o(),await this.l10n.translate(E)}update({viewport:s}){const _=this.div;this.viewport=s,(0,b.setLayerDimensions)(_,{rotation:s.rotation}),this.#o(),_.hidden=!1}#o(){if(!this.#e)return;const s=this.div;for(const[_,E]of this.#e){const P=s.querySelector(`[data-annotation-id="${_}"]`);if(!P)continue;const{firstChild:k}=P;k?k.nodeName==="CANVAS"?k.replaceWith(E):k.before(E):P.append(E)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(s){return this.#n.get(s)}}a.AnnotationLayer=H}),((d,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ColorConverters=void 0;function I(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function u(n){return Math.max(0,Math.min(255,255*n))}class b{static CMYK_G([x,z,W,r]){return["G",1-Math.min(1,.3*x+.59*W+.11*z+r)]}static G_CMYK([x]){return["CMYK",0,0,0,1-x]}static G_RGB([x]){return["RGB",x,x,x]}static G_rgb([x]){return x=u(x),[x,x,x]}static G_HTML([x]){const z=I(x);return`#${z}${z}${z}`}static RGB_G([x,z,W]){return["G",.3*x+.59*z+.11*W]}static RGB_rgb(x){return x.map(u)}static RGB_HTML(x){return`#${x.map(I).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([x,z,W,r]){return["RGB",1-Math.min(1,x+r),1-Math.min(1,W+r),1-Math.min(1,z+r)]}static CMYK_rgb([x,z,W,r]){return[u(1-Math.min(1,x+r)),u(1-Math.min(1,W+r)),u(1-Math.min(1,z+r))]}static CMYK_HTML(x){const z=this.CMYK_RGB(x).slice(1);return this.RGB_HTML(z)}static RGB_CMYK([x,z,W]){const r=1-x,t=1-z,i=1-W,h=Math.min(r,t,i);return["CMYK",r,t,i,h]}}a.ColorConverters=b}),((d,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.NullL10n=void 0,a.getL10nFallback=u;const I={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};I.print_progress_percent="{{progress}}%";function u(x,z){switch(x){case"find_match_count":x=`find_match_count[${z.total===1?"one":"other"}]`;break;case"find_match_count_limit":x=`find_match_count_limit[${z.limit===1?"one":"other"}]`;break}return I[x]||""}function b(x,z){return z?x.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(W,r)=>r in z?z[r]:"{{"+r+"}}"):x}const n={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(x,z=null,W=u(x,z)){return b(W,z)},async translate(x){}};a.NullL10n=n}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.XfaLayer=void 0;var u=I(25);class b{static setupStorage(x,z,W,r,t){const i=r.getValue(z,{value:null});switch(W.name){case"textarea":if(i.value!==null&&(x.textContent=i.value),t==="print")break;x.addEventListener("input",h=>{r.setValue(z,{value:h.target.value})});break;case"input":if(W.attributes.type==="radio"||W.attributes.type==="checkbox"){if(i.value===W.attributes.xfaOn?x.setAttribute("checked",!0):i.value===W.attributes.xfaOff&&x.removeAttribute("checked"),t==="print")break;x.addEventListener("change",h=>{r.setValue(z,{value:h.target.checked?h.target.getAttribute("xfaOn"):h.target.getAttribute("xfaOff")})})}else{if(i.value!==null&&x.setAttribute("value",i.value),t==="print")break;x.addEventListener("input",h=>{r.setValue(z,{value:h.target.value})})}break;case"select":if(i.value!==null){x.setAttribute("value",i.value);for(const h of W.children)h.attributes.value===i.value?h.attributes.selected=!0:h.attributes.hasOwnProperty("selected")&&delete h.attributes.selected}x.addEventListener("input",h=>{const c=h.target.options,e=c.selectedIndex===-1?"":c[c.selectedIndex].value;r.setValue(z,{value:e})});break}}static setAttributes({html:x,element:z,storage:W=null,intent:r,linkService:t}){const{attributes:i}=z,h=x instanceof HTMLAnchorElement;i.type==="radio"&&(i.name=`${i.name}-${r}`);for(const[c,e]of Object.entries(i))if(e!=null)switch(c){case"class":e.length&&x.setAttribute(c,e.join(" "));break;case"dataId":break;case"id":x.setAttribute("data-element-id",e);break;case"style":Object.assign(x.style,e);break;case"textContent":x.textContent=e;break;default:(!h||c!=="href"&&c!=="newWindow")&&x.setAttribute(c,e)}h&&t.addLinkAttributes(x,i.href,i.newWindow),W&&i.dataId&&this.setupStorage(x,i.dataId,z,W)}static render(x){const z=x.annotationStorage,W=x.linkService,r=x.xfaHtml,t=x.intent||"display",i=document.createElement(r.name);r.attributes&&this.setAttributes({html:i,element:r,intent:t,linkService:W});const h=[[r,-1,i]],c=x.div;if(c.append(i),x.viewport){const g=`matrix(${x.viewport.transform.join(",")})`;c.style.transform=g}t!=="richText"&&c.setAttribute("class","xfaLayer xfaFont");const e=[];for(;h.length>0;){const[g,v,l]=h.at(-1);if(v+1===g.children.length){h.pop();continue}const w=g.children[++h.at(-1)[1]];if(w===null)continue;const{name:M}=w;if(M==="#text"){const m=document.createTextNode(w.value);e.push(m),l.append(m);continue}const R=w?.attributes?.xmlns?document.createElementNS(w.attributes.xmlns,M):document.createElement(M);if(l.append(R),w.attributes&&this.setAttributes({html:R,element:w,storage:z,intent:t,linkService:W}),w.children&&w.children.length>0)h.push([w,-1,R]);else if(w.value){const m=document.createTextNode(w.value);u.XfaText.shouldBuildText(M)&&e.push(m),R.append(m)}}for(const g of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:e}}static update(x){const z=`matrix(${x.viewport.transform.join(",")})`;x.div.style.transform=z,x.div.hidden=!1}}a.XfaLayer=b}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.InkEditor=void 0;var u=I(1),b=I(4),n=I(29),x=I(6),z=I(5);class W extends b.AnnotationEditor{#t=0;#e=0;#n=this.canvasPointermove.bind(this);#i=this.canvasPointerleave.bind(this);#o=this.canvasPointerup.bind(this);#a=this.canvasPointerdown.bind(this);#s=new Path2D;#l=!1;#c=!1;#r=!1;#f=null;#h=0;#d=0;#p=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";constructor(t){super({...t,name:"inkEditor"}),this.color=t.color||null,this.thickness=t.thickness||null,this.opacity=t.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(t){b.AnnotationEditor.initialize(t,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(t,i){switch(t){case u.AnnotationEditorParamsType.INK_THICKNESS:W._defaultThickness=i;break;case u.AnnotationEditorParamsType.INK_COLOR:W._defaultColor=i;break;case u.AnnotationEditorParamsType.INK_OPACITY:W._defaultOpacity=i/100;break}}updateParams(t,i){switch(t){case u.AnnotationEditorParamsType.INK_THICKNESS:this.#v(i);break;case u.AnnotationEditorParamsType.INK_COLOR:this.#m(i);break;case u.AnnotationEditorParamsType.INK_OPACITY:this.#g(i);break}}static get defaultPropertiesToUpdate(){return[[u.AnnotationEditorParamsType.INK_THICKNESS,W._defaultThickness],[u.AnnotationEditorParamsType.INK_COLOR,W._defaultColor||b.AnnotationEditor._defaultLineColor],[u.AnnotationEditorParamsType.INK_OPACITY,Math.round(W._defaultOpacity*100)]]}get propertiesToUpdate(){return[[u.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||W._defaultThickness],[u.AnnotationEditorParamsType.INK_COLOR,this.color||W._defaultColor||b.AnnotationEditor._defaultLineColor],[u.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??W._defaultOpacity))]]}#v(t){const i=this.thickness;this.addCommands({cmd:()=>{this.thickness=t,this.#C()},undo:()=>{this.thickness=i,this.#C()},mustExec:!0,type:u.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#m(t){const i=this.color;this.addCommands({cmd:()=>{this.color=t,this.#_()},undo:()=>{this.color=i,this.#_()},mustExec:!0,type:u.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#g(t){t/=100;const i=this.opacity;this.addCommands({cmd:()=>{this.opacity=t,this.#_()},undo:()=>{this.opacity=i,this.#_()},mustExec:!0,type:u.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(this.#x(),this.#k()),this.isAttachedToDOM||(this.parent.add(this),this.#y()),this.#C()))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#f.disconnect(),this.#f=null,super.remove())}setParent(t){!this.parent&&t?this._uiManager.removeShouldRescale(this):this.parent&&t===null&&this._uiManager.addShouldRescale(this),super.setParent(t)}onScaleChanging(){const[t,i]=this.parentDimensions,h=this.width*t,c=this.height*i;this.setDimensions(h,c)}enableEditMode(){this.#l||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",this.#a))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#a))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#u(){const{parentRotation:t,parentDimensions:[i,h]}=this;switch(t){case 90:return[0,h,h,i];case 180:return[i,h,i,h];case 270:return[i,0,h,i];default:return[0,0,i,h]}}#b(){const{ctx:t,color:i,opacity:h,thickness:c,parentScale:e,scaleFactor:g}=this;t.lineWidth=c*e/g,t.lineCap="round",t.lineJoin="round",t.miterLimit=10,t.strokeStyle=`${i}${(0,z.opacityToHex)(h)}`}#E(t,i){this.canvas.addEventListener("contextmenu",x.noContextMenu),this.canvas.addEventListener("pointerleave",this.#i),this.canvas.addEventListener("pointermove",this.#n),this.canvas.addEventListener("pointerup",this.#o),this.canvas.removeEventListener("pointerdown",this.#a),this.isEditing=!0,this.#r||(this.#r=!0,this.#y(),this.thickness||=W._defaultThickness,this.color||=W._defaultColor||b.AnnotationEditor._defaultLineColor,this.opacity??=W._defaultOpacity),this.currentPath.push([t,i]),this.#c=!1,this.#b(),this.#p=()=>{this.#D(),this.#p&&window.requestAnimationFrame(this.#p)},window.requestAnimationFrame(this.#p)}#S(t,i){const[h,c]=this.currentPath.at(-1);if(this.currentPath.length>1&&t===h&&i===c)return;const e=this.currentPath;let g=this.#s;if(e.push([t,i]),this.#c=!0,e.length<=2){g.moveTo(...e[0]),g.lineTo(t,i);return}e.length===3&&(this.#s=g=new Path2D,g.moveTo(...e[0])),this.#I(g,...e.at(-3),...e.at(-2),t,i)}#P(){if(this.currentPath.length===0)return;const t=this.currentPath.at(-1);this.#s.lineTo(...t)}#R(t,i){this.#p=null,t=Math.min(Math.max(t,0),this.canvas.width),i=Math.min(Math.max(i,0),this.canvas.height),this.#S(t,i),this.#P();let h;if(this.currentPath.length!==1)h=this.#O();else{const l=[t,i];h=[[l,l.slice(),l.slice(),l]]}const c=this.#s,e=this.currentPath;this.currentPath=[],this.#s=new Path2D;const g=()=>{this.allRawPaths.push(e),this.paths.push(h),this.bezierPath2D.push(c),this.rebuild()},v=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#x(),this.#k()),this.#C())};this.addCommands({cmd:g,undo:v,mustExec:!0})}#D(){if(!this.#c)return;this.#c=!1;const t=Math.ceil(this.thickness*this.parentScale),i=this.currentPath.slice(-3),h=i.map(g=>g[0]),c=i.map(g=>g[1]);Math.min(...h)-t,Math.max(...h)+t,Math.min(...c)-t,Math.max(...c)+t;const{ctx:e}=this;e.save(),e.clearRect(0,0,this.canvas.width,this.canvas.height);for(const g of this.bezierPath2D)e.stroke(g);e.stroke(this.#s),e.restore()}#I(t,i,h,c,e,g,v){const l=(i+c)/2,w=(h+e)/2,M=(c+g)/2,R=(e+v)/2;t.bezierCurveTo(l+2*(c-l)/3,w+2*(e-w)/3,M+2*(c-M)/3,R+2*(e-R)/3,M,R)}#O(){const t=this.currentPath;if(t.length<=2)return[[t[0],t[0],t.at(-1),t.at(-1)]];const i=[];let h,[c,e]=t[0];for(h=1;h<t.length-2;h++){const[m,C]=t[h],[q,$]=t[h+1],j=(m+q)/2,tt=(C+$)/2,nt=[c+2*(m-c)/3,e+2*(C-e)/3],yt=[j+2*(m-j)/3,tt+2*(C-tt)/3];i.push([[c,e],nt,yt,[j,tt]]),[c,e]=[j,tt]}const[g,v]=t[h],[l,w]=t[h+1],M=[c+2*(g-c)/3,e+2*(v-e)/3],R=[l+2*(g-l)/3,w+2*(v-w)/3];return i.push([[c,e],M,R,[l,w]]),i}#_(){if(this.isEmpty()){this.#w();return}this.#b();const{canvas:t,ctx:i}=this;i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,t.width,t.height),this.#w();for(const h of this.bezierPath2D)i.stroke(h)}commit(){this.#l||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#l=!0,this.div.classList.add("disabled"),this.#C(!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),this.enableEditMode())}canvasPointerdown(t){t.button!==0||!this.isInEditMode()||this.#l||(this.setInForeground(),t.preventDefault(),t.type!=="mouse"&&this.div.focus(),this.#E(t.offsetX,t.offsetY))}canvasPointermove(t){t.preventDefault(),this.#S(t.offsetX,t.offsetY)}canvasPointerup(t){t.preventDefault(),this.#L(t)}canvasPointerleave(t){this.#L(t)}#L(t){this.canvas.removeEventListener("pointerleave",this.#i),this.canvas.removeEventListener("pointermove",this.#n),this.canvas.removeEventListener("pointerup",this.#o),this.canvas.addEventListener("pointerdown",this.#a),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",x.noContextMenu)},10),this.#R(t.offsetX,t.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#x(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",b.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(t=>this.canvas?.setAttribute("aria-label",t)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#k(){this.#f=new ResizeObserver(t=>{const i=t[0].contentRect;i.width&&i.height&&this.setDimensions(i.width,i.height)}),this.#f.observe(this.div)}get isResizable(){return!this.isEmpty()&&this.#l}render(){if(this.div)return this.div;let t,i;this.width&&(t=this.x,i=this.y),super.render(),b.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(v=>this.div?.setAttribute("aria-label",v));const[h,c,e,g]=this.#u();if(this.setAt(h,c,0,0),this.setDims(e,g),this.#x(),this.width){const[v,l]=this.parentDimensions;this.setAspectRatio(this.width*v,this.height*l),this.setAt(t*v,i*l,this.width*v,this.height*l),this.#r=!0,this.#y(),this.setDims(this.width*v,this.height*l),this.#_(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#k(),this.div}#y(){if(!this.#r)return;const[t,i]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*t),this.canvas.height=Math.ceil(this.height*i),this.#w()}setDimensions(t,i){const h=Math.round(t),c=Math.round(i);if(this.#h===h&&this.#d===c)return;this.#h=h,this.#d=c,this.canvas.style.visibility="hidden";const[e,g]=this.parentDimensions;this.width=t/e,this.height=i/g,this.fixAndSetPosition(),this.#l&&this.#T(t,i),this.#y(),this.#_(),this.canvas.style.visibility="visible",this.fixDims()}#T(t,i){const h=this.#F(),c=(t-h)/this.#e,e=(i-h)/this.#t;this.scaleFactor=Math.min(c,e)}#w(){const t=this.#F()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+t,this.translationY*this.scaleFactor+t)}static#N(t){const i=new Path2D;for(let h=0,c=t.length;h<c;h++){const[e,g,v,l]=t[h];h===0&&i.moveTo(...e),i.bezierCurveTo(g[0],g[1],v[0],v[1],l[0],l[1])}return i}static#B(t,i,h){const[c,e,g,v]=i;switch(h){case 0:for(let l=0,w=t.length;l<w;l+=2)t[l]+=c,t[l+1]=v-t[l+1];break;case 90:for(let l=0,w=t.length;l<w;l+=2){const M=t[l];t[l]=t[l+1]+c,t[l+1]=M+e}break;case 180:for(let l=0,w=t.length;l<w;l+=2)t[l]=g-t[l],t[l+1]+=e;break;case 270:for(let l=0,w=t.length;l<w;l+=2){const M=t[l];t[l]=g-t[l+1],t[l+1]=v-M}break;default:throw new Error("Invalid rotation")}return t}static#j(t,i,h){const[c,e,g,v]=i;switch(h){case 0:for(let l=0,w=t.length;l<w;l+=2)t[l]-=c,t[l+1]=v-t[l+1];break;case 90:for(let l=0,w=t.length;l<w;l+=2){const M=t[l];t[l]=t[l+1]-e,t[l+1]=M-c}break;case 180:for(let l=0,w=t.length;l<w;l+=2)t[l]=g-t[l],t[l+1]-=e;break;case 270:for(let l=0,w=t.length;l<w;l+=2){const M=t[l];t[l]=v-t[l+1],t[l+1]=g-M}break;default:throw new Error("Invalid rotation")}return t}#H(t,i,h,c){const e=[],g=this.thickness/2,v=t*i+g,l=t*h+g;for(const w of this.paths){const M=[],R=[];for(let m=0,C=w.length;m<C;m++){const[q,$,j,tt]=w[m],nt=t*q[0]+v,yt=t*q[1]+l,dt=t*$[0]+v,vt=t*$[1]+l,Et=t*j[0]+v,ct=t*j[1]+l,O=t*tt[0]+v,A=t*tt[1]+l;m===0&&(M.push(nt,yt),R.push(nt,yt)),M.push(dt,vt,Et,ct,O,A),R.push(dt,vt),m===C-1&&R.push(O,A)}e.push({bezier:W.#B(M,c,this.rotation),points:W.#B(R,c,this.rotation)})}return e}#M(){let t=1/0,i=-1/0,h=1/0,c=-1/0;for(const e of this.paths)for(const[g,v,l,w]of e){const M=u.Util.bezierBoundingBox(...g,...v,...l,...w);t=Math.min(t,M[0]),h=Math.min(h,M[1]),i=Math.max(i,M[2]),c=Math.max(c,M[3])}return[t,h,i,c]}#F(){return this.#l?Math.ceil(this.thickness*this.parentScale):0}#C(t=!1){if(this.isEmpty())return;if(!this.#l){this.#_();return}const i=this.#M(),h=this.#F();this.#e=Math.max(b.AnnotationEditor.MIN_SIZE,i[2]-i[0]),this.#t=Math.max(b.AnnotationEditor.MIN_SIZE,i[3]-i[1]);const c=Math.ceil(h+this.#e*this.scaleFactor),e=Math.ceil(h+this.#t*this.scaleFactor),[g,v]=this.parentDimensions;this.width=c/g,this.height=e/v,this.setAspectRatio(c,e);const l=this.translationX,w=this.translationY;this.translationX=-i[0],this.translationY=-i[1],this.#y(),this.#_(),this.#h=c,this.#d=e,this.setDims(c,e);const M=t?h/this.scaleFactor/2:0;this.translate(l-this.translationX-M,w-this.translationY-M)}static deserialize(t,i,h){if(t instanceof n.InkAnnotationElement)return null;const c=super.deserialize(t,i,h);c.thickness=t.thickness,c.color=u.Util.makeHexColor(...t.color),c.opacity=t.opacity;const[e,g]=c.pageDimensions,v=c.width*e,l=c.height*g,w=c.parentScale,M=t.thickness/2;c.#l=!0,c.#h=Math.round(v),c.#d=Math.round(l);const{paths:R,rect:m,rotation:C}=t;for(let{bezier:$}of R){$=W.#j($,m,C);const j=[];c.paths.push(j);let tt=w*($[0]-M),nt=w*($[1]-M);for(let dt=2,vt=$.length;dt<vt;dt+=6){const Et=w*($[dt]-M),ct=w*($[dt+1]-M),O=w*($[dt+2]-M),A=w*($[dt+3]-M),f=w*($[dt+4]-M),p=w*($[dt+5]-M);j.push([[tt,nt],[Et,ct],[O,A],[f,p]]),tt=f,nt=p}const yt=this.#N(j);c.bezierPath2D.push(yt)}const q=c.#M();return c.#e=Math.max(b.AnnotationEditor.MIN_SIZE,q[2]-q[0]),c.#t=Math.max(b.AnnotationEditor.MIN_SIZE,q[3]-q[1]),c.#T(v,l),c}serialize(){if(this.isEmpty())return null;const t=this.getRect(0,0),i=b.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:u.AnnotationEditorType.INK,color:i,thickness:this.thickness,opacity:this.opacity,paths:this.#H(this.scaleFactor/this.parentScale,this.translationX,this.translationY,t),pageIndex:this.pageIndex,rect:t,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}a.InkEditor=W}),((d,a,I)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.StampEditor=void 0;var u=I(1),b=I(4),n=I(6),x=I(29);class z extends b.AnnotationEditor{#t=null;#e=null;#n=null;#i=null;#o=null;#a=null;#s=null;#l=null;#c=!1;#r=!1;static _type="stamp";constructor(r){super({...r,name:"stampEditor"}),this.#i=r.bitmapUrl,this.#o=r.bitmapFile}static initialize(r){b.AnnotationEditor.initialize(r)}static get supportedTypes(){const r=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,u.shadow)(this,"supportedTypes",r.map(t=>`image/${t}`))}static get supportedTypesStr(){return(0,u.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(r){return this.supportedTypes.includes(r)}static paste(r,t){t.pasteEditor(u.AnnotationEditorType.STAMP,{bitmapFile:r.getAsFile()})}#f(r,t=!1){if(!r){this.remove();return}this.#t=r.bitmap,t||(this.#e=r.id,this.#c=r.isSvg),this.#p()}#h(){this.#n=null,this._uiManager.enableWaiting(!1),this.#a&&this.div.focus()}#d(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(t=>this.#f(t,!0)).finally(()=>this.#h());return}if(this.#i){const t=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(t).then(i=>this.#f(i)).finally(()=>this.#h());return}if(this.#o){const t=this.#o;this.#o=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(t).then(i=>this.#f(i)).finally(()=>this.#h());return}const r=document.createElement("input");r.type="file",r.accept=z.supportedTypesStr,this.#n=new Promise(t=>{r.addEventListener("change",async()=>{if(!r.files||r.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(r.files[0]);this.#f(i)}t()}),r.addEventListener("cancel",()=>{this.remove(),t()})}).finally(()=>this.#h()),r.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#a?.remove(),this.#a=null,this.#s?.disconnect(),this.#s=null),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#d();return}super.rebuild(),this.div!==null&&(this.#e&&this.#d(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#o)}get isResizable(){return!0}render(){if(this.div)return this.div;let r,t;if(this.width&&(r=this.x,t=this.y),super.render(),this.div.hidden=!0,this.#t?this.#p():this.#d(),this.width){const[i,h]=this.parentDimensions;this.setAt(r*i,t*h,this.width*i,this.height*h)}return this.div}#p(){const{div:r}=this;let{width:t,height:i}=this.#t;const[h,c]=this.pageDimensions,e=.75;if(this.width)t=this.width*h,i=this.height*c;else if(t>e*h||i>e*c){const w=Math.min(e*h/t,e*c/i);t*=w,i*=w}const[g,v]=this.parentDimensions;this.setDims(t*g/h,i*v/c),this._uiManager.enableWaiting(!1);const l=this.#a=document.createElement("canvas");r.append(l),r.hidden=!1,this.#g(t,i),this.#b(),this.#r||(this.parent.addUndoableEditor(this),this.#r=!0),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()}#v(r,t){const[i,h]=this.parentDimensions;this.width=r/i,this.height=t/h,this.setDims(r,t),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#l!==null&&clearTimeout(this.#l);const c=200;this.#l=setTimeout(()=>{this.#l=null,this.#g(r,t)},c)}#m(r,t){const{width:i,height:h}=this.#t;let c=i,e=h,g=this.#t;for(;c>2*r||e>2*t;){const v=c,l=e;c>2*r&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2)),e>2*t&&(e=e>=16384?Math.floor(e/2)-1:Math.ceil(e/2));const w=new OffscreenCanvas(c,e);w.getContext("2d").drawImage(g,0,0,v,l,0,0,c,e),g=w.transferToImageBitmap()}return g}#g(r,t){r=Math.ceil(r),t=Math.ceil(t);const i=this.#a;if(!i||i.width===r&&i.height===t)return;i.width=r,i.height=t;const h=this.#c?this.#t:this.#m(r,t),c=i.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(h,0,0,h.width,h.height,0,0,r,t)}#u(r){if(r){if(this.#c){const h=this._uiManager.imageManager.getSvgUrl(this.#e);if(h)return h}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#t,t.getContext("2d").drawImage(this.#t,0,0),t.toDataURL()}if(this.#c){const[t,i]=this.pageDimensions,h=Math.round(this.width*t*n.PixelsPerInch.PDF_TO_CSS_UNITS),c=Math.round(this.height*i*n.PixelsPerInch.PDF_TO_CSS_UNITS),e=new OffscreenCanvas(h,c);return e.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,h,c),e.transferToImageBitmap()}return structuredClone(this.#t)}#b(){this.#s=new ResizeObserver(r=>{const t=r[0].contentRect;t.width&&t.height&&this.#v(t.width,t.height)}),this.#s.observe(this.div)}static deserialize(r,t,i){if(r instanceof x.StampAnnotationElement)return null;const h=super.deserialize(r,t,i),{rect:c,bitmapUrl:e,bitmapId:g,isSvg:v,accessibilityData:l}=r;g&&i.imageManager.isValidId(g)?h.#e=g:h.#i=e,h.#c=v;const[w,M]=h.pageDimensions;return h.width=(c[2]-c[0])/w,h.height=(c[3]-c[1])/M,l&&(h.altTextData=l),h}serialize(r=!1,t=null){if(this.isEmpty())return null;const i={annotationType:u.AnnotationEditorType.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(r)return i.bitmapUrl=this.#u(!0),i.accessibilityData=this.altTextData,i;const{decorative:h,altText:c}=this.altTextData;if(!h&&c&&(i.accessibilityData={type:"Figure",alt:c}),t===null)return i;t.stamps||=new Map;const e=this.#c?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!t.stamps.has(this.#e))t.stamps.set(this.#e,{area:e,serialized:i}),i.bitmap=this.#u(!1);else if(this.#c){const g=t.stamps.get(this.#e);e>g.area&&(g.area=e,g.serialized.bitmap.close(),g.serialized.bitmap=this.#u(!1))}return i}}a.StampEditor=z})],__webpack_module_cache__={};function __w_pdfjs_require__(d){var a=__webpack_module_cache__[d];if(a!==void 0)return a.exports;var I=__webpack_module_cache__[d]={exports:{}};return __webpack_modules__[d](I,I.exports,__w_pdfjs_require__),I.exports}var __webpack_exports__={};return(()=>{var d=__webpack_exports__;Object.defineProperty(d,"__esModule",{value:!0}),Object.defineProperty(d,"AbortException",{enumerable:!0,get:function(){return a.AbortException}}),Object.defineProperty(d,"AnnotationEditorLayer",{enumerable:!0,get:function(){return n.AnnotationEditorLayer}}),Object.defineProperty(d,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return a.AnnotationEditorParamsType}}),Object.defineProperty(d,"AnnotationEditorType",{enumerable:!0,get:function(){return a.AnnotationEditorType}}),Object.defineProperty(d,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return x.AnnotationEditorUIManager}}),Object.defineProperty(d,"AnnotationLayer",{enumerable:!0,get:function(){return z.AnnotationLayer}}),Object.defineProperty(d,"AnnotationMode",{enumerable:!0,get:function(){return a.AnnotationMode}}),Object.defineProperty(d,"CMapCompressionType",{enumerable:!0,get:function(){return a.CMapCompressionType}}),Object.defineProperty(d,"DOMSVGFactory",{enumerable:!0,get:function(){return u.DOMSVGFactory}}),Object.defineProperty(d,"FeatureTest",{enumerable:!0,get:function(){return a.FeatureTest}}),Object.defineProperty(d,"GlobalWorkerOptions",{enumerable:!0,get:function(){return W.GlobalWorkerOptions}}),Object.defineProperty(d,"ImageKind",{enumerable:!0,get:function(){return a.ImageKind}}),Object.defineProperty(d,"InvalidPDFException",{enumerable:!0,get:function(){return a.InvalidPDFException}}),Object.defineProperty(d,"MissingPDFException",{enumerable:!0,get:function(){return a.MissingPDFException}}),Object.defineProperty(d,"OPS",{enumerable:!0,get:function(){return a.OPS}}),Object.defineProperty(d,"PDFDataRangeTransport",{enumerable:!0,get:function(){return I.PDFDataRangeTransport}}),Object.defineProperty(d,"PDFDateString",{enumerable:!0,get:function(){return u.PDFDateString}}),Object.defineProperty(d,"PDFWorker",{enumerable:!0,get:function(){return I.PDFWorker}}),Object.defineProperty(d,"PasswordResponses",{enumerable:!0,get:function(){return a.PasswordResponses}}),Object.defineProperty(d,"PermissionFlag",{enumerable:!0,get:function(){return a.PermissionFlag}}),Object.defineProperty(d,"PixelsPerInch",{enumerable:!0,get:function(){return u.PixelsPerInch}}),Object.defineProperty(d,"PromiseCapability",{enumerable:!0,get:function(){return a.PromiseCapability}}),Object.defineProperty(d,"RenderingCancelledException",{enumerable:!0,get:function(){return u.RenderingCancelledException}}),Object.defineProperty(d,"SVGGraphics",{enumerable:!0,get:function(){return I.SVGGraphics}}),Object.defineProperty(d,"UnexpectedResponseException",{enumerable:!0,get:function(){return a.UnexpectedResponseException}}),Object.defineProperty(d,"Util",{enumerable:!0,get:function(){return a.Util}}),Object.defineProperty(d,"VerbosityLevel",{enumerable:!0,get:function(){return a.VerbosityLevel}}),Object.defineProperty(d,"XfaLayer",{enumerable:!0,get:function(){return r.XfaLayer}}),Object.defineProperty(d,"build",{enumerable:!0,get:function(){return I.build}}),Object.defineProperty(d,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return a.createValidAbsoluteUrl}}),Object.defineProperty(d,"getDocument",{enumerable:!0,get:function(){return I.getDocument}}),Object.defineProperty(d,"getFilenameFromUrl",{enumerable:!0,get:function(){return u.getFilenameFromUrl}}),Object.defineProperty(d,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return u.getPdfFilenameFromUrl}}),Object.defineProperty(d,"getXfaPageViewport",{enumerable:!0,get:function(){return u.getXfaPageViewport}}),Object.defineProperty(d,"isDataScheme",{enumerable:!0,get:function(){return u.isDataScheme}}),Object.defineProperty(d,"isPdfFile",{enumerable:!0,get:function(){return u.isPdfFile}}),Object.defineProperty(d,"loadScript",{enumerable:!0,get:function(){return u.loadScript}}),Object.defineProperty(d,"noContextMenu",{enumerable:!0,get:function(){return u.noContextMenu}}),Object.defineProperty(d,"normalizeUnicode",{enumerable:!0,get:function(){return a.normalizeUnicode}}),Object.defineProperty(d,"renderTextLayer",{enumerable:!0,get:function(){return b.renderTextLayer}}),Object.defineProperty(d,"setLayerDimensions",{enumerable:!0,get:function(){return u.setLayerDimensions}}),Object.defineProperty(d,"shadow",{enumerable:!0,get:function(){return a.shadow}}),Object.defineProperty(d,"updateTextLayer",{enumerable:!0,get:function(){return b.updateTextLayer}}),Object.defineProperty(d,"version",{enumerable:!0,get:function(){return I.version}});var a=__w_pdfjs_require__(1),I=__w_pdfjs_require__(2),u=__w_pdfjs_require__(6),b=__w_pdfjs_require__(26),n=__w_pdfjs_require__(27),x=__w_pdfjs_require__(5),z=__w_pdfjs_require__(29),W=__w_pdfjs_require__(14),r=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf)),pdf.exports}var hasRequiredCore_min;function requireCore_min(){return hasRequiredCore_min||(hasRequiredCore_min=1,(function(d){var a=requireReact(),I=requirePdf();function u(o){var y=Object.create(null);return o&&Object.keys(o).forEach((function(D){if(D!=="default"){var N=Object.getOwnPropertyDescriptor(o,D);Object.defineProperty(y,D,N.get?N:{enumerable:!0,get:function(){return o[D]}})}})),y.default=o,Object.freeze(y)}var b,n=u(a),x=u(I);d.AnnotationType=void 0,(b=d.AnnotationType||(d.AnnotationType={}))[b.Text=1]="Text",b[b.Link=2]="Link",b[b.FreeText=3]="FreeText",b[b.Line=4]="Line",b[b.Square=5]="Square",b[b.Circle=6]="Circle",b[b.Polygon=7]="Polygon",b[b.Polyline=8]="Polyline",b[b.Highlight=9]="Highlight",b[b.Underline=10]="Underline",b[b.Squiggly=11]="Squiggly",b[b.StrikeOut=12]="StrikeOut",b[b.Stamp=13]="Stamp",b[b.Caret=14]="Caret",b[b.Ink=15]="Ink",b[b.Popup=16]="Popup",b[b.FileAttachment=17]="FileAttachment";var z=function(o,y){return z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(D,N){D.__proto__=N}||function(D,N){for(var V in N)Object.prototype.hasOwnProperty.call(N,V)&&(D[V]=N[V])},z(o,y)};function W(o,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");function D(){this.constructor=o}z(o,y),o.prototype=y===null?Object.create(y):(D.prototype=y.prototype,new D)}var r,t=function(){return t=Object.assign||function(o){for(var y,D=1,N=arguments.length;D<N;D++)for(var V in y=arguments[D])Object.prototype.hasOwnProperty.call(y,V)&&(o[V]=y[V]);return o},t.apply(this,arguments)};d.TextDirection=void 0,(r=d.TextDirection||(d.TextDirection={})).RightToLeft="RTL",r.LeftToRight="LTR";var i,h=n.createContext({currentTheme:"light",direction:d.TextDirection.LeftToRight,setCurrentTheme:function(){}}),c=function(o){var y=[];return Object.keys(o).forEach((function(D){D&&o[D]&&y.push(D)})),y.join(" ")},e=typeof window<"u"?n.useLayoutEffect:n.useEffect,g=function(o){var y=n.useRef(null),D=o.once,N=o.threshold,V=o.onVisibilityChanged;return e((function(){var G=y.current;if(G){var Z=new IntersectionObserver((function(Y){Y.forEach((function(B){var J=B.isIntersecting,K=B.intersectionRatio;V({isVisible:J,ratio:K}),J&&D&&(Z.unobserve(G),Z.disconnect())}))}),{threshold:N||0});return Z.observe(G),function(){Z.unobserve(G),Z.disconnect()}}}),[]),y},v=function(o){var y=o.children,D=o.ignoreDirection,N=D!==void 0&&D,V=o.size,G=V===void 0?24:V,Z=n.useContext(h).direction,Y=!N&&Z===d.TextDirection.RightToLeft,B="".concat(G||24,"px");return n.createElement("svg",{"aria-hidden":"true",className:c({"rpv-core__icon":!0,"rpv-core__icon--rtl":Y}),focusable:"false",height:B,viewBox:"0 0 24 24",width:B},y)},l=function(){return n.createElement(v,{size:16},n.createElement("path",{d:"M23.5,0.499l-16.5,23l-6.5-6.5"}))},w=function(o){var y=o.children,D=o.testId,N=o.onClick,V=n.useContext(h).direction===d.TextDirection.RightToLeft,G=D?{"data-testid":D}:{};return n.createElement("button",t({className:c({"rpv-core__primary-button":!0,"rpv-core__primary-button--rtl":V}),type:"button",onClick:N},G),y)},M=function(o){var y=o.size,D=y===void 0?"4rem":y,N=o.testId,V=n.useState(!1),G=V[0],Z=V[1],Y=N?{"data-testid":N}:{},B=g({onVisibilityChanged:function(J){Z(J.isVisible)}});return n.createElement("div",t({},Y,{className:c({"rpv-core__spinner":!0,"rpv-core__spinner--animating":G}),ref:B,style:{height:D,width:D}}))},R=function(o){var y=o.ariaLabel,D=y===void 0?"":y,N=o.autoFocus,V=N!==void 0&&N,G=o.placeholder,Z=G===void 0?"":G,Y=o.testId,B=o.type,J=B===void 0?"text":B,K=o.value,lt=K===void 0?"":K,ot=o.onChange,at=o.onKeyDown,_t=at===void 0?function(){}:at,mt=n.useContext(h).direction,pt=n.useRef(),Gt=mt===d.TextDirection.RightToLeft,Mt={ref:pt,"data-testid":"","aria-label":D,className:c({"rpv-core__textbox":!0,"rpv-core__textbox--rtl":Gt}),placeholder:Z,value:lt,onChange:function(Ft){return ot(Ft.target.value)},onKeyDown:_t};return Y&&(Mt["data-testid"]=Y),e((function(){if(V){var Ft=pt.current;if(Ft){var Nt=window.scrollX,Pt=window.scrollY;Ft.focus(),window.scrollTo(Nt,Pt)}}}),[]),J==="text"?n.createElement("input",t({type:"text"},Mt)):n.createElement("input",t({type:"password"},Mt))};(function(o){o[o.ExitFullScreen=0]="ExitFullScreen",o[o.FullScreenChange=1]="FullScreenChange",o[o.FullScreenElement=2]="FullScreenElement",o[o.FullScreenEnabled=3]="FullScreenEnabled",o[o.RequestFullScreen=4]="RequestFullScreen"})(i||(i={}));var m,C={ExitFullScreen:"exitFullscreen",FullScreenChange:"fullscreenchange",FullScreenElement:"fullscreenElement",FullScreenEnabled:"fullscreenEnabled",RequestFullScreen:"requestFullscreen"},q={ExitFullScreen:"webkitExitFullscreen",FullScreenChange:"webkitfullscreenchange",FullScreenElement:"webkitFullscreenElement",FullScreenEnabled:"webkitFullscreenEnabled",RequestFullScreen:"webkitRequestFullscreen"},$={ExitFullScreen:"msExitFullscreen",FullScreenChange:"msFullscreenChange",FullScreenElement:"msFullscreenElement",FullScreenEnabled:"msFullscreenEnabled",RequestFullScreen:"msRequestFullscreen"},j=typeof window<"u",tt=j&&(i.FullScreenEnabled in document&&C||q.FullScreenEnabled in document&&q||$.FullScreenEnabled in document&&$)||C,nt=function(){return j&&tt.FullScreenEnabled in document&&document[tt.FullScreenEnabled]===!0},yt=function(o){return j?o[tt.ExitFullScreen]():Promise.resolve({})},dt=function(){return j?document[tt.FullScreenElement]:null},vt=function(o,y){var D=n.useRef(),N=function(){D.current&&clearTimeout(D.current)};return n.useEffect((function(){return function(){return N()}}),[]),n.useCallback((function(){for(var V=[],G=0;G<arguments.length;G++)V[G]=arguments[G];N(),D.current=setTimeout((function(){o.apply(void 0,V)}),y)}),[o,y])},Et=function(){var o=n.useRef(!1);return n.useEffect((function(){return o.current=!0,function(){o.current=!1}}),[]),o},ct=function(o){var y=n.useRef(o);return n.useEffect((function(){y.current=o}),[o]),y.current};(function(o){o.NotRenderedYet="NotRenderedYet",o.Rendering="Rendering",o.Rendered="Rendered"})(m||(m={}));var O,A=-9999,f=function(o){var y=o.doc,D=y.numPages,N=y.loadingTask.docId,V=n.useMemo((function(){return Array(D).fill(null).map((function(Y,B){return{pageIndex:B,renderStatus:m.NotRenderedYet,visibility:A}}))}),[N]),G=n.useRef({currentRenderingPage:-1,startRange:0,endRange:D-1,visibilities:V}),Z=function(Y,B){G.current.visibilities[Y].visibility=B};return{getHighestPriorityPage:function(){var Y=G.current.visibilities.slice(G.current.startRange,G.current.endRange+1).filter((function(ot){return ot.visibility>A}));if(!Y.length)return-1;for(var B=Y[0].pageIndex,J=Y[Y.length-1].pageIndex,K=Y.length,lt=0;lt<K;lt++){if(Y[lt].renderStatus===m.Rendering)return-1;if(Y[lt].renderStatus===m.NotRenderedYet)return Y[lt].pageIndex}return J+1<D&&G.current.visibilities[J+1].renderStatus!==m.Rendered?J+1:B-1>=0&&G.current.visibilities[B-1].renderStatus!==m.Rendered?B-1:-1},isInRange:function(Y){return Y>=G.current.startRange&&Y<=G.current.endRange},markNotRendered:function(){for(var Y=0;Y<D;Y++)G.current.visibilities[Y].renderStatus=m.NotRenderedYet},markRendered:function(Y){G.current.visibilities[Y].renderStatus=m.Rendered},markRendering:function(Y){G.current.currentRenderingPage!==-1&&G.current.currentRenderingPage!==Y&&G.current.visibilities[G.current.currentRenderingPage].renderStatus===m.Rendering&&(G.current.visibilities[G.current.currentRenderingPage].renderStatus=m.NotRenderedYet),G.current.visibilities[Y].renderStatus=m.Rendering,G.current.currentRenderingPage=Y},setOutOfRange:function(Y){Z(Y,A)},setRange:function(Y,B){G.current.startRange=Y,G.current.endRange=B;for(var J=0;J<D;J++)(J<Y||J>B)&&(G.current.visibilities[J].visibility=A,G.current.visibilities[J].renderStatus=m.NotRenderedYet)},setVisibility:Z}},p={core:{askingPassword:{requirePasswordToOpen:"This document requires a password to open",submit:"Submit"},wrongPassword:{tryAgain:"The password is wrong. Please try again"},pageLabel:"Page {{pageIndex}}"}},S=n.createContext({l10n:p,setL10n:function(){}}),L=0,F=function(){return L++},H=function(o,y,D){var N=function(V){var G=y.current;if(G){var Z=V.target;if(Z instanceof Element&&Z.shadowRoot){var Y=V.composedPath();Y.length>0&&!G.contains(Y[0])&&D()}else G.contains(Z)||D()}};n.useEffect((function(){if(o){var V={capture:!0};return document.addEventListener("click",N,V),function(){document.removeEventListener("click",N,V)}}}),[])},T=function(o){var y=function(D){D.key==="Escape"&&o()};n.useEffect((function(){return document.addEventListener("keyup",y),function(){document.removeEventListener("keyup",y)}}),[])},s=function(o){var y=o.ariaControlsSuffix,D=o.children,N=o.closeOnClickOutside,V=o.closeOnEscape,G=o.onToggle,Z=n.useRef(),Y=n.useContext(h).direction===d.TextDirection.RightToLeft;return n.useEffect((function(){var B=window.getComputedStyle(document.body).overflow;return document.body.style.overflow="hidden",function(){document.body.style.overflow=B}}),[]),T((function(){Z.current&&V&&G()})),H(N,Z,G),e((function(){var B=Z.current;if(B){var J=.75*document.body.clientHeight;B.getBoundingClientRect().height>=J&&(B.style.overflow="auto",B.style.maxHeight="".concat(J,"px"))}}),[]),n.createElement("div",{"aria-modal":"true",className:c({"rpv-core__modal-body":!0,"rpv-core__modal-body--rtl":Y}),id:"rpv-core__modal-body-".concat(y),ref:Z,role:"dialog",tabIndex:-1},D)},_=function(o){var y=o.children;return n.createElement("div",{className:"rpv-core__modal-overlay"},y)};d.ToggleStatus=void 0,(O=d.ToggleStatus||(d.ToggleStatus={})).Close="Close",O.Open="Open",O.Toggle="Toggle";var E,P=function(o){var y=n.useState(o),D=y[0],N=y[1];return{opened:D,toggle:function(V){switch(V){case d.ToggleStatus.Close:N(!1);break;case d.ToggleStatus.Open:N(!0);break;case d.ToggleStatus.Toggle:default:N((function(G){return!G}))}}}},k=function(o){var y=o.content,D=o.isOpened,N=D!==void 0&&D,V=o.target,G=P(N),Z=G.opened,Y=G.toggle;return n.createElement(n.Fragment,null,V&&V(Y,Z),Z&&y(Y))};d.Position=void 0,(E=d.Position||(d.Position={})).TopLeft="TOP_LEFT",E.TopCenter="TOP_CENTER",E.TopRight="TOP_RIGHT",E.RightTop="RIGHT_TOP",E.RightCenter="RIGHT_CENTER",E.RightBottom="RIGHT_BOTTOM",E.BottomLeft="BOTTOM_LEFT",E.BottomCenter="BOTTOM_CENTER",E.BottomRight="BOTTOM_RIGHT",E.LeftTop="LEFT_TOP",E.LeftCenter="LEFT_CENTER",E.LeftBottom="LEFT_BOTTOM";var U,X,it,At,rt,st,ut,ht,gt=function(o,y,D,N,V){e((function(){var G=y.current,Z=o.current,Y=D.current;if(Z&&G&&Y){var B=Y.getBoundingClientRect(),J=(function(ot,at,_t,mt){var pt=at.getBoundingClientRect(),Gt=ot.getBoundingClientRect(),Mt=Gt.height,Ft=Gt.width,Nt=0,Pt=0;switch(_t){case d.Position.TopLeft:Nt=pt.top-Mt,Pt=pt.left;break;case d.Position.TopCenter:Nt=pt.top-Mt,Pt=pt.left+pt.width/2-Ft/2;break;case d.Position.TopRight:Nt=pt.top-Mt,Pt=pt.left+pt.width-Ft;break;case d.Position.RightTop:Nt=pt.top,Pt=pt.left+pt.width;break;case d.Position.RightCenter:Nt=pt.top+pt.height/2-Mt/2,Pt=pt.left+pt.width;break;case d.Position.RightBottom:Nt=pt.top+pt.height-Mt,Pt=pt.left+pt.width;break;case d.Position.BottomLeft:Nt=pt.top+pt.height,Pt=pt.left;break;case d.Position.BottomCenter:Nt=pt.top+pt.height,Pt=pt.left+pt.width/2-Ft/2;break;case d.Position.BottomRight:Nt=pt.top+pt.height,Pt=pt.left+pt.width-Ft;break;case d.Position.LeftTop:Nt=pt.top,Pt=pt.left-Ft;break;case d.Position.LeftCenter:Nt=pt.top+pt.height/2-Mt/2,Pt=pt.left-Ft;break;case d.Position.LeftBottom:Nt=pt.top+pt.height-Mt,Pt=pt.left-Ft}return{left:Pt+(mt.left||0),top:Nt+(mt.top||0)}})(Z,G,N,V),K=J.top,lt=J.left;Z.style.top="".concat(K-B.top,"px"),Z.style.left="".concat(lt-B.left,"px")}}),[])},Ct=function(o){var y,D=o.customClassName,N=o.position;return n.createElement("div",{className:c((y={"rpv-core__arrow":!0,"rpv-core__arrow--tl":N===d.Position.TopLeft,"rpv-core__arrow--tc":N===d.Position.TopCenter,"rpv-core__arrow--tr":N===d.Position.TopRight,"rpv-core__arrow--rt":N===d.Position.RightTop,"rpv-core__arrow--rc":N===d.Position.RightCenter,"rpv-core__arrow--rb":N===d.Position.RightBottom,"rpv-core__arrow--bl":N===d.Position.BottomLeft,"rpv-core__arrow--bc":N===d.Position.BottomCenter,"rpv-core__arrow--br":N===d.Position.BottomRight,"rpv-core__arrow--lt":N===d.Position.LeftTop,"rpv-core__arrow--lc":N===d.Position.LeftCenter,"rpv-core__arrow--lb":N===d.Position.LeftBottom},y["".concat(D)]=D!=="",y))})},Lt=function(o){var y=o.ariaControlsSuffix,D=o.children,N=o.closeOnClickOutside,V=o.offset,G=o.position,Z=o.targetRef,Y=o.onClose,B=n.useRef(),J=n.useRef(),K=n.useRef(),lt=n.useContext(h).direction===d.TextDirection.RightToLeft;H(N,B,Y),gt(B,Z,K,G,V),e((function(){var at=J.current;if(at){var _t=.75*document.body.clientHeight;at.getBoundingClientRect().height>=_t&&(at.style.overflow="auto",at.style.maxHeight="".concat(_t,"px"))}}),[]);var ot="rpv-core__popover-body-inner-".concat(y);return n.createElement(n.Fragment,null,n.createElement("div",{ref:K,style:{left:0,position:"absolute",top:0}}),n.createElement("div",{"aria-describedby":ot,className:c({"rpv-core__popover-body":!0,"rpv-core__popover-body--rtl":lt}),id:"rpv-core__popover-body-".concat(y),ref:B,role:"dialog",tabIndex:-1},n.createElement(Ct,{customClassName:"rpv-core__popover-body-arrow",position:G}),n.createElement("div",{id:ot,ref:J},D)))},Bt=function(o){var y=o.closeOnEscape,D=o.onClose,N=n.useRef();return T((function(){N.current&&y&&D()})),n.createElement("div",{className:"rpv-core__popover-overlay",ref:N})},Xt=function(o){var y=o.ariaControlsSuffix,D=o.children,N=o.contentRef,V=o.offset,G=o.position,Z=o.targetRef,Y=n.useRef(),B=n.useContext(h).direction===d.TextDirection.RightToLeft;return gt(N,Z,Y,G,V),n.createElement(n.Fragment,null,n.createElement("div",{ref:Y,style:{left:0,position:"absolute",top:0}}),n.createElement("div",{className:c({"rpv-core__tooltip-body":!0,"rpv-core__tooltip-body--rtl":B}),id:"rpv-core__tooltip-body-".concat(y),ref:N,role:"tooltip"},n.createElement(Ct,{customClassName:"rpv-core__tooltip-body-arrow",position:G}),n.createElement("div",{className:"rpv-core__tooltip-body-content"},D)))};d.FullScreenMode=void 0,(U=d.FullScreenMode||(d.FullScreenMode={})).Normal="Normal",U.Entering="Entering",U.Entered="Entered",U.EnteredCompletely="EnteredCompletely",U.Exitting="Exitting",U.Exited="Exited",d.LayerRenderStatus=void 0,(X=d.LayerRenderStatus||(d.LayerRenderStatus={}))[X.PreRender=0]="PreRender",X[X.DidRender=1]="DidRender",d.PageMode=void 0,(it=d.PageMode||(d.PageMode={})).Attachments="UseAttachments",it.Bookmarks="UseOutlines",it.ContentGroup="UseOC",it.Default="UserNone",it.FullScreen="FullScreen",it.Thumbnails="UseThumbs",d.PasswordStatus=void 0,(At=d.PasswordStatus||(d.PasswordStatus={})).RequiredPassword="RequiredPassword",At.WrongPassword="WrongPassword",d.RotateDirection=void 0,(rt=d.RotateDirection||(d.RotateDirection={})).Backward="Backward",rt.Forward="Forward",d.ScrollMode=void 0,(st=d.ScrollMode||(d.ScrollMode={})).Page="Page",st.Horizontal="Horizontal",st.Vertical="Vertical",st.Wrapped="Wrapped",d.SpecialZoomLevel=void 0,(ut=d.SpecialZoomLevel||(d.SpecialZoomLevel={})).ActualSize="ActualSize",ut.PageFit="PageFit",ut.PageWidth="PageWidth",d.ViewMode=void 0,(ht=d.ViewMode||(d.ViewMode={})).DualPage="DualPage",ht.DualPageWithCover="DualPageWithCover",ht.SinglePage="SinglePage";var $t,ne=function(o,y){return o.reduce((function(D,N,V){return V%y?D[D.length-1].push(N):D.push([N]),D}),[])},ke=function(o,y){switch(y[1].name){case"XYZ":return{bottomOffset:function(D,N){return y[3]===null?N:y[3]},leftOffset:function(D,N){return y[2]===null?0:y[2]},pageIndex:o,scaleTo:y[4]};case"Fit":case"FitB":return{bottomOffset:0,leftOffset:0,pageIndex:o,scaleTo:d.SpecialZoomLevel.PageFit};case"FitH":case"FitBH":return{bottomOffset:y[2],leftOffset:0,pageIndex:o,scaleTo:d.SpecialZoomLevel.PageWidth};default:return{bottomOffset:0,leftOffset:0,pageIndex:o,scaleTo:1}}},Ae=new Map,He=new Map,Pe=function(o,y){return"".concat(o.loadingTask.docId,"___").concat(y.num,"R").concat(y.gen===0?"":y.gen)},Oe=function(o,y,D){Ae.set(Pe(o,y),D)},qe=function(o,y){if(!o)return Promise.reject("The document is not loaded yet");var D="".concat(o.loadingTask.docId,"___").concat(y),N=He.get(D);return N?Promise.resolve(N):new Promise((function(V,G){o.getPage(y+1).then((function(Z){He.set(D,Z),Z.ref&&Oe(o,Z.ref,y),V(Z)}))}))},un=function(o,y){return new Promise((function(D){new Promise((function(N){typeof y=="string"?o.getDestination(y).then((function(V){N(V)})):N(y)})).then((function(N){if(typeof N[0]=="object"&&N[0]!==null){var V=N[0],G=(function(Y,B){var J=Pe(Y,B);return Ae.has(J)?Ae.get(J):null})(o,V);G===null?o.getPageIndex(V).then((function(Y){Oe(o,V,Y),un(o,y).then((function(B){return D(B)}))})):D(ke(G,N))}else{var Z=ke(N[0],N);D(Z)}}))}))};(function(o){o[o.Solid=1]="Solid",o[o.Dashed=2]="Dashed",o[o.Beveled=3]="Beveled",o[o.Inset=4]="Inset",o[o.Underline=5]="Underline"})($t||($t={}));var Ne,bt=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"),et=function(o,y,D,N){var V=parseInt(o,10);return V>=y&&V<=D?V:N},Q=function(o){return o.contentsObj?o.contentsObj.str:o.contents||""},St=function(o){return o.titleObj?o.titleObj.str:o.title||""},oe=function(o){var y=o.annotation,D=n.useContext(h).direction,N=St(y),V=Q(y),G=D===d.TextDirection.RightToLeft,Z=n.useRef(),Y="";if(y.modificationDate){var B=(function(J){var K=bt.exec(J);if(!K)return null;var lt=parseInt(K[1],10),ot=et(K[2],1,12,1)-1,at=et(K[3],1,31,1),_t=et(K[4],0,23,0),mt=et(K[5],0,59,0),pt=et(K[6],0,59,0),Gt=K[7]||"Z",Mt=et(K[8],0,23,0),Ft=et(K[9],0,59,0);switch(Gt){case"-":_t+=Mt,mt+=Ft;break;case"+":_t-=Mt,mt-=Ft}return new Date(Date.UTC(lt,ot,at,_t,mt,pt))})(y.modificationDate);Y=B?"".concat(B.toLocaleDateString(),", ").concat(B.toLocaleTimeString()):""}return n.useLayoutEffect((function(){if(Z.current){var J=document.querySelector('[data-annotation-id="'.concat(y.id,'"]'));if(J){var K=J;return K.style.zIndex+=1,function(){K.style.zIndex="".concat(parseInt(K.style.zIndex,10)-1)}}}}),[]),n.createElement("div",{ref:Z,className:c({"rpv-core__annotation-popup-wrapper":!0,"rpv-core__annotation-popup-wrapper--rtl":G}),style:{top:y.annotationType===d.AnnotationType.Popup?"":"100%"}},N&&n.createElement(n.Fragment,null,n.createElement("div",{className:c({"rpv-core__annotation-popup-title":!0,"rpv-core__annotation-popup-title--ltr":!G,"rpv-core__annotation-popup-title--rtl":G})},N),n.createElement("div",{className:"rpv-core__annotation-popup-date"},Y)),V&&n.createElement("div",{className:"rpv-core__annotation-popup-content"},V.split(`
`).map((function(J,K){return n.createElement(n.Fragment,{key:K},J,n.createElement("br",null))}))))};(function(o){o.Click="Click",o.Hover="Hover"})(Ne||(Ne={}));var Wt,Qt=function(o){var y,D=o.annotation,N=o.children,V=o.ignoreBorder,G=o.hasPopup,Z=o.isRenderable,Y=o.page,B=o.viewport,J=D.rect,K=(function(){var It=P(!1),te=It.opened,Zt=It.toggle,ee=n.useState(Ne.Hover),ie=ee[0],se=ee[1];return{opened:te,closeOnHover:function(){ie===Ne.Hover&&Zt(d.ToggleStatus.Close)},openOnHover:function(){ie===Ne.Hover&&Zt(d.ToggleStatus.Open)},toggleOnClick:function(){switch(ie){case Ne.Click:te&&se(Ne.Hover),Zt(d.ToggleStatus.Toggle);break;case Ne.Hover:se(Ne.Click),Zt(d.ToggleStatus.Open)}}}})(),lt=K.closeOnHover,ot=K.opened,at=K.openOnHover,_t=K.toggleOnClick,mt=(y=[J[0],Y.view[3]+Y.view[1]-J[1],J[2],Y.view[3]+Y.view[1]-J[3]],[Math.min(y[0],y[2]),Math.min(y[1],y[3]),Math.max(y[0],y[2]),Math.max(y[1],y[3])]),pt=J[2]-J[0],Gt=J[3]-J[1],Mt={borderColor:"",borderRadius:"",borderStyle:"",borderWidth:""};if(!V&&D.borderStyle.width>0){switch(D.borderStyle.style){case $t.Dashed:Mt.borderStyle="dashed";break;case $t.Solid:Mt.borderStyle="solid";break;case $t.Underline:Mt=Object.assign({borderBottomStyle:"solid"},Mt);case $t.Beveled:case $t.Inset:}var Ft=D.borderStyle.width;Mt.borderWidth="".concat(Ft,"px"),D.borderStyle.style!==$t.Underline&&(pt-=2*Ft,Gt-=2*Ft);var Nt=D.borderStyle,Pt=Nt.horizontalCornerRadius,jt=Nt.verticalCornerRadius;(Pt>0||jt>0)&&(Mt.borderRadius="".concat(Pt,"px / ").concat(jt,"px")),D.color?Mt.borderColor="rgb(".concat(0|D.color[0],", ").concat(0|D.color[1],", ").concat(0|D.color[2],")"):Mt.borderWidth="0"}return n.createElement(n.Fragment,null,Z&&N({popup:{opened:ot,closeOnHover:lt,openOnHover:at,toggleOnClick:_t},slot:{attrs:{style:Object.assign({height:"".concat(Gt,"px"),left:"".concat(mt[0],"px"),top:"".concat(mt[1],"px"),transform:"matrix(".concat(B.transform.join(","),")"),transformOrigin:"-".concat(mt[0],"px -").concat(mt[1],"px"),width:"".concat(pt,"px")},Mt)},children:n.createElement(n.Fragment,null,G&&ot&&n.createElement(oe,{annotation:D}))}}))},Ge=function(o){var y=o.annotation,D=o.page,N=o.viewport,V=y.hasPopup===!1,G=St(y),Z=Q(y),Y=!!(y.hasPopup||G||Z);return n.createElement(Qt,{annotation:y,hasPopup:V,ignoreBorder:!0,isRenderable:Y,page:D,viewport:N},(function(B){return n.createElement("div",t({},B.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--caret","data-annotation-id":y.id,onClick:B.popup.toggleOnClick,onMouseEnter:B.popup.openOnHover,onMouseLeave:B.popup.closeOnHover}),B.slot.children)}))},Xe=function(o){var y=o.annotation,D=o.page,N=o.viewport,V=y.hasPopup===!1,G=St(y),Z=Q(y),Y=!!(y.hasPopup||G||Z),B=y.rect,J=B[2]-B[0],K=B[3]-B[1],lt=y.borderStyle.width;return n.createElement(Qt,{annotation:y,hasPopup:V,ignoreBorder:!0,isRenderable:Y,page:D,viewport:N},(function(ot){return n.createElement("div",t({},ot.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--circle","data-annotation-id":y.id,onClick:ot.popup.toggleOnClick,onMouseEnter:ot.popup.openOnHover,onMouseLeave:ot.popup.closeOnHover}),n.createElement("svg",{height:"".concat(K,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(J," ").concat(K),width:"".concat(J,"px")},n.createElement("circle",{cy:K/2,fill:"none",rx:J/2-lt/2,ry:K/2-lt/2,stroke:"transparent",strokeWidth:lt||1})),ot.slot.children)}))},ze=function(o){var y=o.annotation,D=o.page,N=o.viewport,V=St(y),G=Q(y),Z=!(y.hasPopup!==!1||!V&&!G),Y=function(){var B,J,K,lt,ot=y.file;ot&&(B=ot.filename,J=ot.content,K=typeof J=="string"?"":URL.createObjectURL(new Blob([J],{type:""})),(lt=document.createElement("a")).style.display="none",lt.href=K||B,lt.setAttribute("download",(function(at){var _t=at.split("/").pop();return _t?_t.split("#")[0].split("?")[0]:at})(B)),document.body.appendChild(lt),lt.click(),document.body.removeChild(lt),K&&URL.revokeObjectURL(K))};return n.createElement(Qt,{annotation:y,hasPopup:Z,ignoreBorder:!0,isRenderable:!0,page:D,viewport:N},(function(B){return n.createElement("div",t({},B.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--file-attachment","data-annotation-id":y.id,onClick:B.popup.toggleOnClick,onDoubleClick:Y,onMouseEnter:B.popup.openOnHover,onMouseLeave:B.popup.closeOnHover}),B.slot.children)}))},Me=function(o){var y=o.annotation,D=o.page,N=o.viewport,V=y.hasPopup===!1,G=St(y),Z=Q(y),Y=!!(y.hasPopup||G||Z);return n.createElement(Qt,{annotation:y,hasPopup:V,ignoreBorder:!0,isRenderable:Y,page:D,viewport:N},(function(B){return n.createElement("div",t({},B.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--free-text","data-annotation-id":y.id,onClick:B.popup.toggleOnClick,onMouseEnter:B.popup.openOnHover,onMouseLeave:B.popup.closeOnHover}),B.slot.children)}))},Ue=function(o){var y=o.annotation,D=o.page,N=o.viewport,V=St(y),G=Q(y),Z=!(!V&&!G),Y=!y.parentType||["Circle","Ink","Line","Polygon","PolyLine","Square"].indexOf(y.parentType)!==-1;return e((function(){if(y.parentId){var B=document.querySelector('[data-annotation-id="'.concat(y.parentId,'"]')),J=document.querySelector('[data-annotation-id="'.concat(y.id,'"]'));if(B&&J){var K=parseFloat(B.style.left),lt=parseFloat(B.style.top)+parseFloat(B.style.height);J.style.left="".concat(K,"px"),J.style.top="".concat(lt,"px"),J.style.transformOrigin="-".concat(K,"px -").concat(lt,"px")}}}),[]),n.createElement(Qt,{annotation:y,hasPopup:Y,ignoreBorder:!1,isRenderable:Z,page:D,viewport:N},(function(B){return n.createElement("div",t({},B.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--popup","data-annotation-id":y.id}),n.createElement(oe,{annotation:y}))}))},Be=function(o){var y=o.annotation,D=o.childAnnotation,N=o.page,V=o.viewport,G=y.hasPopup===!1,Z=St(y),Y=Q(y),B=!!(y.hasPopup||Z||Y);if(y.quadPoints&&y.quadPoints.length>0){var J=y.quadPoints.map((function(K){return Object.assign({},y,{rect:[K[2].x,K[2].y,K[1].x,K[1].y],quadPoints:[]})}));return n.createElement(n.Fragment,null,J.map((function(K,lt){return n.createElement(Be,{key:lt,annotation:K,childAnnotation:D,page:N,viewport:V})})))}return n.createElement(Qt,{annotation:y,hasPopup:G,ignoreBorder:!0,isRenderable:B,page:N,viewport:V},(function(K){return n.createElement(n.Fragment,null,n.createElement("div",t({},K.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--highlight","data-annotation-id":y.id,onClick:K.popup.toggleOnClick,onMouseEnter:K.popup.openOnHover,onMouseLeave:K.popup.closeOnHover}),K.slot.children),D&&D.annotationType===d.AnnotationType.Popup&&K.popup.opened&&n.createElement(Ue,{annotation:D,page:N,viewport:V}))}))},rn=function(o){var y=o.annotation,D=o.page,N=o.viewport,V=y.hasPopup===!1,G=St(y),Z=Q(y),Y=!!(y.hasPopup||G||Z),B=y.rect,J=B[2]-B[0],K=B[3]-B[1],lt=y.borderStyle.width;return n.createElement(Qt,{annotation:y,hasPopup:V,ignoreBorder:!0,isRenderable:Y,page:D,viewport:N},(function(ot){return n.createElement("div",t({},ot.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--ink","data-annotation-id":y.id,onClick:ot.popup.toggleOnClick,onMouseEnter:ot.popup.openOnHover,onMouseLeave:ot.popup.closeOnHover}),y.inkLists&&y.inkLists.length&&n.createElement("svg",{height:"".concat(K,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(J," ").concat(K),width:"".concat(J,"px")},y.inkLists.map((function(at,_t){return n.createElement("polyline",{key:_t,fill:"none",stroke:"transparent",strokeWidth:lt||1,points:at.map((function(mt){return"".concat(mt.x-B[0],",").concat(B[3]-mt.y)})).join(" ")})}))),ot.slot.children)}))},Se=function(o){var y=o.annotation,D=o.page,N=o.viewport,V=y.hasPopup===!1,G=St(y),Z=Q(y),Y=!!(y.hasPopup||G||Z),B=y.rect,J=B[2]-B[0],K=B[3]-B[1],lt=y.borderStyle.width;return n.createElement(Qt,{annotation:y,hasPopup:V,ignoreBorder:!0,isRenderable:Y,page:D,viewport:N},(function(ot){return n.createElement("div",t({},ot.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--line","data-annotation-id":y.id,onClick:ot.popup.toggleOnClick,onMouseEnter:ot.popup.openOnHover,onMouseLeave:ot.popup.closeOnHover}),n.createElement("svg",{height:"".concat(K,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(J," ").concat(K),width:"".concat(J,"px")},n.createElement("line",{stroke:"transparent",strokeWidth:lt||1,x1:B[2]-y.lineCoordinates[0],x2:B[2]-y.lineCoordinates[2],y1:B[3]-y.lineCoordinates[1],y2:B[3]-y.lineCoordinates[3]})),ot.slot.children)}))},sn=/^([^\w]*)(javascript|data|vbscript)/im,an=/&#(\w+)(^\w|;)?/g,hn=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,dn=/^([^:]+):/gm,Qe=function(o,y){var D,N=(D=o||"",D.replace(an,(function(Y,B){return String.fromCharCode(B)}))).replace(hn,"").trim();if(!N)return y;var V=N[0];if(V==="."||V==="/")return N;var G=N.match(dn);if(!G)return N;var Z=G[0];return sn.test(Z)?y:N},Fe=function(o){var y,D=o.annotation,N=o.annotationContainerRef,V=o.doc,G=o.outlines,Z=o.page,Y=o.pageIndex,B=o.scale,J=o.viewport,K=o.onExecuteNamedAction,lt=o.onJumpFromLinkAnnotation,ot=o.onJumpToDest,at=n.useRef(),_t=G&&G.length&&D.dest&&typeof D.dest=="string"?(y=G.find((function(Mt){return Mt.dest===D.dest})))===null||y===void 0?void 0:y.title:"",mt=!!(D.url||D.dest||D.action||D.unsafeUrl),pt={};if(D.url||D.unsafeUrl){var Gt=Qe(D.url||D.unsafeUrl,"");Gt?pt={"data-target":"external",href:Gt,rel:"noopener noreferrer nofollow",target:D.newWindow?"_blank":"",title:Gt}:mt=!1}else pt={href:"","data-annotation-link":D.id,onClick:function(Mt){Mt.preventDefault(),D.action?K(D.action):un(V,D.dest).then((function(Ft){var Nt=at.current,Pt=N.current;if(Nt&&Pt){var jt=Nt.getBoundingClientRect();Pt.style.setProperty("height","100%"),Pt.style.setProperty("width","100%");var It=Pt.getBoundingClientRect();Pt.style.removeProperty("height"),Pt.style.removeProperty("width");var te=(jt.left-It.left)/B,Zt=(It.bottom-jt.bottom+jt.height)/B;lt({bottomOffset:Zt,label:_t,leftOffset:te,pageIndex:Y})}ot(Ft)}))}};return _t&&(pt=Object.assign({},pt,{title:_t,"aria-label":_t})),n.createElement(Qt,{annotation:D,hasPopup:!1,ignoreBorder:!1,isRenderable:mt,page:Z,viewport:J},(function(Mt){return n.createElement("div",t({},Mt.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--link","data-annotation-id":D.id,"data-testid":"core__annotation--link-".concat(D.id)}),n.createElement("a",t({ref:at},pt)))}))},tn=function(o){var y=o.annotation,D=o.page,N=o.viewport,V=y.hasPopup===!1,G=St(y),Z=Q(y),Y=!!(y.hasPopup||G||Z),B=y.rect,J=B[2]-B[0],K=B[3]-B[1],lt=y.borderStyle.width;return n.createElement(Qt,{annotation:y,hasPopup:V,ignoreBorder:!0,isRenderable:Y,page:D,viewport:N},(function(ot){return n.createElement("div",t({},ot.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--polygon","data-annotation-id":y.id,onClick:ot.popup.toggleOnClick,onMouseEnter:ot.popup.openOnHover,onMouseLeave:ot.popup.closeOnHover}),y.vertices&&y.vertices.length&&n.createElement("svg",{height:"".concat(K,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(J," ").concat(K),width:"".concat(J,"px")},n.createElement("polygon",{fill:"none",stroke:"transparent",strokeWidth:lt||1,points:y.vertices.map((function(at){return"".concat(at.x-B[0],",").concat(B[3]-at.y)})).join(" ")})),ot.slot.children)}))},fn=function(o){var y=o.annotation,D=o.page,N=o.viewport,V=y.hasPopup===!1,G=St(y),Z=Q(y),Y=!!(y.hasPopup||G||Z),B=y.rect,J=B[2]-B[0],K=B[3]-B[1],lt=y.borderStyle.width;return n.createElement(Qt,{annotation:y,hasPopup:V,ignoreBorder:!0,isRenderable:Y,page:D,viewport:N},(function(ot){return n.createElement("div",t({},ot.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--polyline","data-annotation-id":y.id,onClick:ot.popup.toggleOnClick,onMouseEnter:ot.popup.openOnHover,onMouseLeave:ot.popup.closeOnHover}),y.vertices&&y.vertices.length&&n.createElement("svg",{height:"".concat(K,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(J," ").concat(K),width:"".concat(J,"px")},n.createElement("polyline",{fill:"none",stroke:"transparent",strokeWidth:lt||1,points:y.vertices.map((function(at){return"".concat(at.x-B[0],",").concat(B[3]-at.y)})).join(" ")})),ot.slot.children)}))},Qn=function(o){var y=o.annotation,D=o.page,N=o.viewport,V=y.hasPopup===!1,G=St(y),Z=Q(y),Y=!!(y.hasPopup||G||Z),B=y.rect,J=B[2]-B[0],K=B[3]-B[1],lt=y.borderStyle.width;return n.createElement(Qt,{annotation:y,hasPopup:V,ignoreBorder:!0,isRenderable:Y,page:D,viewport:N},(function(ot){return n.createElement("div",t({},ot.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--square","data-annotation-id":y.id,onClick:ot.popup.toggleOnClick,onMouseEnter:ot.popup.openOnHover,onMouseLeave:ot.popup.closeOnHover}),n.createElement("svg",{height:"".concat(K,"px"),preserveAspectRatio:"none",version:"1.1",viewBox:"0 0 ".concat(J," ").concat(K),width:"".concat(J,"px")},n.createElement("rect",{height:K-lt,fill:"none",stroke:"transparent",strokeWidth:lt||1,x:lt/2,y:lt/2,width:J-lt})),ot.slot.children)}))},ti=function(o){var y=o.annotation,D=o.page,N=o.viewport,V=y.hasPopup===!1,G=St(y),Z=Q(y),Y=!!(y.hasPopup||G||Z);return n.createElement(Qt,{annotation:y,hasPopup:V,ignoreBorder:!0,isRenderable:Y,page:D,viewport:N},(function(B){return n.createElement("div",t({},B.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--squiggly","data-annotation-id":y.id,onClick:B.popup.toggleOnClick,onMouseEnter:B.popup.openOnHover,onMouseLeave:B.popup.closeOnHover}),B.slot.children)}))},ei=function(o){var y=o.annotation,D=o.page,N=o.viewport,V=y.hasPopup===!1,G=St(y),Z=Q(y),Y=!!(y.hasPopup||G||Z);return n.createElement(Qt,{annotation:y,hasPopup:V,ignoreBorder:!0,isRenderable:Y,page:D,viewport:N},(function(B){return n.createElement("div",t({},B.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--stamp","data-annotation-id":y.id,onClick:B.popup.toggleOnClick,onMouseEnter:B.popup.openOnHover,onMouseLeave:B.popup.closeOnHover}),B.slot.children)}))},ni=function(o){var y=o.annotation,D=o.page,N=o.viewport,V=y.hasPopup===!1,G=St(y),Z=Q(y),Y=!!(y.hasPopup||G||Z);return n.createElement(Qt,{annotation:y,hasPopup:V,ignoreBorder:!0,isRenderable:Y,page:D,viewport:N},(function(B){return n.createElement("div",t({},B.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--strike-out","data-annotation-id":y.id,onClick:B.popup.toggleOnClick,onMouseEnter:B.popup.openOnHover,onMouseLeave:B.popup.closeOnHover}),B.slot.children)}))},ii=function(){return n.createElement(v,{size:16},n.createElement("path",{d:"M.5,16.5a1,1,0,0,0,1,1h2v4l4-4h15a1,1,0,0,0,1-1V3.5a1,1,0,0,0-1-1H1.5a1,1,0,0,0-1,1Z"}),n.createElement("path",{d:"M7.25,9.75A.25.25,0,1,1,7,10a.25.25,0,0,1,.25-.25"}),n.createElement("path",{d:"M12,9.75a.25.25,0,1,1-.25.25A.25.25,0,0,1,12,9.75"}),n.createElement("path",{d:"M16.75,9.75a.25.25,0,1,1-.25.25.25.25,0,0,1,.25-.25"}))},ri=function(){return n.createElement(v,{size:16},n.createElement("path",{d:"M0.500 12.001 A11.500 11.500 0 1 0 23.500 12.001 A11.500 11.500 0 1 0 0.500 12.001 Z"}),n.createElement("path",{d:"M6.000 12.001 A6.000 6.000 0 1 0 18.000 12.001 A6.000 6.000 0 1 0 6.000 12.001 Z"}),n.createElement("path",{d:"M21.423 5.406L17.415 9.414"}),n.createElement("path",{d:"M14.587 6.585L18.607 2.565"}),n.createElement("path",{d:"M5.405 21.424L9.413 17.416"}),n.createElement("path",{d:"M6.585 14.588L2.577 18.596"}),n.createElement("path",{d:"M18.602 21.419L14.595 17.412"}),n.createElement("path",{d:"M17.419 14.58L21.428 18.589"}),n.createElement("path",{d:"M2.582 5.399L6.588 9.406"}),n.createElement("path",{d:"M9.421 6.581L5.412 2.572"}))},si=function(){return n.createElement(v,{size:16},n.createElement("path",{d:"M4.000 18.500 A1.500 1.500 0 1 0 7.000 18.500 A1.500 1.500 0 1 0 4.000 18.500 Z"}),n.createElement("path",{d:"M20.5.5l-9.782,9.783a7,7,0,1,0,3,3L17,10h1.5V8.5L19,8h1.5V6.5L21,6h1.5V4.5l1-1V.5Z"}))},ai=function(){return n.createElement(v,{size:16},n.createElement("path",{d:"M2.000 2.500 L22.000 2.500 L22.000 23.500 L2.000 23.500 Z"}),n.createElement("path",{d:"M6 4.5L6 0.5"}),n.createElement("path",{d:"M18 4.5L18 0.5"}),n.createElement("path",{d:"M10 4.5L10 0.5"}),n.createElement("path",{d:"M14 4.5L14 0.5"}))},oi=function(){return n.createElement(v,{size:16},n.createElement("path",{d:"M17.5 0.498L17.5 23.498"}),n.createElement("path",{d:"M10.5 0.498L10.5 23.498"}),n.createElement("path",{d:"M23.5.5H6.5a6,6,0,0,0,0,12h4"}))},li=function(){return n.createElement(v,{size:16},n.createElement("path",{d:"M2.5 22.995L12 6.005 21.5 22.995 2.5 22.995z"}))},ci=function(o){var y=o.annotation,D=o.childAnnotation,N=o.page,V=o.viewport,G=y.hasPopup===!1,Z=St(y),Y=Q(y),B=!!(y.hasPopup||Z||Y),J=y.name?y.name.toLowerCase():"";return n.createElement(Qt,{annotation:y,hasPopup:G,ignoreBorder:!1,isRenderable:B,page:N,viewport:V},(function(K){return n.createElement(n.Fragment,null,n.createElement("div",t({},K.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--text","data-annotation-id":y.id,onClick:K.popup.toggleOnClick,onMouseEnter:K.popup.openOnHover,onMouseLeave:K.popup.closeOnHover}),J&&n.createElement("div",{className:"rpv-core__annotation-text-icon"},J==="check"&&n.createElement(l,null),J==="comment"&&n.createElement(ii,null),J==="help"&&n.createElement(ri,null),J==="insert"&&n.createElement(li,null),J==="key"&&n.createElement(si,null),J==="note"&&n.createElement(ai,null),(J==="newparagraph"||J==="paragraph")&&n.createElement(oi,null)),K.slot.children),D&&D.annotationType===d.AnnotationType.Popup&&K.popup.opened&&n.createElement(Ue,{annotation:D,page:N,viewport:V}))}))},ui=function(o){var y=o.annotation,D=o.page,N=o.viewport,V=y.hasPopup===!1,G=St(y),Z=Q(y),Y=!!(y.hasPopup||G||Z);return n.createElement(Qt,{annotation:y,hasPopup:V,ignoreBorder:!0,isRenderable:Y,page:D,viewport:N},(function(B){return n.createElement("div",t({},B.slot.attrs,{className:"rpv-core__annotation rpv-core__annotation--underline","data-annotation-id":y.id,onClick:B.popup.toggleOnClick,onMouseEnter:B.popup.openOnHover,onMouseLeave:B.popup.closeOnHover}),B.slot.children)}))},hi=function(o){var y=o.annotations,D=o.doc,N=o.outlines,V=o.page,G=o.pageIndex,Z=o.plugins,Y=o.rotation,B=o.scale,J=o.onExecuteNamedAction,K=o.onJumpFromLinkAnnotation,lt=o.onJumpToDest,ot=n.useRef(),at=V.getViewport({rotation:Y,scale:B}).clone({dontFlip:!0}),_t=y.filter((function(mt){return!mt.parentId}));return e((function(){var mt=ot.current;mt&&Z.forEach((function(pt){pt.onAnnotationLayerRender&&pt.onAnnotationLayerRender({annotations:_t,container:mt,pageIndex:G,rotation:Y,scale:B})}))}),[]),n.createElement("div",{ref:ot,className:"rpv-core__annotation-layer","data-testid":"core__annotation-layer-".concat(G)},_t.map((function(mt){var pt=y.find((function(Gt){return Gt.parentId===mt.id}));switch(mt.annotationType){case d.AnnotationType.Caret:return n.createElement(Ge,{key:mt.id,annotation:mt,page:V,viewport:at});case d.AnnotationType.Circle:return n.createElement(Xe,{key:mt.id,annotation:mt,page:V,viewport:at});case d.AnnotationType.FileAttachment:return n.createElement(ze,{key:mt.id,annotation:mt,page:V,viewport:at});case d.AnnotationType.FreeText:return n.createElement(Me,{key:mt.id,annotation:mt,page:V,viewport:at});case d.AnnotationType.Highlight:return n.createElement(Be,{key:mt.id,annotation:mt,childAnnotation:pt,page:V,viewport:at});case d.AnnotationType.Ink:return n.createElement(rn,{key:mt.id,annotation:mt,page:V,viewport:at});case d.AnnotationType.Line:return n.createElement(Se,{key:mt.id,annotation:mt,page:V,viewport:at});case d.AnnotationType.Link:return n.createElement(Fe,{key:mt.id,annotation:mt,annotationContainerRef:ot,doc:D,outlines:N,page:V,pageIndex:G,scale:B,viewport:at,onExecuteNamedAction:J,onJumpFromLinkAnnotation:K,onJumpToDest:lt});case d.AnnotationType.Polygon:return n.createElement(tn,{key:mt.id,annotation:mt,page:V,viewport:at});case d.AnnotationType.Polyline:return n.createElement(fn,{key:mt.id,annotation:mt,page:V,viewport:at});case d.AnnotationType.Popup:return n.createElement(Ue,{key:mt.id,annotation:mt,page:V,viewport:at});case d.AnnotationType.Square:return n.createElement(Qn,{key:mt.id,annotation:mt,page:V,viewport:at});case d.AnnotationType.Squiggly:return n.createElement(ti,{key:mt.id,annotation:mt,page:V,viewport:at});case d.AnnotationType.Stamp:return n.createElement(ei,{key:mt.id,annotation:mt,page:V,viewport:at});case d.AnnotationType.StrikeOut:return n.createElement(ni,{key:mt.id,annotation:mt,page:V,viewport:at});case d.AnnotationType.Text:return n.createElement(ci,{key:mt.id,annotation:mt,childAnnotation:pt,page:V,viewport:at});case d.AnnotationType.Underline:return n.createElement(ui,{key:mt.id,annotation:mt,page:V,viewport:at});default:return n.createElement(n.Fragment,{key:mt.id})}})))},di=function(o){var y=o.page,D=o.renderAnnotations,N=Et(),V=n.useState({loading:!0,annotations:[]}),G=V[0],Z=V[1];return n.useEffect((function(){y.getAnnotations({intent:"display"}).then((function(Y){N.current&&Z({loading:!1,annotations:Y})}))}),[]),G.loading?n.createElement(n.Fragment,null):D(G.annotations)},fi=function(o){var y=o.doc,D=o.outlines,N=o.page,V=o.pageIndex,G=o.plugins,Z=o.rotation,Y=o.scale,B=o.onExecuteNamedAction,J=o.onJumpFromLinkAnnotation,K=o.onJumpToDest;return n.createElement(di,{page:N,renderAnnotations:function(lt){return n.createElement(hi,{annotations:lt,doc:y,outlines:D,page:N,pageIndex:V,plugins:G,rotation:Z,scale:Y,onExecuteNamedAction:B,onJumpFromLinkAnnotation:J,onJumpToDest:K})}})},mn=function(o,y){var D=o%y;return D===0?o:Math.floor(o-D)},pi=function(o){var y=o.canvasLayerRef,D=o.height,N=o.page,V=o.pageIndex,G=o.plugins,Z=o.rotation,Y=o.scale,B=o.width,J=o.onRenderCanvasCompleted,K=n.useRef();return e((function(){var lt=K.current;lt&&lt.cancel();var ot=y.current;ot.removeAttribute("data-testid"),G.forEach((function(It){It.onCanvasLayerRender&&It.onCanvasLayerRender({ele:ot,pageIndex:V,rotation:Z,scale:Y,status:d.LayerRenderStatus.PreRender})}));var at=N.getViewport({rotation:Z,scale:Y}),_t=window.devicePixelRatio||1,mt=Math.sqrt(16777216/(at.width*at.height)),pt=_t>mt;pt?ot.style.transform="scale(1, 1)":ot.style.removeProperty("transform");var Gt=Math.min(mt,_t),Mt=(function(It,te){var Zt,ee;if(Math.floor(It)===It)return[It,1];var ie=1/It;if(ie>te)return[1,te];if(Math.floor(ie)===ie)return[1,ie];for(var se=It>1?ie:It,_e=0,fe=1,ye=1,ge=1;;){var ve=_e+ye,be=fe+ge;if(be>te)break;se<=ve/be?(ye=(Zt=[ve,be])[0],ge=Zt[1]):(_e=(ee=[ve,be])[0],fe=ee[1])}return se<(_e/fe+ye/ge)/2?se===It?[_e,fe]:[fe,_e]:se===It?[ye,ge]:[ge,ye]})(Gt,8),Ft=Mt[0],Nt=Mt[1];ot.width=mn(at.width*Gt,Ft),ot.height=mn(at.height*Gt,Ft),ot.style.width="".concat(mn(at.width,Nt),"px"),ot.style.height="".concat(mn(at.height,Nt),"px"),ot.hidden=!0;var Pt=ot.getContext("2d",{alpha:!1}),jt=pt||_t!==1?[Gt,0,0,Gt,0,0]:null;return K.current=N.render({canvasContext:Pt,transform:jt,viewport:at}),K.current.promise.then((function(){ot.hidden=!1,ot.setAttribute("data-testid","core__canvas-layer-".concat(V)),G.forEach((function(It){It.onCanvasLayerRender&&It.onCanvasLayerRender({ele:ot,pageIndex:V,rotation:Z,scale:Y,status:d.LayerRenderStatus.DidRender})})),J()}),(function(){J()})),function(){ot&&(ot.width=0,ot.height=0)}}),[]),n.createElement("div",{className:"rpv-core__canvas-layer",style:{height:"".concat(D,"px"),width:"".concat(B,"px")}},n.createElement("canvas",{ref:y}))},gi=function(o){var y=o.height,D=o.page,N=o.rotation,V=o.scale,G=o.width,Z=n.useRef();return e((function(){var Y=Z.current,B=D.getViewport({rotation:N,scale:V});D.getOperatorList().then((function(J){(function(){var K=Z.current;K&&(K.innerHTML="")})(),new x.SVGGraphics(D.commonObjs,D.objs).getSVG(J,B).then((function(K){K.style.height="".concat(y,"px"),K.style.width="".concat(G,"px"),Y.appendChild(K)}))}))}),[]),n.createElement("div",{className:"rpv-core__svg-layer",ref:Z})},mi=function(o){var y=o.containerRef,D=o.page,N=o.pageIndex,V=o.plugins,G=o.rotation,Z=o.scale,Y=o.onRenderTextCompleted,B=n.useRef(),J=function(){var K=y.current;K&&([].slice.call(K.querySelectorAll(".rpv-core__text-layer-text")).forEach((function(lt){return K.removeChild(lt)})),[].slice.call(K.querySelectorAll('br[role="presentation"]')).forEach((function(lt){return K.removeChild(lt)})))};return e((function(){var K=B.current;K&&K.cancel();var lt=y.current;if(lt){lt.removeAttribute("data-testid");var ot=D.getViewport({rotation:G,scale:Z});return V.forEach((function(at){at.onTextLayerRender&&at.onTextLayerRender({ele:lt,pageIndex:N,scale:Z,status:d.LayerRenderStatus.PreRender})})),D.getTextContent().then((function(at){J(),B.current=x.renderTextLayer({container:lt,textContent:at,textContentSource:at,viewport:ot}),B.current.promise.then((function(){lt.setAttribute("data-testid","core__text-layer-".concat(N)),[].slice.call(lt.children).forEach((function(_t){_t.classList.contains("rpv-core__text-layer-text--not")||_t.classList.add("rpv-core__text-layer-text")})),V.forEach((function(_t){_t.onTextLayerRender&&_t.onTextLayerRender({ele:lt,pageIndex:N,scale:Z,status:d.LayerRenderStatus.DidRender})})),Y()}),(function(){lt.removeAttribute("data-testid"),Y()}))})),function(){var at;J(),(at=B.current)===null||at===void 0||at.cancel()}}}),[]),n.createElement("div",{className:"rpv-core__text-layer",ref:y})},vi=function(o){var y=o.doc,D=o.measureRef,N=o.outlines,V=o.pageIndex,G=o.pageRotation,Z=o.pageSize,Y=o.plugins,B=o.renderPage,J=o.renderQueueKey,K=o.rotation,lt=o.scale,ot=o.shouldRender,at=o.viewMode,_t=o.onExecuteNamedAction,mt=o.onJumpFromLinkAnnotation,pt=o.onJumpToDest,Gt=o.onRenderCompleted,Mt=o.onRotatePage,Ft=Et(),Nt=n.useState(null),Pt=Nt[0],jt=Nt[1],It=n.useState(!1),te=It[0],Zt=It[1],ee=n.useState(!1),ie=ee[0],se=ee[1],_e=n.useRef(),fe=n.useRef(),ye=Math.abs(K+G)%180==0,ge=Z.pageWidth*lt,ve=Z.pageHeight*lt,be=ye?ge:ve,me=ye?ve:ge,xe=(Z.rotation+K+G)%360,We=n.useRef(0),je=B||function(Ce){return n.createElement(n.Fragment,null,Ce.canvasLayer.children,Ce.textLayer.children,Ce.annotationLayer.children)};return n.useEffect((function(){jt(null),Zt(!1),se(!1)}),[G,K,lt]),n.useEffect((function(){ot&&Ft.current&&!Pt&&qe(y,V).then((function(Ce){Ft.current&&(We.current=J,jt(Ce))}))}),[ot,Pt]),n.useEffect((function(){te&&ie&&(J!==We.current?(jt(null),Zt(!1),se(!1)):Gt(V))}),[te,ie]),n.createElement("div",{className:c({"rpv-core__page-layer":!0,"rpv-core__page-layer--dual":at===d.ViewMode.DualPage,"rpv-core__page-layer--dual-cover":at===d.ViewMode.DualPageWithCover,"rpv-core__page-layer--single":at===d.ViewMode.SinglePage}),"data-testid":"core__page-layer-".concat(V),ref:D,style:{height:"".concat(me,"px"),width:"".concat(be,"px")}},Pt?n.createElement(n.Fragment,null,je({annotationLayer:{attrs:{},children:n.createElement(fi,{doc:y,outlines:N,page:Pt,pageIndex:V,plugins:Y,rotation:xe,scale:lt,onExecuteNamedAction:_t,onJumpFromLinkAnnotation:mt,onJumpToDest:pt})},canvasLayer:{attrs:{},children:n.createElement(pi,{canvasLayerRef:_e,height:me,page:Pt,pageIndex:V,plugins:Y,rotation:xe,scale:lt,width:be,onRenderCanvasCompleted:function(){Ft.current&&Zt(!0)}})},canvasLayerRendered:te,doc:y,height:me,pageIndex:V,rotation:xe,scale:lt,svgLayer:{attrs:{},children:n.createElement(gi,{height:me,page:Pt,rotation:xe,scale:lt,width:be})},textLayer:{attrs:{},children:n.createElement(mi,{containerRef:fe,page:Pt,pageIndex:V,plugins:Y,rotation:xe,scale:lt,onRenderTextCompleted:function(){Ft.current&&se(!0)}})},textLayerRendered:ie,width:be,markRendered:Gt,onRotatePage:function(Ce){return Mt(V,Ce)}}),Y.map((function(Ce,Le){return Ce.renderPageLayer?n.createElement(n.Fragment,{key:Le},Ce.renderPageLayer({canvasLayerRef:_e,canvasLayerRendered:te,doc:y,height:me,pageIndex:V,rotation:xe,scale:lt,textLayerRef:fe,textLayerRendered:ie,width:be})):n.createElement(n.Fragment,{key:Le})}))):n.createElement(M,{testId:"core__page-layer-loading-".concat(V)}))},bi=function(o,y){var D=y.rect;return o.height!==D.height||o.width!==D.width?D:o};(function(o){o.Horizontal="Horizontal",o.Vertical="Vertical",o.Both="Both"})(Wt||(Wt={}));var _i=function(o){return 1-Math.pow(1-o,4)},vn=1e-4,In={left:0,top:0},On={capture:!1,passive:!0},yi=function(o){var y=o.elementRef,D=o.enableSmoothScroll,N=o.isRtl,V=o.scrollDirection,G=o.onSmoothScroll,Z=n.useState(In),Y=Z[0],B=Z[1],J=n.useState(y.current),K=J[0],lt=J[1],ot=N?-1:1,at=n.useRef(V);at.current=V;var _t=n.useRef(In),mt=n.useRef(!0),pt=n.useCallback((function(){mt.current=!0,D&&B(_t.current),G(!1)}),[]),Gt=n.useCallback((function(){if(K){switch(at.current){case Wt.Horizontal:_t.current={left:ot*K.scrollLeft,top:0};break;case Wt.Both:_t.current={left:ot*K.scrollLeft,top:K.scrollTop};break;case Wt.Vertical:default:_t.current={left:0,top:K.scrollTop}}D&&!mt.current||B(_t.current)}}),[K]);e((function(){lt(y.current)})),e((function(){if(K)return K.addEventListener("scroll",Gt,On),function(){K.removeEventListener("scroll",Gt,On)}}),[K]);var Mt=n.useCallback((function(Ft,Nt){var Pt=y.current;if(!Pt)return Promise.resolve();var jt={left:0,top:0};switch(at.current){case Wt.Horizontal:jt.left=ot*Ft.left;break;case Wt.Both:jt.left=ot*Ft.left,jt.top=Ft.top;break;case Wt.Vertical:default:jt.top=Ft.top}return Nt?(mt.current=!1,G(!0),new Promise((function(It,te){(function(Zt,ee,ie,se,_e,fe){_e===void 0&&(_e=function(Le){return Le}),fe===void 0&&(fe=function(){});var ye=0,ge=0,ve=!1;switch(ee){case Wt.Horizontal:ge=Zt.scrollLeft,ye=0;case Wt.Both:ge=Zt.scrollLeft,ye=Zt.scrollTop;break;case Wt.Vertical:default:ge=0,ye=Zt.scrollTop}var be=function(){ve||(ve=!0,Zt.scrollLeft=ie.left,Zt.scrollTop=ie.top,fe())};if(Math.abs(ye-ie.top)<=vn&&ee===Wt.Vertical)be();else if(Math.abs(ge-ie.left)<=vn&&ee===Wt.Horizontal)be();else{var me,xe=-1,We=ge-ie.left,je=ye-ie.top,Ce=function(Le){xe===-1&&(xe=Le);var Ve=Le-xe,Ot=Math.min(Ve/se,1),Dt=_e(Ot),Tt={left:ge-We*Dt,top:ye-je*Dt};switch(ee){case Wt.Horizontal:Zt.scrollLeft=Tt.left;break;case Wt.Both:Zt.scrollLeft=Tt.left,Zt.scrollTop=Tt.top;break;case Wt.Vertical:default:Zt.scrollTop=Tt.top}Math.abs(Tt.top-ie.top)<=vn&&Math.abs(Tt.left-ie.left)<=vn&&!ve&&(window.cancelAnimationFrame(me),be()),Ve<se?me=window.requestAnimationFrame(Ce):window.cancelAnimationFrame(me)};me=window.requestAnimationFrame(Ce)}})(Pt,at.current,jt,400,_i,(function(){pt(),It()}))}))):new Promise((function(It,te){switch(at.current){case Wt.Horizontal:Pt.scrollLeft=jt.left;break;case Wt.Both:Pt.scrollLeft=jt.left,Pt.scrollTop=jt.top;break;case Wt.Vertical:default:Pt.scrollTop=jt.top}It()}))}),[y]);return{scrollOffset:Y,scrollTo:Mt}},pn=function(o,y,D){return Math.max(o,Math.min(D,y))},Ai=function(o,y){if(y!==d.ViewMode.DualPageWithCover)return 0;if(!(function(V){var G=V.length;if(G===1)return!1;for(var Z=1;Z<G;Z++)if(V[Z].height!==V[0].height||V[Z].width!==V[0].width)return!0;return!1})(o))return 2*o[0].width;var D=ne(o.slice(1),2).map((function(V){return V.length===2?V[0].width+V[1].width:V[0].width})),N=[o[0].width].concat(D);return Math.max.apply(Math,N)},Si={left:0,top:0},Ei={left:0,top:0},En={left:0,top:0},wi={left:0,top:0},Ci={height:0,width:0},Nn={left:0,top:0},Bn="data-virtual-index",Pi=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1],Ti=function(o){var y=o.enableSmoothScroll,D=o.isRtl,N=o.numberOfItems,V=o.parentRef,G=o.setRenderRange,Z=o.sizes,Y=o.scrollMode,B=o.viewMode,J=n.useState(!1),K=J[0],lt=J[1],ot=n.useCallback((function(Ot){return lt(Ot)}),[]),at=n.useRef(Y);at.current=Y;var _t=n.useRef(B);_t.current=B;var mt=Y===d.ScrollMode.Wrapped||B===d.ViewMode.DualPageWithCover||B===d.ViewMode.DualPage?Wt.Both:Y===d.ScrollMode.Horizontal?Wt.Horizontal:Wt.Vertical,pt=yi({elementRef:V,enableSmoothScroll:y,isRtl:D,scrollDirection:mt,onSmoothScroll:ot}),Gt=pt.scrollOffset,Mt=pt.scrollTo,Ft=(function(Ot){var Dt=Ot.elementRef,Tt=n.useState(Dt.current),xt=Tt[0],Rt=Tt[1],Ht=n.useRef(!1),Ut=n.useReducer(bi,{height:0,width:0}),kt=Ut[0],wt=Ut[1];return e((function(){Dt.current!==xt&&Rt(Dt.current)})),e((function(){if(xt&&!Ht.current){Ht.current=!0;var Vt=xt.getBoundingClientRect(),Yt=Vt.height,he=Vt.width;wt({rect:{height:Yt,width:he}})}}),[xt]),n.useEffect((function(){if(xt){var Vt=new ResizeObserver((function(Yt,he){Yt.forEach((function(ce){if(ce.target===xt){var Te=ce.contentRect,De=Te.height,qt=Te.width;wt({rect:{height:De,width:qt}})}}))}));return Vt.observe(xt),function(){Vt.unobserve(xt)}}}),[xt]),kt})({elementRef:V}),Nt=n.useRef({scrollOffset:Nn,measurements:[]});Nt.current.scrollOffset=Gt;var Pt=n.useMemo((function(){return Array(N).fill(-1)}),[]),jt=n.useState(Pt),It=jt[0],te=jt[1],Zt=n.useMemo((function(){var Ot=new IntersectionObserver((function(Dt){Dt.forEach((function(Tt){var xt=Tt.isIntersecting?Tt.intersectionRatio:-1,Rt=Tt.target.getAttribute(Bn);if(Rt){var Ht=parseInt(Rt,10);0<=Ht&&Ht<N&&te((function(Ut){return Ut[Ht]=xt,(function(kt,wt,Vt){for(var Yt,he=0,ce=wt.length;he<ce;he++)!Yt&&he in wt||(Yt||(Yt=Array.prototype.slice.call(wt,0,he)),Yt[he]=wt[he]);return kt.concat(Yt||Array.prototype.slice.call(wt))})([],Ut)}))}}))}),{threshold:Pi});return Ot}),[]),ee=n.useMemo((function(){return Y===d.ScrollMode.Page&&B===d.ViewMode.SinglePage?(function(Ot,Dt,Tt){for(var xt=[],Rt=0;Rt<Ot;Rt++){var Ht={height:Math.max(Dt.height,Tt[Rt].height),width:Math.max(Dt.width,Tt[Rt].width)},Ut=Rt===0?wi:xt[Rt-1].end,kt={left:Ut.left+Ht.width,top:Ut.top+Ht.height};xt[Rt]={index:Rt,start:Ut,size:Ht,end:kt,visibility:-1}}return xt})(N,Ft,Z):B===d.ViewMode.DualPageWithCover?(function(Ot,Dt,Tt,xt){for(var Rt=[],Ht=0,Ut=0,kt=En,wt=0;wt<Ot;wt++){var Vt=wt===0?{height:xt===d.ScrollMode.Page?Math.max(Dt.height,Tt[wt].height):Tt[wt].height,width:xt===d.ScrollMode.Page?Math.max(Dt.width,Tt[wt].width):Tt[wt].width}:{height:xt===d.ScrollMode.Page?Math.max(Dt.height,Tt[wt].height):Tt[wt].height,width:Math.max(Dt.width/2,Tt[wt].width)};xt===d.ScrollMode.Page?kt=wt===0?En:{left:wt%2==0?Vt.width:0,top:Math.floor((wt-1)/2)*Vt.height+Rt[0].end.top}:wt===0?(kt=En,Ht=Tt[0].height,Ut=0):wt%2==1?(kt={left:0,top:Ht+=Ut},Ut=wt===Ot-1?Tt[wt].height:Math.max(Tt[wt].height,Tt[wt+1].height)):kt={left:Rt[wt-1].end.left,top:Ht};var Yt={left:kt.left+Vt.width,top:kt.top+Vt.height};Rt[wt]={index:wt,start:kt,size:Vt,end:Yt,visibility:-1}}return Rt})(N,Ft,Z,Y):B===d.ViewMode.DualPage?(function(Ot,Dt,Tt,xt){for(var Rt=[],Ht=0,Ut=0,kt=Ei,wt=0;wt<Ot;wt++){var Vt={height:xt===d.ScrollMode.Page?Math.max(Dt.height,Tt[wt].height):Tt[wt].height,width:Math.max(Dt.width/2,Tt[wt].width)};xt===d.ScrollMode.Page?kt={left:wt%2==0?0:Vt.width,top:Math.floor(wt/2)*Vt.height}:wt%2==0?(kt={left:0,top:Ht+=Ut},Ut=wt===Ot-1?Tt[wt].height:Math.max(Tt[wt].height,Tt[wt+1].height)):kt={left:Rt[wt-1].end.left,top:Ht};var Yt={left:kt.left+Vt.width,top:kt.top+Vt.height};Rt[wt]={index:wt,start:kt,size:Vt,end:Yt,visibility:-1}}return Rt})(N,Ft,Z,Y):(function(Ot,Dt,Tt,xt){for(var Rt=[],Ht=0,Ut={left:0,top:0},kt=0,wt=Si,Vt=0;Vt<Ot;Vt++){var Yt=Tt[Vt];if(Vt===0)Ht=Yt.width,Ut={left:0,top:0},kt=Yt.height;else switch(xt){case d.ScrollMode.Wrapped:(Ht+=Yt.width)<Dt.width?(wt={left:Rt[Vt-1].end.left,top:Ut.top},kt=Math.max(kt,Yt.height)):(Ht=Yt.width,Ut={left:(wt={left:Ut.left,top:Ut.top+kt}).left,top:wt.top},kt=Yt.height);break;case d.ScrollMode.Horizontal:case d.ScrollMode.Vertical:default:wt=Rt[Vt-1].end}var he={left:wt.left+Yt.width,top:wt.top+Yt.height};Rt[Vt]={index:Vt,start:wt,size:Yt,end:he,visibility:-1}}return Rt})(N,Ft,Z,Y)}),[Y,Z,B,Ft]),ie=ee[N-1]?{height:ee[N-1].end.top,width:ee[N-1].end.left}:Ci;Nt.current.measurements=ee;var se=n.useMemo((function(){var Ot=(function(Vt,Yt,he,ce){var Te=0;switch(Vt){case Wt.Horizontal:Te=ce.left;break;case Wt.Vertical:default:Te=ce.top}var De=Yt.length-1,qt=(function(le,$e,ln,_n){for(;le<=$e;){var en=(le+$e)/2|0,gn=_n(en);if(gn<ln)le=en+1;else{if(!(gn>ln))return en;$e=en-1}}return le>0?le-1:0})(0,De,Te,(function(le){switch(Vt){case Wt.Horizontal:return Yt[le].start.left;case Wt.Both:case Wt.Vertical:default:return Yt[le].start.top}}));if(Vt===Wt.Both)for(var Re=Yt[qt].start.top;qt-1>=0&&Yt[qt-1].start.top===Re&&Yt[qt-1].start.left>=ce.left;)qt--;for(var de=qt;de<=De;){var pe={top:Yt[de].start.top-ce.top,left:Yt[de].start.left-ce.left},Ee={height:he.height-pe.top,width:he.width-pe.left};if(Vt===Wt.Horizontal&&Ee.width<0||Vt===Wt.Vertical&&Ee.height<0||Vt===Wt.Both&&(Ee.width<0||Ee.height<0))break;de++}return{start:qt,end:de}})(mt,ee,Ft,Gt),Dt=Ot.start,Tt=Ot.end,xt=It.slice(pn(0,N,Dt),pn(0,N,Tt)),Rt=Dt+xt.reduce((function(Vt,Yt,he,ce){return Yt>ce[Vt]?he:Vt}),0),Ht=Rt=pn(0,N-1,Rt),Ut=G({endPage:Tt,numPages:N,startPage:Dt}),kt=Ut.startPage,wt=Ut.endPage;switch(kt=Math.max(kt,0),wt=Math.min(wt,N-1),B){case d.ViewMode.DualPageWithCover:Rt>0&&(Ht=Rt%2==1?Rt:Rt-1),kt=kt===0?0:kt%2==1?kt:kt-1,N-(wt=wt%2==1?wt-1:wt)<=2&&(wt=N-1);break;case d.ViewMode.DualPage:Ht=Rt%2==0?Rt:Rt-1,kt=kt%2==0?kt:kt-1,wt=wt%2==1?wt:wt-1;break;case d.ViewMode.SinglePage:default:Ht=Rt}return{startPage:kt,endPage:wt,maxVisbilityIndex:Ht}}),[ee,Ft,Gt,B,It]),_e=se.startPage,fe=se.endPage,ye=se.maxVisbilityIndex,ge=n.useMemo((function(){for(var Ot=[],Dt=function(xt){var Rt=ee[xt],Ht=t(t({},Rt),{visibility:It[xt]!==void 0?It[xt]:-1,measureRef:function(Ut){Ut&&(Ut.setAttribute(Bn,"".concat(xt)),Zt.observe(Ut))}});Ot.push(Ht)},Tt=_e;Tt<=fe;Tt++)Dt(Tt);return Ot}),[_e,fe,It,ee]),ve=n.useCallback((function(Ot,Dt){var Tt=Nt.current.measurements[pn(0,N-1,Ot)],xt=at.current===d.ScrollMode.Page?Nn:Dt;return Tt?Mt({left:xt.left+Tt.start.left,top:xt.top+Tt.start.top},y):Promise.resolve()}),[Mt,y]),be=n.useCallback((function(Ot,Dt){var Tt=Nt.current.measurements,xt=Tt[Ot].start,Rt=Tt.find((function(Ut){return Ut.start.top-xt.top>1e-12}));if(!Rt)return Promise.resolve();var Ht=Rt.index;switch(_t.current){case d.ViewMode.DualPage:Ht=Ht%2==0?Ht:Ht+1;break;case d.ViewMode.DualPageWithCover:Ht=Ht%2==1?Ht:Ht+1}return ve(Ht,Dt)}),[]),me=n.useCallback((function(Ot,Dt){for(var Tt=Nt.current.measurements,xt=Tt[Ot].start,Rt=Ot,Ht=!1,Ut=N-1;Ut>=0;Ut--)if(xt.top-Tt[Ut].start.top>1e-12){Ht=!0,Rt=Tt[Ut].index;break}if(!Ht)return Promise.resolve();switch(_t.current){case d.ViewMode.DualPage:Rt=Rt%2==0?Rt:Rt-1;break;case d.ViewMode.DualPageWithCover:Rt=Rt%2==0?Rt-1:Rt}return Rt===Ot&&(Rt=Ot-1),ve(Rt,Dt)}),[]),xe=n.useCallback((function(Ot,Dt){if(_t.current===d.ViewMode.DualPageWithCover||_t.current===d.ViewMode.DualPage)return be(Ot,Dt);switch(at.current){case d.ScrollMode.Wrapped:return be(Ot,Dt);case d.ScrollMode.Horizontal:case d.ScrollMode.Vertical:default:return ve(Ot+1,Dt)}}),[]),We=n.useCallback((function(Ot,Dt){if(_t.current===d.ViewMode.DualPageWithCover||_t.current===d.ViewMode.DualPage)return me(Ot,Dt);switch(at.current){case d.ScrollMode.Wrapped:return me(Ot,Dt);case d.ScrollMode.Horizontal:case d.ScrollMode.Vertical:default:return ve(Ot-1,Dt)}}),[]),je=n.useCallback((function(){return(function(Ot,Dt){switch(Dt){case d.ScrollMode.Horizontal:return{position:"relative",height:"100%",width:"".concat(Ot.width,"px")};case d.ScrollMode.Vertical:default:return{position:"relative",height:"".concat(Ot.height,"px"),width:"100%"}}})(ie,at.current)}),[ie]),Ce=n.useCallback((function(Ot){return(function(Dt,Tt,xt){return xt!==d.ScrollMode.Page?{}:{height:"".concat(Tt.height,"px"),width:"100%",position:"absolute",top:0,transform:"translateY(".concat(Dt.start.top,"px)")}})(Ot,Ft,at.current)}),[Ft]),Le=n.useCallback((function(Ot){return(function(Dt,Tt,xt,Rt,Ht){var Ut,kt,wt,Vt,Yt,he,ce,Te=Tt?"right":"left",De=Tt?-1:1,qt=xt.length,Re=Dt.start.left*De,de=Dt.size,pe=de.height,Ee=de.width;if(Rt===d.ViewMode.DualPageWithCover){var le=Ht===d.ScrollMode.Page?0:Dt.start.top;return Dt.index===0||qt%2==0&&Dt.index===qt-1?((Ut={height:"".concat(pe,"px"),minWidth:"".concat(Ai(xt,Rt),"px"),width:"100%"})[Te]=0,Ut.position="absolute",Ut.top=0,Ut.transform="translate(".concat(Re,"px, ").concat(le,"px)"),Ut):((kt={height:"".concat(pe,"px"),width:"".concat(Ee,"px")})[Te]=0,kt.position="absolute",kt.top=0,kt.transform="translate(".concat(Re,"px, ").concat(le,"px)"),kt)}if(Rt===d.ViewMode.DualPage)return(wt={height:"".concat(pe,"px"),width:"".concat(Ee,"px")})[Te]=0,wt.position="absolute",wt.top=0,wt.transform="translate(".concat(Re,"px, ").concat(Ht===d.ScrollMode.Page?0:Dt.start.top,"px)"),wt;switch(Ht){case d.ScrollMode.Horizontal:return(Vt={height:"100%",width:"".concat(Ee,"px")})[Te]=0,Vt.position="absolute",Vt.top=0,Vt.transform="translateX(".concat(Re,"px)"),Vt;case d.ScrollMode.Page:return(Yt={height:"".concat(pe,"px"),width:"".concat(Ee,"px")})[Te]=0,Yt.position="absolute",Yt.top=0,Yt;case d.ScrollMode.Wrapped:return(he={height:"".concat(pe,"px"),width:"".concat(Ee,"px")})[Te]=0,he.position="absolute",he.top=0,he.transform="translate(".concat(Re,"px, ").concat(Dt.start.top,"px)"),he;case d.ScrollMode.Vertical:default:return(ce={height:"".concat(pe,"px"),width:"100%"})[Te]=0,ce.position="absolute",ce.top=0,ce.transform="translateY(".concat(Dt.start.top,"px)"),ce}})(Ot,D,Z,_t.current,at.current)}),[D,Z]),Ve=n.useCallback((function(Ot,Dt){var Tt=Nt.current,xt=Tt.measurements,Rt=Tt.scrollOffset,Ht=xt[pn(0,N-1,Dt)];if(Ht){var Ut=at.current===d.ScrollMode.Page?{left:Ht.start.left,top:Ht.start.top}:{left:Rt.left*Ot,top:Rt.top*Ot};return Mt(Ut,!1)}return Promise.resolve()}),[]);return n.useEffect((function(){return function(){Zt.disconnect()}}),[]),{boundingClientRect:Ft,isSmoothScrolling:K,startPage:_e,endPage:fe,maxVisbilityIndex:ye,virtualItems:ge,getContainerStyles:je,getItemContainerStyles:Ce,getItemStyles:Le,scrollToItem:ve,scrollToNextItem:xe,scrollToPreviousItem:We,zoom:Ve}},wn=function(o,y,D,N,V,G){var Z=D;switch(!0){case(V===d.ViewMode.DualPageWithCover&&G>=3):case(V===d.ViewMode.DualPage&&G>=3):Z=2*D;break;default:Z=D}switch(N){case d.SpecialZoomLevel.ActualSize:return 1;case d.SpecialZoomLevel.PageFit:return Math.min((o.clientWidth-17)/Z,(o.clientHeight-16)/y);case d.SpecialZoomLevel.PageWidth:return(o.clientWidth-17)/Z}},Ri=function(o){var y,D,N=o.getCurrentPage,V=(y=50,D=n.useRef([]),n.useEffect((function(){return function(){D.current=[]}}),[]),{push:function(J){var K=D.current;K.length+1>y&&K.shift(),K.push(J),D.current=K},map:function(J){return D.current.map((function(K){return J(K)}))},pop:function(){var J=D.current;if(J.length===0)return null;var K=J.pop();return D.current=J,K}}),G=(function(J){var K=n.useRef([]);return n.useEffect((function(){return function(){K.current=[]}}),[]),{dequeue:function(){var lt=K.current;if(lt.length===0)return null;var ot=lt.shift();return K.current=lt,ot||null},enqueue:function(lt){var ot=K.current;ot.length+1>J&&ot.pop(),K.current=[lt].concat(ot)},map:function(lt){return K.current.map((function(ot){return lt(ot)}))}}})(50),Z=function(){var J=G.dequeue();return J&&V.push(J),J&&J.pageIndex===N()?Z():J},Y=function(){var J=V.pop();return J&&G.enqueue(J),J&&J.pageIndex===N()?Y():J},B=n.useCallback((function(J){V.push(J)}),[]);return{getNextDestination:Z,getPreviousDestination:Y,markVisitedDestination:B}},jn=function(o){var y=[];return o.map((function(D){y=y.concat(D).concat((function(N){var V=[];return N.items&&N.items.length>0&&(V=V.concat(jn(N.items))),V})(D))})),y},Hn={capture:!1,passive:!0},xi={height:0,width:0},Cn={height:0,width:0},ki=function(o){var y=o.getCurrentPage,D=o.getCurrentScrollMode,N=o.jumpToPage,V=o.targetRef,G=n.useState(d.FullScreenMode.Normal),Z=G[0],Y=G[1],B=(function(){var It=n.useState(xi),te=It[0],Zt=It[1],ee=vt((function(){Zt({height:window.innerHeight,width:window.innerWidth})}),100);return e((function(){return window.addEventListener("resize",ee,Hn),function(){window.removeEventListener("resize",ee,Hn)}}),[]),te})(),J=n.useState(Cn),K=J[0],lt=J[1],ot=n.useRef(Cn),at=n.useRef(y()),_t=n.useRef(Cn),mt=n.useState(V.current),pt=mt[0],Gt=mt[1],Mt=n.useRef();e((function(){V.current!==pt&&Gt(V.current)}),[]),e((function(){if(pt){var It=new ResizeObserver((function(te){te.forEach((function(Zt){var ee=Zt.target.getBoundingClientRect(),ie=ee.height,se=ee.width;lt({height:ie,width:se})}))}));return It.observe(pt),function(){It.unobserve(pt),It.disconnect()}}}),[pt]);var Ft=n.useCallback((function(It){var te=dt();return te&&te!==It?(Y(d.FullScreenMode.Normal),yt(te)):Promise.resolve()}),[]),Nt=n.useCallback((function(It){It&&nt()&&(Gt(It),Ft(It).then((function(){Mt.current=It,Y(d.FullScreenMode.Entering),(function(te){j&&te[tt.RequestFullScreen]()})(It)})))}),[]),Pt=n.useCallback((function(){dt()&&(Y(d.FullScreenMode.Exitting),yt(document))}),[]),jt=n.useCallback((function(){pt&&dt()!==pt&&Y(d.FullScreenMode.Exitting)}),[pt]);return n.useEffect((function(){switch(Z){case d.FullScreenMode.Entering:Mt.current&&(Mt.current.style.backgroundColor="var(--rpv-core__full-screen-target-background-color)"),at.current=y(),ot.current={height:window.innerHeight,width:window.innerWidth};break;case d.FullScreenMode.Entered:D()===d.ScrollMode.Page?N(at.current).then((function(){Y(d.FullScreenMode.EnteredCompletely)})):Y(d.FullScreenMode.EnteredCompletely);break;case d.FullScreenMode.Exitting:Mt.current&&(Mt.current.style.backgroundColor="",Mt.current=null),at.current=y();break;case d.FullScreenMode.Exited:Y(d.FullScreenMode.Normal),D()===d.ScrollMode.Page&&N(at.current)}}),[Z]),n.useEffect((function(){if(Z!==d.FullScreenMode.Normal)return Z===d.FullScreenMode.Entering&&B.height===K.height&&B.width===K.width&&B.height>0&&B.width>0&&(_t.current.height===0||B.height==_t.current.height)?(_t.current={height:window.innerHeight,width:window.innerWidth},void Y(d.FullScreenMode.Entered)):void(Z===d.FullScreenMode.Exitting&&ot.current.height===B.height&&ot.current.width===B.width&&B.height>0&&B.width>0&&Y(d.FullScreenMode.Exited))}),[Z,B,K]),n.useEffect((function(){var It;return It=jt,j&&document.addEventListener(tt.FullScreenChange,It),function(){(function(te){j&&document.removeEventListener(tt.FullScreenChange,te)})(jt)}}),[pt]),{enterFullScreenMode:Nt,exitFullScreenMode:Pt,fullScreenMode:Z}},Mi={buildPageStyles:function(){return{}},transformSize:function(o){return o.size}},on={left:0,top:0},Fi=function(o){var y=o.currentFile,D=o.defaultScale,N=o.doc,V=o.enableSmoothScroll,G=o.initialPage,Z=o.initialRotation,Y=o.initialScale,B=o.pageLayout,J=o.pageSizes,K=o.plugins,lt=o.renderPage,ot=o.scrollMode,at=o.setRenderRange,_t=o.viewMode,mt=o.viewerState,pt=o.onDocumentLoad,Gt=o.onOpenFile,Mt=o.onPageChange,Ft=o.onRotate,Nt=o.onRotatePage,Pt=o.onZoom,jt=N.numPages,It=N.loadingTask.docId,te=n.useContext(S).l10n,Zt=n.useContext(h),ee=Zt.direction===d.TextDirection.RightToLeft,ie=n.useRef(),se=n.useRef(),_e=n.useState(G),fe=_e[0],ye=_e[1],ge=n.useRef(null),ve=Ri({getCurrentPage:function(){return qt.current.pageIndex}}),be=n.useState(Z),me=be[0],xe=be[1],We=ct(me),je=n.useState(!1),Ce=je[0],Le=je[1],Ve=n.useState(new Map),Ot=Ve[0],Dt=Ve[1],Tt=n.useState(ot),xt=Tt[0],Rt=Tt[1],Ht=ct(xt),Ut=n.useState(_t),kt=Ut[0],wt=Ut[1],Vt=ct(kt),Yt=(function(ft){var zt=Et(),Kt=n.useState([]),ae=Kt[0],re=Kt[1];return n.useEffect((function(){ft.getOutline().then((function(Jt){if(zt.current&&Jt!==null){var we=jn(Jt);re(we)}}))}),[]),ae})(N),he=n.useState(Y),ce=he[0],Te=he[1],De=ct(ce),qt=n.useRef(mt),Re=n.useRef(typeof D=="string"?D:null),de=n.useRef(-1),pe=n.useRef(-1),Ee=n.useRef(G),le=ki({getCurrentPage:function(){return qt.current.pageIndex},getCurrentScrollMode:function(){return qt.current.scrollMode},jumpToPage:function(ft){return Ke(ft)},targetRef:se}),$e=n.useState(-1),ln=$e[0],_n=$e[1],en=n.useState(0),gn=en[0],Bi=en[1],Ie=f({doc:N});n.useEffect((function(){return function(){Ae.clear(),He.clear()}}),[It]);var Vn=n.useMemo((function(){return Object.assign({},Mi,B)}),[]),ji=n.useMemo((function(){return Array(jt).fill(0).map((function(ft,zt){var Kt=[J[zt].pageHeight,J[zt].pageWidth],ae=Math.abs(me)%180==0?{height:Kt[0],width:Kt[1]}:{height:Kt[1],width:Kt[0]},re={height:ae.height*ce,width:ae.width*ce};return Vn.transformSize({numPages:jt,pageIndex:zt,size:re})}))}),[me,ce]),ue=Ti({enableSmoothScroll:V,isRtl:ee,numberOfItems:jt,parentRef:se,scrollMode:xt,setRenderRange:at,sizes:ji,viewMode:kt}),Hi=vt((function(){!Re.current||qt.current.fullScreenMode!==d.FullScreenMode.Normal||G>0&&Ee.current===G||nn(Re.current)}),200);(function(ft){var zt=ft.targetRef,Kt=ft.onResize;e((function(){var ae=new ResizeObserver((function(Jt){Jt.forEach((function(we){Kt(we.target)}))})),re=zt.current;if(re)return ae.observe(re),function(){ae.unobserve(re)}}),[])})({targetRef:se,onResize:Hi});var Ye=function(ft){var zt=ft;K.forEach((function(Kt){Kt.onViewerStateChange&&(zt=Kt.onViewerStateChange(zt))})),qt.current=zt},Ui=function(){return se.current},Wi=function(){return qt.current},zi=n.useCallback((function(ft){ve.markVisitedDestination(ft)}),[]),Rn=n.useCallback((function(ft){var zt=ft.pageIndex,Kt=ft.bottomOffset,ae=ft.leftOffset,re=ft.scaleTo,Jt=se.current,we=qt.current;return Jt&&we?new Promise((function(Je,Dn){qe(N,zt).then((function(yn){var Ze=yn.getViewport({scale:1}),An=0,Zn=(typeof Kt=="function"?Kt(Ze.width,Ze.height):Kt)||0,Sn=(typeof ae=="function"?ae(Ze.width,Ze.height):ae)||0,cn=we.scale;switch(re){case d.SpecialZoomLevel.PageFit:An=0,Sn=0,nn(d.SpecialZoomLevel.PageFit);break;case d.SpecialZoomLevel.PageWidth:cn=wn(Jt,J[zt].pageHeight,J[zt].pageWidth,d.SpecialZoomLevel.PageWidth,_t,jt),An=(Ze.height-Zn)*cn,Sn*=cn,nn(cn);break;default:An=(Ze.height-Zn)*cn,Sn*=cn}switch(we.scrollMode){case d.ScrollMode.Horizontal:ue.scrollToItem(zt,{left:Sn,top:0}).then((function(){Je()}));break;case d.ScrollMode.Vertical:default:ue.scrollToItem(zt,{left:0,top:An}).then((function(){Je()}))}}))})):Promise.resolve()}),[]),qn=n.useCallback((function(ft){return ve.markVisitedDestination(ft),Rn(ft)}),[]),Vi=n.useCallback((function(){var ft=ve.getNextDestination();return ft?Rn(ft):Promise.resolve()}),[]),qi=n.useCallback((function(){var ft=ve.getPreviousDestination();return ft?Rn(ft):Promise.resolve()}),[]),Gi=n.useCallback((function(){return ue.scrollToNextItem(qt.current.pageIndex,on)}),[]),Ke=n.useCallback((function(ft){return 0<=ft&&ft<jt?ue.scrollToItem(ft,on):Promise.resolve()}),[]),Xi=n.useCallback((function(){return ue.scrollToPreviousItem(qt.current.pageIndex,on)}),[]),Gn=n.useCallback((function(ft){var zt,Kt;(zt=ft.name,Kt=zt.split(/\./).pop(),Kt?Kt.toLowerCase():"").toLowerCase()==="pdf"&&new Promise((function(ae){var re=new FileReader;re.readAsArrayBuffer(ft),re.onload=function(){var Jt=new Uint8Array(re.result);ae(Jt)}})).then((function(ae){Gt(ft.name,ae)}))}),[Gt]),Xn=n.useCallback((function(ft){var zt=ft===d.RotateDirection.Backward?-90:90,Kt=qt.current.rotation,ae=Kt===360||Kt===-360?zt:Kt+zt;Ie.markNotRendered(),xe(ae),Ye(t(t({},qt.current),{rotation:ae})),Ft({direction:ft,doc:N,rotation:ae})}),[]),xn=n.useCallback((function(ft,zt){var Kt=zt===d.RotateDirection.Backward?-90:90,ae=qt.current.pagesRotation,re=(ae.has(ft)?ae.get(ft):Z)+Kt,Jt=ae.set(ft,re);Dt(Jt),Le((function(we){return!we})),Ye(t(t({},qt.current),{pagesRotation:Jt,rotatedPage:ft})),Nt({direction:zt,doc:N,pageIndex:ft,rotation:re}),Ie.markRendering(ft),_n(ft)}),[]),$n=n.useCallback((function(ft){Ye(t(t({},qt.current),{scrollMode:ft})),Rt(ft)}),[]),Yn=n.useCallback((function(ft){Ye(t(t({},qt.current),{viewMode:ft})),wt(ft)}),[]),nn=n.useCallback((function(ft){var zt=se.current,Kt=qt.current.pageIndex;if(!(Kt<0||Kt>=jt)){var ae=J[Kt].pageHeight,re=J[Kt].pageWidth,Jt=zt?typeof ft=="string"?wn(zt,ae,re,ft,qt.current.viewMode,jt):ft:1;Re.current=typeof ft=="string"?ft:null,Jt!==qt.current.scale&&(Bi((function(we){return we+1})),Ie.markNotRendered(),Te(Jt),Pt({doc:N,scale:Jt}),Ye(t(t({},qt.current),{scale:Jt})))}}),[]),$i=n.useCallback((function(ft){le.enterFullScreenMode(ft)}),[]),Yi=n.useCallback((function(){le.exitFullScreenMode()}),[]);n.useEffect((function(){Ye(t(t({},qt.current),{fullScreenMode:le.fullScreenMode}))}),[le.fullScreenMode]),n.useEffect((function(){var ft={enterFullScreenMode:$i,exitFullScreenMode:Yi,getPagesContainer:Ui,getViewerState:Wi,jumpToDestination:qn,jumpToNextDestination:Vi,jumpToPreviousDestination:qi,jumpToNextPage:Gi,jumpToPreviousPage:Xi,jumpToPage:Ke,openFile:Gn,rotate:Xn,rotatePage:xn,setViewerState:Ye,switchScrollMode:$n,switchViewMode:Yn,zoom:nn};return K.forEach((function(zt){zt.install&&zt.install(ft)})),function(){K.forEach((function(zt){zt.uninstall&&zt.uninstall(ft)}))}}),[It]),n.useEffect((function(){pt({doc:N,file:y}),K.forEach((function(ft){ft.onDocumentLoad&&ft.onDocumentLoad({doc:N,file:y})}))}),[It]);var kn,Mn,Fn,Kn=ue.boundingClientRect;kn=function(){G&&Ke(G)},Mn=Kn.height>0&&Kn.width>0,Fn=n.useRef(!1),e((function(){Mn&&!Fn.current&&(Fn.current=!0,kn())}),[kn,Mn]),e((function(){var ft=qt.current.pageIndex;ft>-1&&Ht!==xt&&ue.scrollToItem(ft,on).then((function(){le.fullScreenMode===d.FullScreenMode.EnteredCompletely&&(V||Ie.markNotRendered(),de.current=-1)}))}),[xt]),e((function(){var ft=qt.current.pageIndex;ft>-1&&We!==me&&ue.scrollToItem(ft,on)}),[me]),e((function(){De!=0&&De!=qt.current.scale&&ue.zoom(qt.current.scale/De,qt.current.pageIndex).then((function(){le.fullScreenMode===d.FullScreenMode.EnteredCompletely&&(pe.current=-1)}))}),[ce]),e((function(){if(Vt!==qt.current.viewMode){var ft=ue.startPage,zt=ue.endPage,Kt=ue.virtualItems;Ie.markNotRendered(),Ie.setRange(ft,zt);for(var ae=function(Jt){var we=Kt.find((function(Je){return Je.index===Jt}));we&&Ie.setVisibility(Jt,we.visibility)},re=ft;re<=zt;re++)ae(re);Ln()}}),[kt]),e((function(){var ft=qt.current.pageIndex;ft>-1&&Vt!==kt&&ue.scrollToItem(ft,on)}),[kt]),e((function(){var ft=qt.current.pageIndex;ft>0&&ft===G&&Ee.current===G&&Re.current&&(Ee.current=-1,nn(Re.current))}),[fe]),n.useEffect((function(){ue.isSmoothScrolling||ge.current!==null&&ge.current===fe||(ge.current=fe,Mt({currentPage:fe,doc:N}))}),[fe,ue.isSmoothScrolling]),n.useEffect((function(){le.fullScreenMode===d.FullScreenMode.Entering&&qt.current.scrollMode===d.ScrollMode.Page&&(de.current=qt.current.pageIndex),le.fullScreenMode===d.FullScreenMode.EnteredCompletely&&qt.current.scrollMode===d.ScrollMode.Page&&V&&(de.current=-1),le.fullScreenMode===d.FullScreenMode.EnteredCompletely&&Re.current&&(pe.current=qt.current.pageIndex,nn(Re.current))}),[le.fullScreenMode]),n.useEffect((function(){if(le.fullScreenMode!==d.FullScreenMode.Entering&&le.fullScreenMode!==d.FullScreenMode.Exitting&&!ue.isSmoothScrolling){var ft=ue.startPage,zt=ue.endPage,Kt=ue.maxVisbilityIndex,ae=ue.virtualItems,re=Kt,Jt=le.fullScreenMode===d.FullScreenMode.Entered||le.fullScreenMode===d.FullScreenMode.EnteredCompletely;if(!(Jt&&re!==de.current&&de.current>-1||Jt&&re!==pe.current&&pe.current>-1)){ye(re),Ye(t(t({},qt.current),{pageIndex:re})),Ie.setRange(ft,zt);for(var we=function(Dn){var yn=ae.find((function(Ze){return Ze.index===Dn}));yn&&Ie.setVisibility(Dn,yn.visibility)},Je=ft;Je<=zt;Je++)we(Je);Ln()}}}),[ue.startPage,ue.endPage,ue.isSmoothScrolling,ue.maxVisbilityIndex,le.fullScreenMode,Ce,me,ce]);var Ki=n.useCallback((function(ft){Ie.markRendered(ft),Ln()}),[gn]),Ln=function(){var ft=Ie.getHighestPriorityPage();ft>-1&&Ie.isInRange(ft)&&(Ie.markRendering(ft),_n(ft))},Ji=function(ft){var zt=fe-1,Kt=fe+1;switch(ft){case"FirstPage":Ke(0);break;case"LastPage":Ke(jt-1);break;case"NextPage":Kt<jt&&Ke(Kt);break;case"PrevPage":zt>=0&&Ke(zt)}},Zi=n.useCallback((function(){var ft=ue.virtualItems,zt=[];switch(kt){case d.ViewMode.DualPage:zt=ne(ft,2);break;case d.ViewMode.DualPageWithCover:ft.length&&(zt=ft[0].index===0?[[ft[0]]].concat(ne(ft.slice(1),2)):ne(ft,2));break;case d.ViewMode.SinglePage:default:zt=ne(ft,1)}var Kt=te&&te.core?te.core.pageLabel:"Page {{pageIndex}}",ae={attrs:{className:"rpv-core__inner-container","data-testid":"core__inner-container",ref:ie,style:{height:"100%"}},children:n.createElement(n.Fragment,null),subSlot:{attrs:{"data-testid":"core__inner-pages",className:c({"rpv-core__inner-pages":!0,"rpv-core__inner-pages--horizontal":xt===d.ScrollMode.Horizontal,"rpv-core__inner-pages--rtl":ee,"rpv-core__inner-pages--single":xt===d.ScrollMode.Page,"rpv-core__inner-pages--vertical":xt===d.ScrollMode.Vertical,"rpv-core__inner-pages--wrapped":xt===d.ScrollMode.Wrapped}),ref:se,style:{height:"100%",position:"relative"}},children:n.createElement("div",{"data-testid":"core__inner-current-page-".concat(fe),style:Object.assign({"--scale-factor":ce},ue.getContainerStyles())},zt.map((function(re){return n.createElement("div",{className:c({"rpv-core__inner-page-container":!0,"rpv-core__inner-page-container--single":xt===d.ScrollMode.Page}),style:ue.getItemContainerStyles(re[0]),key:"".concat(re[0].index,"-").concat(kt)},re.map((function(Jt){var we=kt===d.ViewMode.DualPageWithCover&&(Jt.index===0||jt%2==0&&Jt.index===jt-1);return n.createElement("div",{"aria-label":Kt.replace("{{pageIndex}}","".concat(Jt.index+1)),className:c({"rpv-core__inner-page":!0,"rpv-core__inner-page--dual-even":kt===d.ViewMode.DualPage&&Jt.index%2==0,"rpv-core__inner-page--dual-odd":kt===d.ViewMode.DualPage&&Jt.index%2==1,"rpv-core__inner-page--dual-cover":we,"rpv-core__inner-page--dual-cover-even":kt===d.ViewMode.DualPageWithCover&&!we&&Jt.index%2==0,"rpv-core__inner-page--dual-cover-odd":kt===d.ViewMode.DualPageWithCover&&!we&&Jt.index%2==1,"rpv-core__inner-page--single":kt===d.ViewMode.SinglePage&&xt===d.ScrollMode.Page}),role:"region",key:"".concat(Jt.index,"-").concat(kt),style:Object.assign({},ue.getItemStyles(Jt),Vn.buildPageStyles({numPages:jt,pageIndex:Jt.index,scrollMode:xt,viewMode:kt}))},n.createElement(vi,{doc:N,measureRef:Jt.measureRef,outlines:Yt,pageIndex:Jt.index,pageRotation:Ot.has(Jt.index)?Ot.get(Jt.index):0,pageSize:J[Jt.index],plugins:K,renderPage:lt,renderQueueKey:gn,rotation:me,scale:ce,shouldRender:ln===Jt.index,viewMode:kt,onExecuteNamedAction:Ji,onJumpFromLinkAnnotation:zi,onJumpToDest:qn,onRenderCompleted:Ki,onRotatePage:xn}))})))})))}};return K.forEach((function(re){re.renderViewer&&(ae=re.renderViewer({containerRef:ie,doc:N,pagesContainerRef:se,pagesRotation:Ot,pageSizes:J,rotation:me,slot:ae,themeContext:Zt,jumpToPage:Ke,openFile:Gn,rotate:Xn,rotatePage:xn,switchScrollMode:$n,switchViewMode:Yn,zoom:nn}))})),ae}),[K,ue]),Jn=n.useCallback((function(ft){return n.createElement("div",t({},ft.attrs,{style:ft.attrs&&ft.attrs.style?ft.attrs.style:{}}),ft.children,ft.subSlot&&Jn(ft.subSlot))}),[]);return Jn(Zi())},Un=[.1,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.3,1.5,1.7,1.9,2.1,2.4,2.7,3,3.3,3.7,4.1,4.6,5.1,5.7,6.3,7,7.7,8.5,9.4,10],Li=function(o){var y=o.defaultScale,D=o.doc,N=o.render,V=o.scrollMode,G=o.viewMode,Z=n.useRef(),Y=n.useState({pageSizes:[],scale:0}),B=Y[0],J=Y[1];return n.useLayoutEffect((function(){var K=Array(D.numPages).fill(0).map((function(lt,ot){return new Promise((function(at,_t){qe(D,ot).then((function(mt){var pt=mt.getViewport({scale:1});at({pageHeight:pt.height,pageWidth:pt.width,rotation:pt.rotation})}))}))}));Promise.all(K).then((function(lt){var ot=Z.current;if(ot&&lt.length!==0){var at=lt[0].pageWidth,_t=lt[0].pageHeight,mt=ot.parentElement,pt=(mt.clientWidth-45)/at,Gt=(mt.clientHeight-45)/_t,Mt=pt;switch(V){case d.ScrollMode.Horizontal:Mt=Math.min(pt,Gt);break;case d.ScrollMode.Vertical:default:Mt=pt}var Ft,Nt,Pt=y?typeof y=="string"?wn(mt,_t,at,y,G,D.numPages):y:(Ft=Mt,(Nt=Un.findIndex((function(jt){return jt>=Ft})))===-1||Nt===0?Ft:Un[Nt-1]);J({pageSizes:lt,scale:Pt})}}))}),[D.loadingTask.docId]),B.pageSizes.length===0||B.scale===0?n.createElement("div",{className:"rpv-core__page-size-calculator","data-testid":"core__page-size-calculating",ref:Z},n.createElement(M,null)):N(B.pageSizes,B.scale)},bn=function(){},Pn=(function(o){function y(D,N){var V=o.call(this)||this;return V.verifyPassword=D,V.passwordStatus=N,V}return W(y,o),y})(bn),Di=function(o){var y=o.passwordStatus,D=o.renderProtectedView,N=o.verifyPassword,V=o.onDocumentAskPassword,G=n.useContext(S).l10n,Z=n.useState(""),Y=Z[0],B=Z[1],J=n.useContext(h).direction===d.TextDirection.RightToLeft,K=function(){return N(Y)};return n.useEffect((function(){V&&V({verifyPassword:N})}),[]),D?D({passwordStatus:y,verifyPassword:N}):n.createElement("div",{className:"rpv-core__asking-password-wrapper"},n.createElement("div",{className:c({"rpv-core__asking-password":!0,"rpv-core__asking-password--rtl":J})},n.createElement("div",{className:"rpv-core__asking-password-message"},y===d.PasswordStatus.RequiredPassword&&G.core.askingPassword.requirePasswordToOpen,y===d.PasswordStatus.WrongPassword&&G.core.wrongPassword.tryAgain),n.createElement("div",{className:"rpv-core__asking-password-body"},n.createElement("div",{className:c({"rpv-core__asking-password-input":!0,"rpv-core__asking-password-input--ltr":!J,"rpv-core__asking-password-input--rtl":J})},n.createElement(R,{testId:"core__asking-password-input",type:"password",value:Y,onChange:B,onKeyDown:function(lt){lt.key==="Enter"&&K()}})),n.createElement(w,{onClick:K},G.core.askingPassword.submit))))},Wn=(function(o){function y(D){var N=o.call(this)||this;return N.doc=D,N}return W(y,o),y})(bn),zn=(function(o){function y(D){var N=o.call(this)||this;return N.error=D,N}return W(y,o),y})(bn),Tn=(function(o){function y(D){var N=o.call(this)||this;return N.percentages=D,N}return W(y,o),y})(bn),Ii=function(o){var y=o.characterMap,D=o.file,N=o.httpHeaders,V=o.render,G=o.renderError,Z=o.renderLoader,Y=o.renderProtectedView,B=o.transformGetDocumentParams,J=o.withCredentials,K=o.onDocumentAskPassword,lt=n.useContext(h).direction===d.TextDirection.RightToLeft,ot=n.useState(new Tn(0)),at=ot[0],_t=ot[1],mt=n.useRef(""),pt=Et();return n.useEffect((function(){mt.current="",_t(new Tn(0));var Gt=new x.PDFWorker({name:"PDFWorker_".concat(Date.now())}),Mt=Object.assign({httpHeaders:N,withCredentials:J,worker:Gt},typeof D=="string"?{url:D}:{data:D},y?{cMapUrl:y.url,cMapPacked:y.isCompressed}:{}),Ft=B?B(Mt):Mt,Nt=x.getDocument(Ft);return Nt.onPassword=function(Pt,jt){switch(jt){case x.PasswordResponses.NEED_PASSWORD:pt.current&&_t(new Pn(Pt,d.PasswordStatus.RequiredPassword));break;case x.PasswordResponses.INCORRECT_PASSWORD:pt.current&&_t(new Pn(Pt,d.PasswordStatus.WrongPassword))}},Nt.onProgress=function(Pt){var jt=Pt.total>0?Math.min(100,100*Pt.loaded/Pt.total):100;pt.current&&mt.current===""&&_t(new Tn(jt))},Nt.promise.then((function(Pt){mt.current=Pt.loadingTask.docId,pt.current&&_t(new Wn(Pt))}),(function(Pt){return pt.current&&!Gt.destroyed&&_t(new zn({message:Pt.message||"Cannot load document",name:Pt.name}))})),function(){Nt.destroy(),Gt.destroy()}}),[D]),at instanceof Pn?n.createElement(Di,{passwordStatus:at.passwordStatus,renderProtectedView:Y,verifyPassword:at.verifyPassword,onDocumentAskPassword:K}):at instanceof Wn?V(at.doc):at instanceof zn?G?G(at.error):n.createElement("div",{className:c({"rpv-core__doc-error":!0,"rpv-core__doc-error--rtl":lt})},n.createElement("div",{className:"rpv-core__doc-error-text"},at.error.message)):n.createElement("div",{"data-testid":"core__doc-loading",className:c({"rpv-core__doc-loading":!0,"rpv-core__doc-loading--rtl":lt})},Z?Z(at.percentages):n.createElement(M,null))},Oi=function(o,y){var D=n.useMemo((function(){return o==="auto"?typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":o}),[]),N=n.useState(D),V=N[0],G=N[1],Z=ct(V);return n.useEffect((function(){if(o==="auto"){var Y=window.matchMedia("(prefers-color-scheme: dark)"),B=function(J){G(J.matches?"dark":"light")};return Y.addEventListener("change",B),function(){return Y.removeEventListener("change",B)}}}),[]),n.useEffect((function(){V!==Z&&y&&y(V)}),[V]),n.useEffect((function(){o!==V&&G(o)}),[o]),{currentTheme:V,setCurrentTheme:G}},Ni=function(o){return{startPage:o.startPage-3,endPage:o.endPage+3}};d.Button=function(o){var y=o.children,D=o.testId,N=o.onClick,V=n.useContext(h).direction===d.TextDirection.RightToLeft,G=D?{"data-testid":D}:{};return n.createElement("button",t({className:c({"rpv-core__button":!0,"rpv-core__button--rtl":V}),type:"button",onClick:N},G),y)},d.Icon=v,d.LazyRender=function(o){var y=o.attrs,D=o.children,N=o.testId,V=n.useState(!1),G=V[0],Z=V[1],Y=N?t(t({},y),{"data-testid":N}):y,B=g({once:!0,onVisibilityChanged:function(J){J.isVisible&&Z(!0)}});return n.createElement("div",t({ref:B},Y),G&&D)},d.LocalizationContext=S,d.Menu=function(o){var y=o.children,D=n.useRef(),N=n.useRef([]),V=n.useContext(h).direction===d.TextDirection.RightToLeft,G=function(Y){if(D.current)switch(Y.key){case"Tab":Y.preventDefault();break;case"ArrowDown":Y.preventDefault(),Z((function(B,J){return J+1}));break;case"ArrowUp":Y.preventDefault(),Z((function(B,J){return J-1}));break;case"End":Y.preventDefault(),Z((function(B,J){return B.length-1}));break;case"Home":Y.preventDefault(),Z((function(B,J){return 0}))}},Z=function(Y){if(D.current){var B=N.current,J=B.findIndex((function(lt){return lt.getAttribute("tabindex")==="0"})),K=Math.min(B.length-1,Math.max(0,Y(B,J)));J>=0&&J<=B.length-1&&B[J].setAttribute("tabindex","-1"),B[K].setAttribute("tabindex","0"),B[K].focus()}};return e((function(){var Y=D.current;if(Y){var B=(function(J){var K=[];return J.querySelectorAll('.rpv-core__menu-item[role="menuitem"]').forEach((function(lt){if(lt instanceof HTMLElement){var ot=lt.parentElement;(ot===J||window.getComputedStyle(ot).display!=="none")&&K.push(lt)}})),K})(Y);N.current=B}}),[]),e((function(){return document.addEventListener("keydown",G),function(){document.removeEventListener("keydown",G)}}),[]),n.createElement("div",{ref:D,"aria-orientation":"vertical",className:c({"rpv-core__menu":!0,"rpv-core__menu--rtl":V}),role:"menu",tabIndex:0},y)},d.MenuDivider=function(){return n.createElement("div",{"aria-orientation":"horizontal",className:"rpv-core__menu-divider",role:"separator"})},d.MenuItem=function(o){var y=o.checked,D=y!==void 0&&y,N=o.children,V=o.icon,G=V===void 0?null:V,Z=o.isDisabled,Y=Z!==void 0&&Z,B=o.testId,J=o.onClick,K=n.useContext(h).direction===d.TextDirection.RightToLeft,lt=B?{"data-testid":B}:{};return n.createElement("button",t({className:c({"rpv-core__menu-item":!0,"rpv-core__menu-item--disabled":Y,"rpv-core__menu-item--ltr":!K,"rpv-core__menu-item--rtl":K}),role:"menuitem",tabIndex:-1,type:"button",onClick:J},lt),n.createElement("div",{className:c({"rpv-core__menu-item-icon":!0,"rpv-core__menu-item-icon--ltr":!K,"rpv-core__menu-item-icon--rtl":K})},G),n.createElement("div",{className:c({"rpv-core__menu-item-label":!0,"rpv-core__menu-item-label--ltr":!K,"rpv-core__menu-item-label--rtl":K})},N),n.createElement("div",{className:c({"rpv-core__menu-item-check":!0,"rpv-core__menu-item-check--ltr":!K,"rpv-core__menu-item-check--rtl":K})},D&&n.createElement(l,null)))},d.MinimalButton=function(o){var y=o.ariaLabel,D=y===void 0?"":y,N=o.ariaKeyShortcuts,V=N===void 0?"":N,G=o.children,Z=o.isDisabled,Y=Z!==void 0&&Z,B=o.isSelected,J=B!==void 0&&B,K=o.testId,lt=o.onClick,ot=n.useContext(h).direction===d.TextDirection.RightToLeft,at=K?{"data-testid":K}:{};return n.createElement("button",t({"aria-label":D},V&&{"aria-keyshortcuts":V},Y&&{"aria-disabled":!0},{className:c({"rpv-core__minimal-button":!0,"rpv-core__minimal-button--disabled":Y,"rpv-core__minimal-button--rtl":ot,"rpv-core__minimal-button--selected":J}),type:"button",onClick:lt},at),G)},d.Modal=function(o){var y=o.ariaControlsSuffix,D=o.closeOnClickOutside,N=o.closeOnEscape,V=o.content,G=o.isOpened,Z=G!==void 0&&G,Y=o.target,B=y||"".concat(F());return n.createElement(k,{target:Y?function(J,K){return n.createElement("div",{"aria-expanded":K?"true":"false","aria-haspopup":"dialog","aria-controls":"rpv-core__modal-body-".concat(B)},Y(J,K))}:null,content:function(J){return n.createElement(_,null,n.createElement(s,{ariaControlsSuffix:B,closeOnClickOutside:D,closeOnEscape:N,onToggle:J},V(J)))},isOpened:Z})},d.Popover=function(o){var y=o.ariaHasPopup,D=y===void 0?"dialog":y,N=o.ariaControlsSuffix,V=o.closeOnClickOutside,G=o.closeOnEscape,Z=o.content,Y=o.lockScroll,B=Y===void 0||Y,J=o.offset,K=o.position,lt=o.target,ot=P(!1),at=ot.opened,_t=ot.toggle,mt=n.useRef(),pt=n.useMemo((function(){return N||"".concat(F())}),[]);return n.createElement("div",{ref:mt,"aria-expanded":at?"true":"false","aria-haspopup":D,"aria-controls":"rpv-core__popver-body-".concat(pt)},lt(_t,at),at&&n.createElement(n.Fragment,null,B&&n.createElement(Bt,{closeOnEscape:G,onClose:_t}),n.createElement(Lt,{ariaControlsSuffix:pt,closeOnClickOutside:V,offset:J,position:K,targetRef:mt,onClose:_t},Z(_t))))},d.PrimaryButton=w,d.ProgressBar=function(o){var y=o.progress,D=n.useContext(h).direction===d.TextDirection.RightToLeft;return n.createElement("div",{className:c({"rpv-core__progress-bar":!0,"rpv-core__progress-bar--rtl":D})},n.createElement("div",{className:"rpv-core__progress-bar-progress",style:{width:"".concat(y,"%")}},y,"%"))},d.Separator=function(){return n.createElement("div",{className:"rpv-core__separator"})},d.Spinner=M,d.Splitter=function(o){var y=o.constrain,D=n.useContext(h).direction===d.TextDirection.RightToLeft,N=n.useRef(),V=n.useRef(),G=n.useRef(),Z=n.useRef(0),Y=n.useRef(0),B=n.useRef(0),J=n.useRef(0),K={capture:!0},lt=function(at){var _t=N.current,mt=V.current,pt=G.current;if(_t&&mt&&pt){var Gt=J.current,Mt=at.clientX-Z.current,Ft=B.current+(D?-Mt:Mt),Nt=_t.parentElement.getBoundingClientRect().width,Pt=100*Ft/Nt;if(_t.classList.add("rpv-core__splitter--resizing"),y){var jt=Nt-Ft-Gt;if(!y({firstHalfPercentage:Pt,firstHalfSize:Ft,secondHalfPercentage:100*jt/Nt,secondHalfSize:jt}))return}mt.style.width="".concat(Pt,"%"),document.body.classList.add("rpv-core__splitter-body--resizing"),mt.classList.add("rpv-core__splitter-sibling--resizing"),pt.classList.add("rpv-core__splitter-sibling--resizing")}},ot=function(at){var _t=N.current,mt=V.current,pt=G.current;_t&&mt&&pt&&(document.body.classList.remove("rpv-core__splitter-body--resizing"),_t.classList.remove("rpv-core__splitter--resizing"),mt.classList.remove("rpv-core__splitter-sibling--resizing"),pt.classList.remove("rpv-core__splitter-sibling--resizing"),document.removeEventListener("mousemove",lt,K),document.removeEventListener("mouseup",ot,K))};return n.useEffect((function(){var at=N.current;at&&(J.current=at.getBoundingClientRect().width,V.current=at.previousElementSibling,G.current=at.nextElementSibling)}),[]),n.createElement("div",{ref:N,className:"rpv-core__splitter",onMouseDown:function(at){var _t=V.current;_t&&(Z.current=at.clientX,Y.current=at.clientY,B.current=_t.getBoundingClientRect().width,document.addEventListener("mousemove",lt,K),document.addEventListener("mouseup",ot,K))}})},d.TextBox=R,d.ThemeContext=h,d.Tooltip=function(o){var y=o.ariaControlsSuffix,D=o.content,N=o.offset,V=o.position,G=o.target,Z=P(!1),Y=Z.opened,B=Z.toggle,J=n.useRef(),K=n.useRef(),lt=n.useMemo((function(){return y||"".concat(F())}),[]);T((function(){J.current&&document.activeElement&&J.current.contains(document.activeElement)&&at()}));var ot=function(){B(d.ToggleStatus.Open)},at=function(){B(d.ToggleStatus.Close)};return n.createElement(n.Fragment,null,n.createElement("div",{ref:J,"aria-describedby":"rpv-core__tooltip-body-".concat(lt),onBlur:function(_t){_t.relatedTarget instanceof HTMLElement&&_t.currentTarget.parentElement&&_t.currentTarget.parentElement.contains(_t.relatedTarget)?K.current&&(K.current.style.display="none"):at()},onFocus:ot,onMouseEnter:ot,onMouseLeave:at},G),Y&&n.createElement(Xt,{ariaControlsSuffix:lt,contentRef:K,offset:N,position:V,targetRef:J},D()))},d.Viewer=function(o){var y=o.characterMap,D=o.defaultScale,N=o.enableSmoothScroll,V=N===void 0||N,G=o.fileUrl,Z=o.httpHeaders,Y=Z===void 0?{}:Z,B=o.initialPage,J=B===void 0?0:B,K=o.pageLayout,lt=o.initialRotation,ot=lt===void 0?0:lt,at=o.localization,_t=o.plugins,mt=_t===void 0?[]:_t,pt=o.renderError,Gt=o.renderLoader,Mt=o.renderPage,Ft=o.renderProtectedView,Nt=o.scrollMode,Pt=Nt===void 0?d.ScrollMode.Vertical:Nt,jt=o.setRenderRange,It=jt===void 0?Ni:jt,te=o.transformGetDocumentParams,Zt=o.theme,ee=Zt===void 0?{direction:d.TextDirection.LeftToRight,theme:"light"}:Zt,ie=o.viewMode,se=ie===void 0?d.ViewMode.SinglePage:ie,_e=o.withCredentials,fe=_e!==void 0&&_e,ye=o.onDocumentAskPassword,ge=o.onDocumentLoad,ve=ge===void 0?function(){}:ge,be=o.onPageChange,me=be===void 0?function(){}:be,xe=o.onRotate,We=xe===void 0?function(){}:xe,je=o.onRotatePage,Ce=je===void 0?function(){}:je,Le=o.onSwitchTheme,Ve=Le===void 0?function(){}:Le,Ot=o.onZoom,Dt=Ot===void 0?function(){}:Ot,Tt=n.useState({data:G,name:typeof G=="string"?G:"",shouldLoad:!1}),xt=Tt[0],Rt=Tt[1],Ht=function(de,pe){Rt({data:pe,name:de,shouldLoad:!0})},Ut=n.useState(!1),kt=Ut[0],wt=Ut[1],Vt=ct(xt);n.useEffect((function(){var de,pe,Ee,le;de=Vt.data,le=typeof(pe=G),(Ee=typeof de)=="string"&&le==="string"&&de===pe||Ee==="object"&&le==="object"&&de.length===pe.length&&de.every((function($e,ln){return $e===pe[ln]}))||Rt({data:G,name:typeof G=="string"?G:"",shouldLoad:kt})}),[G,kt]);var Yt=g({onVisibilityChanged:function(de){wt(de.isVisible),de.isVisible&&Rt((function(pe){return Object.assign({},pe,{shouldLoad:!0})}))}}),he=typeof ee=="string"?{direction:d.TextDirection.LeftToRight,theme:ee}:ee,ce=n.useState(at||p),Te=ce[0],De=ce[1],qt={l10n:Te,setL10n:De},Re=Object.assign({},{direction:he.direction},Oi(he.theme||"light",Ve));return n.useEffect((function(){at&&De(at)}),[at]),n.createElement(S.Provider,{value:qt},n.createElement(h.Provider,{value:Re},n.createElement("div",{ref:Yt,className:"rpv-core__viewer rpv-core__viewer--".concat(Re.currentTheme),"data-testid":"core__viewer",style:{height:"100%",width:"100%"}},xt.shouldLoad&&n.createElement(Ii,{characterMap:y,file:xt.data,httpHeaders:Y,render:function(de){return n.createElement(Li,{defaultScale:D,doc:de,render:function(pe,Ee){return n.createElement(Fi,{currentFile:{data:xt.data,name:xt.name},defaultScale:D,doc:de,enableSmoothScroll:V,initialPage:J,initialRotation:ot,initialScale:Ee,pageLayout:K,pageSizes:pe,plugins:mt,renderPage:Mt,scrollMode:Pt,setRenderRange:It,viewMode:se,viewerState:{file:xt,fullScreenMode:d.FullScreenMode.Normal,pageIndex:-1,pageHeight:pe[0].pageHeight,pageWidth:pe[0].pageWidth,pagesRotation:new Map,rotation:ot,scale:Ee,scrollMode:Pt,viewMode:se},onDocumentLoad:ve,onOpenFile:Ht,onPageChange:me,onRotate:We,onRotatePage:Ce,onZoom:Dt})},scrollMode:Pt,viewMode:se})},renderError:pt,renderLoader:Gt,renderProtectedView:Ft,transformGetDocumentParams:te,withCredentials:fe,onDocumentAskPassword:ye}))))},d.Worker=function(o){var y=o.children,D=o.workerUrl;return x.GlobalWorkerOptions.workerSrc=D,n.createElement(n.Fragment,null,y)},d.chunk=ne,d.classNames=c,d.createStore=function(o){var y=o||{},D={},N=function(G,Z){var Y;y=t(t({},y),((Y={})[G]=Z,Y)),(D[G]||[]).forEach((function(B){return B(y[G])}))},V=function(G){return y[G]};return{subscribe:function(G,Z){D[G]=(D[G]||[]).concat(Z)},unsubscribe:function(G,Z){D[G]=(D[G]||[]).filter((function(Y){return Y!==Z}))},update:function(G,Z){N(G,Z)},updateCurrentValue:function(G,Z){var Y=V(G);Y!==void 0&&N(G,Z(Y))},get:function(G){return V(G)}}},d.getDestination=un,d.getPage=qe,d.isFullScreenEnabled=nt,d.isMac=function(){return typeof window<"u"&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)},d.useDebounceCallback=vt,d.useIntersectionObserver=g,d.useIsMounted=Et,d.useIsomorphicLayoutEffect=e,d.usePrevious=ct,d.useRenderQueue=f})(core_min)),core_min}var hasRequiredLib;function requireLib(){if(hasRequiredLib)return lib.exports;hasRequiredLib=1;/**
 * A React component to view a PDF document
 *
 * @see https://react-pdf-viewer.dev
 * @license https://react-pdf-viewer.dev/license
 * @copyright 2019-2023 Nguyen Huu Phuoc <me@phuoc.ng>
 */return lib.exports=requireCore_min(),lib.exports}var libExports=requireLib();function PDFViewer({fileUrl:d,isRtl:a=!0}){const[I,u]=reactExports.useState(1),[b,n]=reactExports.useState(1),[x,z]=reactExports.useState(0),W=()=>{const r=document.createElement("a");r.href=d,r.download="document.pdf",r.click()};return jsxRuntimeExports.jsxs("div",{dir:a?"rtl":"ltr",className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap gap-2 justify-between items-center bg-white p-2 rounded shadow",children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>u(r=>Math.max(r-1,1)),disabled:I<=1,className:"text-gray-700 hover:text-blue-600",children:jsxRuntimeExports.jsx(ChevronRight,{})}),jsxRuntimeExports.jsx("span",{className:"text-sm px-2",children:a?`الصفحة ${I}`:`Page ${I}`}),jsxRuntimeExports.jsx("button",{onClick:()=>u(r=>r+1),className:"text-gray-700 hover:text-blue-600",children:jsxRuntimeExports.jsx(ChevronLeft,{})})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>n(r=>Math.min(r+.25,3)),className:"text-gray-700 hover:text-green-600",children:jsxRuntimeExports.jsx(ZoomIn,{})}),jsxRuntimeExports.jsx("button",{onClick:()=>n(r=>Math.max(r-.25,.5)),className:"text-gray-700 hover:text-red-600",children:jsxRuntimeExports.jsx(ZoomOut,{})}),jsxRuntimeExports.jsx("button",{onClick:()=>z(r=>(r+90)%360),className:"text-gray-700 hover:text-purple-600",children:jsxRuntimeExports.jsx(RotateCw,{})}),jsxRuntimeExports.jsx("button",{onClick:W,className:"text-gray-700 hover:text-blue-600",children:jsxRuntimeExports.jsx(Download,{})})]})]}),jsxRuntimeExports.jsx("div",{className:"bg-white p-4 border rounded shadow-md overflow-auto",children:jsxRuntimeExports.jsx(libExports.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js",children:jsxRuntimeExports.jsx(libExports.Viewer,{fileUrl:d,defaultScale:b,rotation:x})})})]})}const PDFViewer$1=Object.freeze(Object.defineProperty({__proto__:null,default:PDFViewer},Symbol.toStringTag,{value:"Module"}));export{PDFViewer$1 as P,jsxRuntimeExports as j};
