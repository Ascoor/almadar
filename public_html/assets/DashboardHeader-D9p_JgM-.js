import{j as u}from"./pdf-_01J5l0m.js";import{a as h,B as Y,h as v,S as Z,i as ee,j as te}from"./react-DxiZ5OBW.js";import{j as ne,m as se,k as re,l as ie,n as L,A as ae,f as oe,o as le,L as ce,t as U,c as ue,p as de,a as X,B as H}from"./index-C9wc903-.js";import"./vendor-CTvvdsW_.js";const pe=async t=>{try{const s=await ne.put(`/api/notifications/${t}/read`);return console.log("Marked as read:",s.data),s.data}catch(s){throw console.error("Error marking notification as read:",s),s}};function V({onClick:t,active:s,children:c,className:e="",...r}){return u.jsx(se.button,{whileHover:{scale:1.1},whileTap:{scale:.95},transition:{type:"spring",stiffness:300},onClick:t,...r,className:re(`relative inline-flex items-center justify-center p-2 rounded-full
        transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2
        bg-secondary text-fg hover:brightness-110 hover:shadow-glow shadow-md`,s&&"ring-2 ring-ring",e),children:c})}function fe(){const{notifications:t,hasNew:s,markRead:c,markAllAsRead:e}=ie(),[r,n]=h.useState(!1),a=h.useRef(null),i=o=>{a.current&&!a.current.contains(o.target)&&n(!1)};h.useEffect(()=>(r&&document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)),[r]);const l=async o=>{await pe(o.id),c(o.id),n(!1)};return u.jsxs("div",{className:"relative",dir:"rtl",ref:a,children:[u.jsxs(V,{onClick:()=>n(o=>!o),active:r,children:[u.jsx(Y,{className:"w-6 h-6"}),s&&u.jsx("span",{className:"absolute top-0 left-0 w-2.5 h-2.5 bg-red-500 rounded-full animate-ping"})]}),r&&u.jsxs("div",{className:`
      sm:absolute fixed sm:left-0 top-[72px] left-1/2 transform -translate-x-1/2
      z-50 w-[90vw] max-w-sm sm:w-80 mt-2
      bg-card rounded-xl shadow-lg ring-1 ring-ring
    `,children:[u.jsxs("div",{className:"flex justify-between px-4 py-3 border-b border-border",children:[u.jsx("span",{className:"text-sm font-semibold text-fg",children:"الإشعارات"}),t.length>0&&u.jsx("button",{className:"text-xs text-accent hover:text-",onClick:e,children:"تعيين الكل كمقروء"})]}),u.jsx("ul",{className:"max-h-80 overflow-y-auto divide-y divide-border",children:t.length===0?u.jsx("li",{className:"p-4 text-center text-sm text-muted",children:"لا توجد إشعارات"}):t.map(o=>u.jsxs("li",{onClick:()=>l(o),className:`p-4 cursor-pointer transition hover:bg-muted ${o.read?"":"bg-primary/10"}`,children:[u.jsxs("div",{className:"text-sm font-medium text-fg",children:[o.icon," ",o.title]}),u.jsx("div",{className:"text-xs text-muted",children:o.message}),u.jsx("div",{className:"mt-1 text-xs text-muted",children:new Intl.DateTimeFormat("ar-EG",{dateStyle:"short",timeStyle:"short"}).format(new Date(o.created_at))})]},o.id))})]})]})}function D(){return D=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var c=arguments[s];for(var e in c)({}).hasOwnProperty.call(c,e)&&(t[e]=c[e])}return t},D.apply(null,arguments)}function W(t,s){if(t==null)return{};var c={};for(var e in t)if({}.hasOwnProperty.call(t,e)){if(s.indexOf(e)!==-1)continue;c[e]=t[e]}return c}function A(t,s){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,e){return c.__proto__=e,c},A(t,s)}function q(t,s){t.prototype=Object.create(s.prototype),t.prototype.constructor=t,A(t,s)}function he(t,s){return t.classList?!!s&&t.classList.contains(s):(" "+(t.className.baseVal||t.className)+" ").indexOf(" "+s+" ")!==-1}function xe(t,s){t.classList?t.classList.add(s):he(t,s)||(typeof t.className=="string"?t.className=t.className+" "+s:t.setAttribute("class",(t.className&&t.className.baseVal||"")+" "+s))}function G(t,s){return t.replace(new RegExp("(^|\\s)"+s+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function me(t,s){t.classList?t.classList.remove(s):typeof t.className=="string"?t.className=G(t.className,s):t.setAttribute("class",G(t.className&&t.className.baseVal||"",s))}const z={disabled:!1},J=v.createContext(null);var K=function(s){return s.scrollTop},k="unmounted",C="exited",N="entering",j="entered",_="exiting",E=(function(t){q(s,t);function s(e,r){var n;n=t.call(this,e,r)||this;var a=r,i=a&&!a.isMounting?e.enter:e.appear,l;return n.appearStatus=null,e.in?i?(l=C,n.appearStatus=N):l=j:e.unmountOnExit||e.mountOnEnter?l=k:l=C,n.state={status:l},n.nextCallback=null,n}s.getDerivedStateFromProps=function(r,n){var a=r.in;return a&&n.status===k?{status:C}:null};var c=s.prototype;return c.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},c.componentDidUpdate=function(r){var n=null;if(r!==this.props){var a=this.state.status;this.props.in?a!==N&&a!==j&&(n=N):(a===N||a===j)&&(n=_)}this.updateStatus(!1,n)},c.componentWillUnmount=function(){this.cancelNextCallback()},c.getTimeouts=function(){var r=this.props.timeout,n,a,i;return n=a=i=r,r!=null&&typeof r!="number"&&(n=r.exit,a=r.enter,i=r.appear!==void 0?r.appear:a),{exit:n,enter:a,appear:i}},c.updateStatus=function(r,n){if(r===void 0&&(r=!1),n!==null)if(this.cancelNextCallback(),n===N){if(this.props.unmountOnExit||this.props.mountOnEnter){var a=this.props.nodeRef?this.props.nodeRef.current:L.findDOMNode(this);a&&K(a)}this.performEnter(r)}else this.performExit();else this.props.unmountOnExit&&this.state.status===C&&this.setState({status:k})},c.performEnter=function(r){var n=this,a=this.props.enter,i=this.context?this.context.isMounting:r,l=this.props.nodeRef?[i]:[L.findDOMNode(this),i],o=l[0],d=l[1],f=this.getTimeouts(),x=i?f.appear:f.enter;if(!r&&!a||z.disabled){this.safeSetState({status:j},function(){n.props.onEntered(o)});return}this.props.onEnter(o,d),this.safeSetState({status:N},function(){n.props.onEntering(o,d),n.onTransitionEnd(x,function(){n.safeSetState({status:j},function(){n.props.onEntered(o,d)})})})},c.performExit=function(){var r=this,n=this.props.exit,a=this.getTimeouts(),i=this.props.nodeRef?void 0:L.findDOMNode(this);if(!n||z.disabled){this.safeSetState({status:C},function(){r.props.onExited(i)});return}this.props.onExit(i),this.safeSetState({status:_},function(){r.props.onExiting(i),r.onTransitionEnd(a.exit,function(){r.safeSetState({status:C},function(){r.props.onExited(i)})})})},c.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},c.safeSetState=function(r,n){n=this.setNextCallback(n),this.setState(r,n)},c.setNextCallback=function(r){var n=this,a=!0;return this.nextCallback=function(i){a&&(a=!1,n.nextCallback=null,r(i))},this.nextCallback.cancel=function(){a=!1},this.nextCallback},c.onTransitionEnd=function(r,n){this.setNextCallback(n);var a=this.props.nodeRef?this.props.nodeRef.current:L.findDOMNode(this),i=r==null&&!this.props.addEndListener;if(!a||i){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var l=this.props.nodeRef?[this.nextCallback]:[a,this.nextCallback],o=l[0],d=l[1];this.props.addEndListener(o,d)}r!=null&&setTimeout(this.nextCallback,r)},c.render=function(){var r=this.state.status;if(r===k)return null;var n=this.props,a=n.children;n.in,n.mountOnEnter,n.unmountOnExit,n.appear,n.enter,n.exit,n.timeout,n.addEndListener,n.onEnter,n.onEntering,n.onEntered,n.onExit,n.onExiting,n.onExited,n.nodeRef;var i=W(n,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return v.createElement(J.Provider,{value:null},typeof a=="function"?a(r,i):v.cloneElement(v.Children.only(a),i))},s})(v.Component);E.contextType=J;E.propTypes={};function b(){}E.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:b,onEntering:b,onEntered:b,onExit:b,onExiting:b,onExited:b};E.UNMOUNTED=k;E.EXITED=C;E.ENTERING=N;E.ENTERED=j;E.EXITING=_;var ge=function(s,c){return s&&c&&c.split(" ").forEach(function(e){return xe(s,e)})},R=function(s,c){return s&&c&&c.split(" ").forEach(function(e){return me(s,e)})},$=(function(t){q(s,t);function s(){for(var e,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return e=t.call.apply(t,[this].concat(n))||this,e.appliedClasses={appear:{},enter:{},exit:{}},e.onEnter=function(i,l){var o=e.resolveArguments(i,l),d=o[0],f=o[1];e.removeClasses(d,"exit"),e.addClass(d,f?"appear":"enter","base"),e.props.onEnter&&e.props.onEnter(i,l)},e.onEntering=function(i,l){var o=e.resolveArguments(i,l),d=o[0],f=o[1],x=f?"appear":"enter";e.addClass(d,x,"active"),e.props.onEntering&&e.props.onEntering(i,l)},e.onEntered=function(i,l){var o=e.resolveArguments(i,l),d=o[0],f=o[1],x=f?"appear":"enter";e.removeClasses(d,x),e.addClass(d,x,"done"),e.props.onEntered&&e.props.onEntered(i,l)},e.onExit=function(i){var l=e.resolveArguments(i),o=l[0];e.removeClasses(o,"appear"),e.removeClasses(o,"enter"),e.addClass(o,"exit","base"),e.props.onExit&&e.props.onExit(i)},e.onExiting=function(i){var l=e.resolveArguments(i),o=l[0];e.addClass(o,"exit","active"),e.props.onExiting&&e.props.onExiting(i)},e.onExited=function(i){var l=e.resolveArguments(i),o=l[0];e.removeClasses(o,"exit"),e.addClass(o,"exit","done"),e.props.onExited&&e.props.onExited(i)},e.resolveArguments=function(i,l){return e.props.nodeRef?[e.props.nodeRef.current,i]:[i,l]},e.getClassNames=function(i){var l=e.props.classNames,o=typeof l=="string",d=o&&l?l+"-":"",f=o?""+d+i:l[i],x=o?f+"-active":l[i+"Active"],m=o?f+"-done":l[i+"Done"];return{baseClassName:f,activeClassName:x,doneClassName:m}},e}var c=s.prototype;return c.addClass=function(r,n,a){var i=this.getClassNames(n)[a+"ClassName"],l=this.getClassNames("enter"),o=l.doneClassName;n==="appear"&&a==="done"&&o&&(i+=" "+o),a==="active"&&r&&K(r),i&&(this.appliedClasses[n][a]=i,ge(r,i))},c.removeClasses=function(r,n){var a=this.appliedClasses[n],i=a.base,l=a.active,o=a.done;this.appliedClasses[n]={},i&&R(r,i),l&&R(r,l),o&&R(r,o)},c.render=function(){var r=this.props;r.classNames;var n=W(r,["classNames"]);return v.createElement(E,D({},n,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},s})(v.Component);$.defaultProps={classNames:""};$.propTypes={};const B=v.createContext({parent:{}});function ve(){const t=h.useRef(!0);return h.useEffect(()=>{t.current=!1},[]),t.current}function F({show:t,enter:s="",enterStart:c="",enterEnd:e="",leave:r="",leaveStart:n="",leaveEnd:a="",appear:i,unmountOnExit:l,tag:o="div",children:d,...f}){const x=s.split(" ").filter(p=>p.length),m=c.split(" ").filter(p=>p.length),S=e.split(" ").filter(p=>p.length),I=r.split(" ").filter(p=>p.length),M=n.split(" ").filter(p=>p.length),P=a.split(" ").filter(p=>p.length),y=l;function T(p,w){w.length&&p.classList.add(...w)}function O(p,w){w.length&&p.classList.remove(...w)}const g=v.useRef(null),Q=o;return u.jsx($,{appear:i,nodeRef:g,unmountOnExit:y,in:t,addEndListener:p=>{g.current.addEventListener("transitionend",p,!1)},onEnter:()=>{y||(g.current.style.display=null),T(g.current,[...x,...m])},onEntering:()=>{O(g.current,m),T(g.current,S)},onEntered:()=>{O(g.current,[...S,...x])},onExit:()=>{T(g.current,[...I,...M])},onExiting:()=>{O(g.current,M),T(g.current,P)},onExited:()=>{O(g.current,[...P,...I]),y||(g.current.style.display="none")},children:u.jsx(Q,{ref:g,...f,style:{display:y?null:"none"},children:d})})}function Ee({show:t,appear:s,...c}){const{parent:e}=h.useContext(B),r=ve();return t===void 0?u.jsx(F,{appear:e.appear||!e.isInitialRender,show:e.show,...c}):u.jsx(B.Provider,{value:{parent:{show:t,isInitialRender:r,appear:s}},children:u.jsx(F,{appear:s,show:t,...c})})}function Ce(t){return t?/^https?:\/\//.test(t)?t:`${ue.baseURL}/${t}`:null}function Ne({align:t="right"}){const{user:s,logout:c}=h.useContext(ae),{showSpinner:e,hideSpinner:r}=oe(),[n,a]=h.useState(!1),[i,l]=h.useState("/default-profile.png"),o=h.useRef(null),d=h.useRef(null),f=le();h.useEffect(()=>{const m=Ce(s?.image);l(m||"/default-profile.png")},[s]),h.useEffect(()=>{const m=S=>{n&&d.current&&!d.current.contains(S.target)&&o.current&&!o.current.contains(S.target)&&a(!1)};return document.addEventListener("mousedown",m),document.addEventListener("touchstart",m),()=>{document.removeEventListener("mousedown",m),document.removeEventListener("touchstart",m)}},[n]),h.useEffect(()=>{if(!n)return;const m=setTimeout(()=>a(!1),8e3);return()=>clearTimeout(m)},[n]);const x=async()=>{a(!1),e();try{await c(),U.success("✅ تم تسجيل الخروج بنجاح",{description:"نراك قريبًا!"}),f("/login")}catch{U.error("❌ حدث خطأ أثناء تسجيل الخروج")}finally{r()}};return u.jsxs("div",{className:"relative inline-block text-right",ref:d,children:[u.jsxs("button",{ref:o,onClick:()=>a(!n),className:"inline-flex items-center gap-2 focus:outline-none",children:[u.jsx("span",{className:"hidden md:inline font-bold text-fg",children:s?.name||"زائر"}),u.jsx("img",{src:i,onError:()=>l("/default-profile.png"),alt:s?.name||"المستخدم",className:"w-8 h-8 rounded-full object-cover"}),u.jsx("svg",{className:"w-3 h-3 text-muted",viewBox:"0 0 12 12",children:u.jsx("path",{d:"M5.9 11.4L.5 6l1.4-1.4 4 4 4-4L11.3 6z"})})]}),u.jsx(Ee,{show:n,className:`absolute z-50 top-11 ${t==="right"?"right-0":"left-0"} min-w-44 bg-card border border-border rounded-lg shadow-lg py-2 ring-1 ring-ring`,enter:"transition ease-out duration-200",enterStart:"opacity-0 -translate-y-2",enterEnd:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveStart:"opacity-100",leaveEnd:"opacity-0",children:u.jsxs("ul",{className:"text-sm text-fg",children:[u.jsx("li",{children:u.jsx(ce,{to:"/profile",onClick:()=>a(!1),className:"flex items-center px-4 py-2 hover:bg-muted",children:"الملف الشخصى"})}),u.jsx("li",{children:u.jsx("button",{onClick:x,className:"flex items-center w-full px-4 py-2 text-destructive hover:bg-muted text-right",children:"تسجيل الخروج"})})]})})]})}function be(){const{currentTheme:t,changeCurrentTheme:s}=de();return u.jsx(V,{onClick:()=>s(t==="light"?"dark":"light"),children:t==="light"?u.jsx(Z,{className:"w-5 h-5"}):u.jsx(ee,{className:"w-5 h-5"})})}function je(){const{lang:t,toggleLanguage:s}=X();return u.jsx(H,{variant:"ghost",size:"icon",onClick:s,"aria-label":t==="ar"?"Switch to English":"التبديل إلى العربية",children:t==="ar"?"EN":"ع"})}function Te({isOpen:t,user:s,onToggleSidebar:c}){const{dir:e}=X(),[r]=h.useState(()=>{const a=document.documentElement;return a.classList.contains("dark")||a.getAttribute("data-theme")==="dark"}),n=t?e==="rtl"?"lg:mr-64":"lg:ml-64":e==="rtl"?"lg:mr-16":"lg:ml-16";return u.jsxs("nav",{dir:e,style:{boxShadow:r?"0 10px 30px -10px rgba(34,211,238,0.35)":"0 6px 12px -4px rgba(0,0,0,0.1)"},className:`
        fixed top-0 left-0 right-0
        transition-all duration-300
        ${n}
        py-3 px-6 flex justify-between items-center
        bg-sidebar
        text-gray-900 dark:text-white
        dark:border-navy-dark
        shadow-md dark:shadow-[0_01px_#16b8f640]
        z-30
      `,children:[u.jsx(H,{variant:"ghost",size:"icon",onClick:c,children:u.jsx(te,{className:"text-freen-900 dark:text-greenic h-5 w-5 hover:text-greenic-light"})}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(fe,{userId:s.id,align:"right"}),u.jsx(be,{}),u.jsx(je,{}),u.jsx("div",{className:"hidden sm:block w-px h-6 bg-border"}),u.jsx(Ne,{align:"left"})]})]})}export{Te as default};
