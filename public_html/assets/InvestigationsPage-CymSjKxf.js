const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/InvestigationModal-CAHDZrG7.js","assets/pdf-D5yLTPdL.js","assets/react-UnWXGYuj.js","assets/pdf-Du6EuK7o.css","assets/ModalCard-BQAsNCRr.js","assets/InvestigationActionsTable-CC1tXMC_.js","assets/index-BrCJu-Nk.js","assets/vendor-CTvvdsW_.js","assets/index-DedVPPdE.css","assets/GlobalConfirmDeleteModal-POJBepxz.js"])))=>i.map(i=>d[i]);
import{D as E,m as g,B as b,E as C,t as a,F as D,H as S,_ as p}from"./index-BrCJu-Nk.js";import{r as s,j as e,g as N,C as R}from"./pdf-D5yLTPdL.js";import{T as O}from"./TableComponent-oB2Hgwhz.js";import T from"./SectionHeader-DYN9xJld.js";import"./react-UnWXGYuj.js";import"./vendor-CTvvdsW_.js";const M="/assets/inv-icon-DGMk-5FX.png",P=s.lazy(()=>p(()=>import("./InvestigationModal-CAHDZrG7.js"),__vite__mapDeps([0,1,2,3,4]))),A=s.lazy(()=>p(()=>import("./InvestigationActionsTable-CC1tXMC_.js"),__vite__mapDeps([5,1,2,3,6,7,8,4,9]))),L=s.lazy(()=>p(()=>import("./GlobalConfirmDeleteModal-POJBepxz.js"),__vite__mapDeps([9,1,2,3])));function W(){const[m,i]=s.useState(!1),[o,l]=s.useState(null),[u,y]=s.useState(null),[n,r]=s.useState(null),h="investigations",{data:v,refetch:d}=E(),f=v?.data?.data||[],j=async t=>{try{o?(await C(o.id,t),a.success("تم التعديل بنجاح")):(await D(t),a.success("تمت الإضافة بنجاح")),i(!1),l(null),await d()}catch{a.error("فشل في الحفظ")}},_=t=>{l(t),i(!0)},I=async()=>{if(n)try{await S(n.id),a.success("تم حذف التحقيق بنجاح"),await d()}catch{a.error("فشل حذف التحقيق")}finally{r(null)}},k=t=>{y(c=>c===t?null:t)},x=[{key:"expand",text:""},{key:"employee_name",text:"الموظف"},{key:"source",text:"الجهة المحيلة"},{key:"subject",text:"الموضوع"},{key:"case_number",text:"رقم القضية"},{key:"status",text:"الحالة"}],w={expand:t=>e.jsx("button",{onClick:c=>{c.stopPropagation(),k(t.id)},children:u===t.id?e.jsx(N,{className:"w-4 h-4"}):e.jsx(R,{className:"w-4 h-4"})}),status:t=>e.jsx("span",{className:"font-semibold text-red-600 dark:text-yellow-300",children:t.status})};return e.jsxs("div",{className:"p-6 min-h-screen",children:[e.jsx(g.div,{initial:{opacity:0,y:-100},animate:{opacity:1,y:0},exit:{opacity:0,y:-40},transition:{type:"spring",stiffness:70,damping:14},children:e.jsx(T,{icon:M,listName:"قسم التحقيقات"})},"header"),e.jsx(g.div,{initial:{opacity:0,y:100},animate:{opacity:1,y:0},exit:{opacity:0,y:60},transition:{type:"spring",stiffness:60,damping:14,delay:.1},className:"rounded-xl bg-card text-card-foreground p-4 shadow-md",children:e.jsx(O,{title:"قسم التحقيقات القانونية",data:f,headers:x,customRenderers:w,moduleName:h,renderAddButton:{render:()=>e.jsxs(b,{variant:"default",onClick:()=>i(!0),children:["إضافة تحقيق جديد",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})})]})},onEdit:_,onDelete:t=>r(t),expandedRowRenderer:t=>u===t.id&&e.jsx("tr",{children:e.jsx("td",{colSpan:x.length+2,className:"p-4 bg-gray-50 dark:bg-gray-800",children:e.jsx(s.Suspense,{fallback:e.jsx("div",{children:"تحميل البيانات..."}),children:e.jsx(A,{investigationId:t.id,actions:t.actions||[],reloadInvestigations:d})})})})})}),e.jsxs(s.Suspense,{fallback:null,children:[m&&e.jsx(P,{isOpen:m,onClose:()=>{i(!1),l(null)},initialData:o,onSubmit:j}),n&&e.jsx(L,{isOpen:!!n,onClose:()=>r(null),onConfirm:I,itemName:n?.employee_name})]})]})}export{W as default};
