const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LegalAdviceModal-ChJYUxTf.js","assets/pdf-D5yLTPdL.js","assets/react-UnWXGYuj.js","assets/pdf-Du6EuK7o.css","assets/index-BrCJu-Nk.js","assets/vendor-CTvvdsW_.js","assets/index-DedVPPdE.css","assets/ModalCard-BQAsNCRr.js","assets/LegalAdviceDetails-CcrhNCtK.js","assets/GlobalConfirmDeleteModal-POJBepxz.js"])))=>i.map(i=>d[i]);
import{A as T,J as b,K as D,m as x,c as N,B as E,M as O,t as v,_ as r,O as w}from"./index-BrCJu-Nk.js";import{r as a,j as e}from"./pdf-D5yLTPdL.js";import{T as R}from"./TableComponent-oB2Hgwhz.js";import S from"./SectionHeader-DYN9xJld.js";import"./react-UnWXGYuj.js";import"./vendor-CTvvdsW_.js";const I="/assets/legal-advice-q5QizuOf.png",P=a.lazy(()=>r(()=>import("./LegalAdviceModal-ChJYUxTf.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),M=a.lazy(()=>r(()=>import("./LegalAdviceDetails-CcrhNCtK.js"),__vite__mapDeps([8,1,2,3,4,5,6]))),z=a.lazy(()=>r(()=>import("./GlobalConfirmDeleteModal-POJBepxz.js"),__vite__mapDeps([9,1,2,3])));function H(){const[d,i]=a.useState(!1),[h,g]=a.useState(null),[c,p]=a.useState(null),[s,o]=a.useState(null),{hasPermission:f}=a.useContext(T),m="legaladvices",l=t=>f(`${t} ${m}`),{data:_,refetch:u}=b(),{data:j}=D({queryKey:["adviceTypes"],queryFn:w}),A=_?.data||[],y=j?.data||[],k=async()=>{if(s)try{await O(s.id),v.success("تم حذف المشورة بنجاح"),await u()}catch{v.error("فشل حذف المشورة")}finally{o(null)}},C=t=>{const n=y.find(L=>L.id===t);return n?n.type_name:"غير معروف"};return e.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 min-h-screen transition-colors",children:[e.jsx(x.div,{initial:{opacity:0,y:-100},animate:{opacity:1,y:0},exit:{opacity:0,y:-40},transition:{type:"spring",stiffness:70,damping:14},children:e.jsx(S,{listName:"قسم المشورة القانونية",icon:I})},"header"),e.jsx(x.div,{initial:{opacity:0,y:100},animate:{opacity:1,y:0},exit:{opacity:0,y:60},transition:{type:"spring",stiffness:60,damping:14,delay:.1},className:"rounded-xl bg-card text-card-foreground p-4 shadow-md",children:e.jsx(R,{moduleName:m,renderAddButton:l("create")?{render:()=>e.jsxs(E,{onClick:()=>i(!0),children:["إضافة مشورة / رأي",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})})]})}:null,onEdit:l("edit")?t=>{g(t),i(!0)}:null,onDelete:l("delete")?t=>o(t):null,data:A,headers:[{key:"type",text:"نوع المشورة"},{key:"topic",text:"الموضوع"},{key:"advice_date",text:"تاريخ المشورة"},{key:"advice_number",text:"رقم المشورة"},{key:"attachment",text:"مرفق"}],customRenderers:{type:t=>C(t.advice_type_id),attachment:t=>t.attachment?e.jsx("a",{href:`${N.baseURL}/storage/${t.attachment}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"عرض"}):e.jsx("span",{className:"text-gray-400",children:"لا يوجد"})},onRowClick:t=>p(n=>n?.id===t.id?null:t),expandedRowRenderer:t=>c?.id===t.id&&e.jsx("tr",{children:e.jsxs("td",{colSpan:7,className:"bg-muted/40 px-4 pb-6",children:[e.jsx(a.Suspense,{fallback:e.jsx("div",{children:"تحميل التفاصيل..."}),children:e.jsx(M,{selected:c,onClose:()=>p(null)})}),"                "]})})})}),e.jsxs(a.Suspense,{fallback:null,children:[d&&e.jsx(P,{isOpen:d,onClose:()=>i(!1),adviceTypes:y,initialData:h,reload:u}),s&&e.jsx(z,{isOpen:!!s,onClose:()=>o(null),onConfirm:k,itemName:s?.topic||"المشورة"})]})]})}export{H as default};
