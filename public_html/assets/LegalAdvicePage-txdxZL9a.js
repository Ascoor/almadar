const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LegalAdviceModal-D9u2u6gc.js","assets/pdf-_01J5l0m.js","assets/react-DxiZ5OBW.js","assets/pdf-Du6EuK7o.css","assets/index-C9wc903-.js","assets/vendor-CTvvdsW_.js","assets/index-Dt2JeuVK.css","assets/ModalCard-Bqi_hoDA.js","assets/GlobalConfirmDeleteModal-DPvq9hXw.js"])))=>i.map(i=>d[i]);
import{b as N,o as T,A as b,F as D,H as w,m,c as E,B as O,J as I,t as u,_ as y,K as M}from"./index-C9wc903-.js";import{j as t}from"./pdf-_01J5l0m.js";import{a}from"./react-DxiZ5OBW.js";import{T as P}from"./TableComponent-oKqWs0n5.js";import R from"./SectionHeader-CPTYPmPH.js";import"./vendor-CTvvdsW_.js";const S="/assets/legal-advice-q5QizuOf.png",$=a.lazy(()=>y(()=>import("./LegalAdviceModal-D9u2u6gc.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),B=a.lazy(()=>y(()=>import("./GlobalConfirmDeleteModal-DPvq9hXw.js"),__vite__mapDeps([8,1,2,3])));function Q(){const v=N(),[l,n]=a.useState(v.state?.openModal||!1),[g,x]=a.useState(null),[s,i]=a.useState(null),h=T(),{hasPermission:f}=a.useContext(b),r="legaladvices",o=e=>f(`${e} ${r}`),{data:_,refetch:c}=D(),{data:j}=w({queryKey:["adviceTypes"],queryFn:M}),A=_?.data||[],d=j?.data||[],k=async()=>{if(s)try{await I(s.id),u.success("تم حذف المشورة بنجاح"),await c()}catch{u.error("فشل حذف المشورة")}finally{i(null)}},C=e=>{const p=d.find(L=>L.id===e);return p?p.type_name:"غير معروف"};return t.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 min-h-screen transition-colors",children:[t.jsx(m.div,{initial:{opacity:0,y:-100},animate:{opacity:1,y:0},exit:{opacity:0,y:-40},transition:{type:"spring",stiffness:70,damping:14},children:t.jsx(R,{listName:"قسم المشورة القانونية",icon:S})},"header"),t.jsx(m.div,{initial:{opacity:0,y:100},animate:{opacity:1,y:0},exit:{opacity:0,y:60},transition:{type:"spring",stiffness:60,damping:14,delay:.1},className:"rounded-xl bg-card text-fg p-4 shadow-md",children:t.jsx(P,{moduleName:r,renderAddButton:o("create")?{render:()=>t.jsxs(O,{onClick:()=>n(!0),children:["إضافة مشورة / رأي",t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})})]})}:null,onEdit:o("edit")?e=>{x(e),n(!0)}:null,onDelete:o("delete")?e=>i(e):null,data:A,headers:[{key:"type",text:"نوع المشورة"},{key:"topic",text:"الموضوع"},{key:"advice_date",text:"تاريخ المشورة"},{key:"advice_number",text:"رقم المشورة"},{key:"attachment",text:"مرفق"}],customRenderers:{type:e=>C(e.advice_type_id),attachment:e=>e.attachment?t.jsx("a",{href:`${E.baseURL}/storage/${e.attachment}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"عرض"}):t.jsx("span",{className:"text-gray-400",children:"لا يوجد"})},onRowClick:e=>h(`/legal/legal-advices/${e.id}`,{state:e})})}),t.jsxs(a.Suspense,{fallback:null,children:[l&&t.jsx($,{isOpen:l,onClose:()=>n(!1),adviceTypes:d,initialData:g,reload:c}),s&&t.jsx(B,{isOpen:!!s,onClose:()=>i(null),onConfirm:k,itemName:s?.topic||"المشورة"})]})]})}export{Q as default};
