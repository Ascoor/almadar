import{j as u,r as h,B as Q,a as g,S as Y,b as Z,c as ee}from"./pdf-D5yLTPdL.js";import{j as te,m as ne,k as se,l as re,n as R,A as ie,f as ae,o as oe,L as le,t as U,c as ce,p as ue,a as de,B as G}from"./index-BrCJu-Nk.js";import"./react-UnWXGYuj.js";import"./vendor-CTvvdsW_.js";const fe=async n=>{try{const r=await te.put(`/api/notifications/${n}/read`);return console.log("Marked as read:",r.data),r.data}catch(r){throw console.error("Error marking notification as read:",r),r}};function H({onClick:n,active:r,children:c,className:e="",...s}){return u.jsx(ne.button,{whileHover:{scale:1.1},whileTap:{scale:.95},transition:{type:"spring",stiffness:300},onClick:n,...s,className:se(`relative inline-flex items-center justify-center p-2 rounded-full
        transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2
        bg-secondary text-secondary-foreground hover:bg-secondary-hover shadow-md`,r&&"ring-2 ring-secondary",e),children:c})}function pe(){const{notifications:n,hasNew:r,markRead:c,markAllAsRead:e}=re(),[s,t]=h.useState(!1),a=h.useRef(null),i=o=>{a.current&&!a.current.contains(o.target)&&t(!1)};h.useEffect(()=>(s&&document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)),[s]);const l=async o=>{await fe(o.id),c(o.id),t(!1)};return u.jsxs("div",{className:"relative",dir:"rtl",ref:a,children:[u.jsxs(H,{onClick:()=>t(o=>!o),active:s,children:[u.jsx(Q,{className:"w-6 h-6"}),r&&u.jsx("span",{className:"absolute top-0 left-0 w-2.5 h-2.5 bg-red-500 rounded-full animate-ping"})]}),s&&u.jsxs("div",{className:`
      sm:absolute fixed sm:left-0 top-[72px] left-1/2 transform -translate-x-1/2
      z-50 w-[90vw] max-w-sm sm:w-80 mt-2
      bg-card rounded-xl shadow-lg ring-1 ring-ring
    `,children:[u.jsxs("div",{className:"flex justify-between px-4 py-3 border-b border-border",children:[u.jsx("span",{className:"text-sm font-semibold text-foreground",children:"الإشعارات"}),n.length>0&&u.jsx("button",{className:"text-xs text-accent hover:text-accent-hover",onClick:e,children:"تعيين الكل كمقروء"})]}),u.jsx("ul",{className:"max-h-80 overflow-y-auto divide-y divide-border",children:n.length===0?u.jsx("li",{className:"p-4 text-center text-sm text-muted-foreground",children:"لا توجد إشعارات"}):n.map(o=>u.jsxs("li",{onClick:()=>l(o),className:`p-4 cursor-pointer transition hover:bg-muted ${o.read?"":"bg-primary/10"}`,children:[u.jsxs("div",{className:"text-sm font-medium text-foreground",children:[o.icon," ",o.title]}),u.jsx("div",{className:"text-xs text-muted-foreground",children:o.message}),u.jsx("div",{className:"mt-1 text-xs text-muted-foreground",children:new Intl.DateTimeFormat("ar-EG",{dateStyle:"short",timeStyle:"short"}).format(new Date(o.created_at))})]},o.id))})]})]})}function D(){return D=Object.assign?Object.assign.bind():function(n){for(var r=1;r<arguments.length;r++){var c=arguments[r];for(var e in c)({}).hasOwnProperty.call(c,e)&&(n[e]=c[e])}return n},D.apply(null,arguments)}function V(n,r){if(n==null)return{};var c={};for(var e in n)if({}.hasOwnProperty.call(n,e)){if(r.indexOf(e)!==-1)continue;c[e]=n[e]}return c}function A(n,r){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,e){return c.__proto__=e,c},A(n,r)}function W(n,r){n.prototype=Object.create(r.prototype),n.prototype.constructor=n,A(n,r)}function he(n,r){return n.classList?!!r&&n.classList.contains(r):(" "+(n.className.baseVal||n.className)+" ").indexOf(" "+r+" ")!==-1}function me(n,r){n.classList?n.classList.add(r):he(n,r)||(typeof n.className=="string"?n.className=n.className+" "+r:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+r))}function z(n,r){return n.replace(new RegExp("(^|\\s)"+r+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function xe(n,r){n.classList?n.classList.remove(r):typeof n.className=="string"?n.className=z(n.className,r):n.setAttribute("class",z(n.className&&n.className.baseVal||"",r))}const B={disabled:!1},q=g.createContext(null);var J=function(r){return r.scrollTop},y="unmounted",C="exited",N="entering",j="entered",_="exiting",E=(function(n){W(r,n);function r(e,s){var t;t=n.call(this,e,s)||this;var a=s,i=a&&!a.isMounting?e.enter:e.appear,l;return t.appearStatus=null,e.in?i?(l=C,t.appearStatus=N):l=j:e.unmountOnExit||e.mountOnEnter?l=y:l=C,t.state={status:l},t.nextCallback=null,t}r.getDerivedStateFromProps=function(s,t){var a=s.in;return a&&t.status===y?{status:C}:null};var c=r.prototype;return c.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},c.componentDidUpdate=function(s){var t=null;if(s!==this.props){var a=this.state.status;this.props.in?a!==N&&a!==j&&(t=N):(a===N||a===j)&&(t=_)}this.updateStatus(!1,t)},c.componentWillUnmount=function(){this.cancelNextCallback()},c.getTimeouts=function(){var s=this.props.timeout,t,a,i;return t=a=i=s,s!=null&&typeof s!="number"&&(t=s.exit,a=s.enter,i=s.appear!==void 0?s.appear:a),{exit:t,enter:a,appear:i}},c.updateStatus=function(s,t){if(s===void 0&&(s=!1),t!==null)if(this.cancelNextCallback(),t===N){if(this.props.unmountOnExit||this.props.mountOnEnter){var a=this.props.nodeRef?this.props.nodeRef.current:R.findDOMNode(this);a&&J(a)}this.performEnter(s)}else this.performExit();else this.props.unmountOnExit&&this.state.status===C&&this.setState({status:y})},c.performEnter=function(s){var t=this,a=this.props.enter,i=this.context?this.context.isMounting:s,l=this.props.nodeRef?[i]:[R.findDOMNode(this),i],o=l[0],d=l[1],p=this.getTimeouts(),m=i?p.appear:p.enter;if(!s&&!a||B.disabled){this.safeSetState({status:j},function(){t.props.onEntered(o)});return}this.props.onEnter(o,d),this.safeSetState({status:N},function(){t.props.onEntering(o,d),t.onTransitionEnd(m,function(){t.safeSetState({status:j},function(){t.props.onEntered(o,d)})})})},c.performExit=function(){var s=this,t=this.props.exit,a=this.getTimeouts(),i=this.props.nodeRef?void 0:R.findDOMNode(this);if(!t||B.disabled){this.safeSetState({status:C},function(){s.props.onExited(i)});return}this.props.onExit(i),this.safeSetState({status:_},function(){s.props.onExiting(i),s.onTransitionEnd(a.exit,function(){s.safeSetState({status:C},function(){s.props.onExited(i)})})})},c.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},c.safeSetState=function(s,t){t=this.setNextCallback(t),this.setState(s,t)},c.setNextCallback=function(s){var t=this,a=!0;return this.nextCallback=function(i){a&&(a=!1,t.nextCallback=null,s(i))},this.nextCallback.cancel=function(){a=!1},this.nextCallback},c.onTransitionEnd=function(s,t){this.setNextCallback(t);var a=this.props.nodeRef?this.props.nodeRef.current:R.findDOMNode(this),i=s==null&&!this.props.addEndListener;if(!a||i){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var l=this.props.nodeRef?[this.nextCallback]:[a,this.nextCallback],o=l[0],d=l[1];this.props.addEndListener(o,d)}s!=null&&setTimeout(this.nextCallback,s)},c.render=function(){var s=this.state.status;if(s===y)return null;var t=this.props,a=t.children;t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef;var i=V(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return g.createElement(q.Provider,{value:null},typeof a=="function"?a(s,i):g.cloneElement(g.Children.only(a),i))},r})(g.Component);E.contextType=q;E.propTypes={};function b(){}E.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:b,onEntering:b,onEntered:b,onExit:b,onExiting:b,onExited:b};E.UNMOUNTED=y;E.EXITED=C;E.ENTERING=N;E.ENTERED=j;E.EXITING=_;var ve=function(r,c){return r&&c&&c.split(" ").forEach(function(e){return me(r,e)})},L=function(r,c){return r&&c&&c.split(" ").forEach(function(e){return xe(r,e)})},$=(function(n){W(r,n);function r(){for(var e,s=arguments.length,t=new Array(s),a=0;a<s;a++)t[a]=arguments[a];return e=n.call.apply(n,[this].concat(t))||this,e.appliedClasses={appear:{},enter:{},exit:{}},e.onEnter=function(i,l){var o=e.resolveArguments(i,l),d=o[0],p=o[1];e.removeClasses(d,"exit"),e.addClass(d,p?"appear":"enter","base"),e.props.onEnter&&e.props.onEnter(i,l)},e.onEntering=function(i,l){var o=e.resolveArguments(i,l),d=o[0],p=o[1],m=p?"appear":"enter";e.addClass(d,m,"active"),e.props.onEntering&&e.props.onEntering(i,l)},e.onEntered=function(i,l){var o=e.resolveArguments(i,l),d=o[0],p=o[1],m=p?"appear":"enter";e.removeClasses(d,m),e.addClass(d,m,"done"),e.props.onEntered&&e.props.onEntered(i,l)},e.onExit=function(i){var l=e.resolveArguments(i),o=l[0];e.removeClasses(o,"appear"),e.removeClasses(o,"enter"),e.addClass(o,"exit","base"),e.props.onExit&&e.props.onExit(i)},e.onExiting=function(i){var l=e.resolveArguments(i),o=l[0];e.addClass(o,"exit","active"),e.props.onExiting&&e.props.onExiting(i)},e.onExited=function(i){var l=e.resolveArguments(i),o=l[0];e.removeClasses(o,"exit"),e.addClass(o,"exit","done"),e.props.onExited&&e.props.onExited(i)},e.resolveArguments=function(i,l){return e.props.nodeRef?[e.props.nodeRef.current,i]:[i,l]},e.getClassNames=function(i){var l=e.props.classNames,o=typeof l=="string",d=o&&l?l+"-":"",p=o?""+d+i:l[i],m=o?p+"-active":l[i+"Active"],x=o?p+"-done":l[i+"Done"];return{baseClassName:p,activeClassName:m,doneClassName:x}},e}var c=r.prototype;return c.addClass=function(s,t,a){var i=this.getClassNames(t)[a+"ClassName"],l=this.getClassNames("enter"),o=l.doneClassName;t==="appear"&&a==="done"&&o&&(i+=" "+o),a==="active"&&s&&J(s),i&&(this.appliedClasses[t][a]=i,ve(s,i))},c.removeClasses=function(s,t){var a=this.appliedClasses[t],i=a.base,l=a.active,o=a.done;this.appliedClasses[t]={},i&&L(s,i),l&&L(s,l),o&&L(s,o)},c.render=function(){var s=this.props;s.classNames;var t=V(s,["classNames"]);return g.createElement(E,D({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},r})(g.Component);$.defaultProps={classNames:""};$.propTypes={};const F=g.createContext({parent:{}});function ge(){const n=h.useRef(!0);return h.useEffect(()=>{n.current=!1},[]),n.current}function X({show:n,enter:r="",enterStart:c="",enterEnd:e="",leave:s="",leaveStart:t="",leaveEnd:a="",appear:i,unmountOnExit:l,tag:o="div",children:d,...p}){const m=r.split(" ").filter(f=>f.length),x=c.split(" ").filter(f=>f.length),S=e.split(" ").filter(f=>f.length),I=s.split(" ").filter(f=>f.length),M=t.split(" ").filter(f=>f.length),P=a.split(" ").filter(f=>f.length),T=l;function O(f,w){w.length&&f.classList.add(...w)}function k(f,w){w.length&&f.classList.remove(...w)}const v=g.useRef(null),K=o;return u.jsx($,{appear:i,nodeRef:v,unmountOnExit:T,in:n,addEndListener:f=>{v.current.addEventListener("transitionend",f,!1)},onEnter:()=>{T||(v.current.style.display=null),O(v.current,[...m,...x])},onEntering:()=>{k(v.current,x),O(v.current,S)},onEntered:()=>{k(v.current,[...S,...m])},onExit:()=>{O(v.current,[...I,...M])},onExiting:()=>{k(v.current,M),O(v.current,P)},onExited:()=>{k(v.current,[...P,...I]),T||(v.current.style.display="none")},children:u.jsx(K,{ref:v,...p,style:{display:T?null:"none"},children:d})})}function Ee({show:n,appear:r,...c}){const{parent:e}=h.useContext(F),s=ge();return n===void 0?u.jsx(X,{appear:e.appear||!e.isInitialRender,show:e.show,...c}):u.jsx(F.Provider,{value:{parent:{show:n,isInitialRender:s,appear:r}},children:u.jsx(X,{appear:r,show:n,...c})})}function Ce(n){return n?/^https?:\/\//.test(n)?n:`${ce.baseURL}/${n}`:null}function Ne({align:n="right"}){const{user:r,logout:c}=h.useContext(ie),{showSpinner:e,hideSpinner:s}=ae(),[t,a]=h.useState(!1),[i,l]=h.useState("/default-profile.png"),o=h.useRef(null),d=h.useRef(null),p=oe();h.useEffect(()=>{const x=Ce(r?.image);l(x||"/default-profile.png")},[r]),h.useEffect(()=>{const x=S=>{t&&d.current&&!d.current.contains(S.target)&&o.current&&!o.current.contains(S.target)&&a(!1)};return document.addEventListener("mousedown",x),document.addEventListener("touchstart",x),()=>{document.removeEventListener("mousedown",x),document.removeEventListener("touchstart",x)}},[t]),h.useEffect(()=>{if(!t)return;const x=setTimeout(()=>a(!1),8e3);return()=>clearTimeout(x)},[t]);const m=async()=>{a(!1),e();try{await c(),U.success("✅ تم تسجيل الخروج بنجاح",{description:"نراك قريبًا!"}),p("/login")}catch{U.error("❌ حدث خطأ أثناء تسجيل الخروج")}finally{s()}};return u.jsxs("div",{className:"relative inline-block text-right",ref:d,children:[u.jsxs("button",{ref:o,onClick:()=>a(!t),className:"inline-flex items-center gap-2 focus:outline-none",children:[u.jsx("span",{className:"hidden md:inline font-bold text-foreground",children:r?.name||"زائر"}),u.jsx("img",{src:i,onError:()=>l("/default-profile.png"),alt:r?.name||"المستخدم",className:"w-8 h-8 rounded-full object-cover"}),u.jsx("svg",{className:"w-3 h-3 text-muted-foreground",viewBox:"0 0 12 12",children:u.jsx("path",{d:"M5.9 11.4L.5 6l1.4-1.4 4 4 4-4L11.3 6z"})})]}),u.jsx(Ee,{show:t,className:`absolute z-50 top-11 ${n==="right"?"right-0":"left-0"} min-w-44 bg-card border border-border rounded-lg shadow-lg py-2 ring-1 ring-ring`,enter:"transition ease-out duration-200",enterStart:"opacity-0 -translate-y-2",enterEnd:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveStart:"opacity-100",leaveEnd:"opacity-0",children:u.jsxs("ul",{className:"text-sm text-foreground",children:[u.jsx("li",{children:u.jsx(le,{to:"/profile",onClick:()=>a(!1),className:"flex items-center px-4 py-2 hover:bg-muted",children:"الملف الشخصى"})}),u.jsx("li",{children:u.jsx("button",{onClick:m,className:"flex items-center w-full px-4 py-2 text-destructive hover:bg-muted text-right",children:"تسجيل الخروج"})})]})})]})}function be(){const{currentTheme:n,changeCurrentTheme:r}=ue();return u.jsx(H,{onClick:()=>r(n==="light"?"dark":"light"),children:n==="light"?u.jsx(Y,{className:"w-5 h-5"}):u.jsx(Z,{className:"w-5 h-5"})})}function Te({isOpen:n,user:r,onToggleSidebar:c}){const{dir:e,toggleLanguage:s,lang:t}=de();return u.jsxs("nav",{dir:e,className:`
        fixed top-0 left-0 right-0
        transition-all duration-300
        ${n?e==="rtl"?"sm:mr-64":"sm:ml-64":e==="rtl"?"sm:mr-16":"sm:ml-16"}
        py-3 px-6 flex justify-between items-center
        bg-card text-foreground
        border-b border-border shadow-md
        z-20
      `,children:[u.jsx(G,{variant:"ghost",size:"icon",onClick:c,children:u.jsx(ee,{className:"h-5 w-5 text-foreground hover:text-primary"})}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(G,{variant:"ghost",size:"icon",onClick:s,children:t==="ar"?"EN":"AR"}),u.jsx(pe,{userId:r.id,align:e==="rtl"?"right":"left"}),u.jsx(be,{}),u.jsx("div",{className:"hidden sm:block w-px h-6 bg-border"}),u.jsx(Ne,{align:e==="rtl"?"left":"right"})]})]})}export{Te as default};
