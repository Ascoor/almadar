const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-BprxG_6D.js","assets/index-BrCJu-Nk.js","assets/pdf-D5yLTPdL.js","assets/react-UnWXGYuj.js","assets/pdf-Du6EuK7o.css","assets/vendor-CTvvdsW_.js","assets/index-DedVPPdE.css","assets/ProfileUser-BYV1FES8.js","assets/ContractsPage-CAdXDuOl.js","assets/InvestigationsPage-CymSjKxf.js","assets/TableComponent-oB2Hgwhz.js","assets/SectionHeader-DYN9xJld.js","assets/LegalAdvicePage-C_rM3VIX.js","assets/LitigationsPage-BtKBKrXH.js","assets/card-DrA5FRIg.js","assets/UserManagementPage-B5ndgJcV.js","assets/GlobalConfirmDeleteModal-POJBepxz.js","assets/ArchivePage-DQNIuh6w.js","assets/ManagementSettings-zsU41gn5.js","assets/ReportsPage-4iKfEdpI.js"])))=>i.map(i=>d[i]);
import{A as N,N as w,g as v,c as L,t as p,d as D,e as S,f as I,b as C,G as y,R as k,h as n,_ as i}from"./index-BrCJu-Nk.js";import{j as e,r as s}from"./pdf-D5yLTPdL.js";import"./react-UnWXGYuj.js";import"./vendor-CTvvdsW_.js";function O(){return e.jsx("div",{className:"text-center text-red-600 text-xl font-bold mt-20",children:"🚫 غير مصرح لك بالوصول إلى هذه الصفحة"})}const d=({permission:a,children:c,superAdminOnly:x=!1})=>{const{hasPermission:m,user:o}=s.useContext(N),u=o?.email==="superadmin@almadar.ly";return x&&!u?e.jsx(w,{to:"/forbidden",replace:!0}):(Array.isArray(a)?a:[a]).every(l=>m(l))?c:e.jsx(w,{to:"/forbidden",replace:!0})};function T(){const{user:a,updateUserContext:c}=s.useContext(N),[x,m]=s.useState(null),[o,u]=s.useState({name:"",email:"",image:null}),[j,_]=s.useState(null),[l,h]=s.useState({old_password:"",new_password:"",new_password_confirmation:""});s.useEffect(()=>{const r=async()=>{try{const t=await v(a.id);m(t.user),u({name:t.user.name,email:t.user.email,image:null}),t.user.image&&_(`${L.baseURL}/${t.user.image}`)}catch{p.error("فشل تحميل الملف الشخصي")}};a?.id&&r()},[a]);const b=r=>{const{name:t,value:f,files:R}=r.target;if(t==="image"){const g=R[0];u(A=>({...A,image:g})),_(URL.createObjectURL(g))}else u(g=>({...g,[t]:f}))},P=async r=>{r.preventDefault();const t=new FormData;t.append("name",o.name),t.append("email",o.email),o.image&&t.append("image",o.image);try{await D(a.id,t),p.success("✅ تم تحديث البيانات بنجاح");const f=await v(a.id);c(f.user)}catch{p.error("حدث خطأ أثناء التحديث")}},E=async r=>{r.preventDefault();try{await S(a.id,l),p.success("✅ تم تغيير كلمة المرور"),h({old_password:"",new_password:"",new_password_confirmation:""})}catch(t){p.error(t.response?.data?.message||"فشل تغيير كلمة المرور")}};return a?e.jsxs("div",{className:"max-w-3xl mx-auto p-6 space-y-10",children:[e.jsxs("div",{className:"p-6 space-y-6 rounded-lg shadow bg-card",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"الملف الشخصي"}),e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"الاسم"}),e.jsx("input",{type:"text",name:"name",value:o.name,onChange:b,className:"w-full px-3 py-2 rounded border border-border bg-background text-foreground"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"البريد الإلكتروني"}),e.jsx("input",{type:"email",name:"email",value:o.email,onChange:b,className:"w-full px-3 py-2 rounded border border-border bg-background text-foreground"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"الصورة الشخصية"}),e.jsx("input",{type:"file",name:"image",onChange:b,className:"w-full"}),j&&e.jsx("img",{src:j,alt:"صورة المستخدم",className:"w-24 h-24 mt-2 rounded-full object-cover"})]}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded bg-primary text-primary-foreground hover:bg-primary-hover transition",children:"حفظ التغييرات"})]})]}),e.jsxs("div",{className:"p-6 space-y-6 rounded-lg shadow bg-card",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"تغيير كلمة المرور"}),e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"كلمة المرور الحالية"}),e.jsx("input",{type:"password",name:"old_password",value:l.old_password,onChange:r=>h({...l,old_password:r.target.value}),className:"w-full px-3 py-2 rounded border border-border bg-background text-foreground"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"كلمة المرور الجديدة"}),e.jsx("input",{type:"password",name:"new_password",value:l.new_password,onChange:r=>h({...l,new_password:r.target.value}),className:"w-full px-3 py-2 rounded border border-border bg-background text-foreground"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"تأكيد كلمة المرور"}),e.jsx("input",{type:"password",name:"new_password_confirmation",value:l.new_password_confirmation,onChange:r=>h({...l,new_password_confirmation:r.target.value}),className:"w-full px-3 py-2 rounded border border-border bg-background text-foreground"})]}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded bg-accent text-accent-foreground hover:bg-accent-hover transition",children:"تغيير كلمة المرور"})]})]})]}):e.jsx("div",{className:"mt-10 text-center text-muted-foreground",children:"تحميل البيانات..."})}const z=s.lazy(()=>i(()=>import("./Dashboard-BprxG_6D.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),F=s.lazy(()=>i(()=>import("./ProfileUser-BYV1FES8.js"),__vite__mapDeps([7,2,3,4,1,5,6]))),V=s.lazy(()=>i(()=>import("./ContractsPage-CAdXDuOl.js"),__vite__mapDeps([8,1,2,3,4,5,6]))),U=s.lazy(()=>i(()=>import("./InvestigationsPage-CymSjKxf.js"),__vite__mapDeps([9,1,2,3,4,5,6,10,11]))),G=s.lazy(()=>i(()=>import("./LegalAdvicePage-C_rM3VIX.js"),__vite__mapDeps([12,1,2,3,4,5,6,10,11]))),M=s.lazy(()=>i(()=>import("./LitigationsPage-BtKBKrXH.js"),__vite__mapDeps([13,1,2,3,4,5,6,14,11]))),$=s.lazy(()=>i(()=>import("./UserManagementPage-B5ndgJcV.js"),__vite__mapDeps([15,2,3,4,1,5,6,11,10,16]))),H=s.lazy(()=>i(()=>import("./ArchivePage-DQNIuh6w.js"),__vite__mapDeps([17,1,2,3,4,5,6]))),q=s.lazy(()=>i(()=>import("./ManagementSettings-zsU41gn5.js"),__vite__mapDeps([18,1,2,3,4,5,6]))),B=s.lazy(()=>i(()=>import("./ReportsPage-4iKfEdpI.js"),__vite__mapDeps([19,2,3,4,1,5,6]))),J=()=>e.jsx("h1",{className:"text-center text-red-500",children:"404 - Page Not Found"}),Y=()=>{const{showSpinner:a,hideSpinner:c,loading:x}=I(),m=C();return s.useEffect(()=>{a();const o=setTimeout(()=>{c()},600);return()=>clearTimeout(o)},[m]),e.jsxs(e.Fragment,{children:[x&&e.jsx(y,{}),e.jsx(s.Suspense,{fallback:e.jsx(y,{}),children:e.jsxs(k,{children:[e.jsx(n,{path:"/",element:e.jsx(z,{})}),e.jsx(n,{path:"/profile/:userId",element:e.jsx(F,{})}),e.jsx(n,{path:"/archive",element:e.jsx(H,{})}),e.jsx(n,{path:"/contracts",element:e.jsx(d,{permission:"view contracts",children:e.jsx(V,{})})}),e.jsx(n,{path:"/profile",element:e.jsx(d,{permission:"view profile",children:e.jsx(T,{})})}),e.jsx(n,{path:"/users",element:e.jsx(d,{permission:"view users",children:e.jsx($,{})})}),e.jsx(n,{path:"/legal/investigations",element:e.jsx(d,{permission:"view investigations",children:e.jsx(U,{})})}),e.jsx(n,{path:"/legal/legal-advices",element:e.jsx(d,{permission:"view legaladvices",children:e.jsx(G,{})})}),e.jsx(n,{path:"/legal/litigations",element:e.jsx(d,{permission:"view litigations",children:e.jsx(M,{})})}),e.jsx(n,{path:"/managment-lists",element:e.jsx(d,{permission:"view managment-lists",children:e.jsx(q,{})})}),e.jsx(n,{path:"/reports-page",element:e.jsx(B,{})}),e.jsx(n,{path:"/forbidden",element:e.jsx(O,{})}),e.jsx(n,{path:"*",element:e.jsx(J,{})})]})})]})};export{Y as default};
