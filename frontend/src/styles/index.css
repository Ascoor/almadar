@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root { color-scheme: light dark; }
  html { -webkit-font-smoothing: antialiased; }
  html, body { transition: background-color .2s ease, color .2s ease; }
  body { @apply bg-bg text-fg font-body antialiased; }
  h1,h2,h3,h4,h5,h6 { @apply font-heading; }

  /* Switch map font by document language for best legibility */
  html[lang="ar"] { --font-map: 'Cairo', var(--font-body); }
  html[lang="en"] { --font-map: 'Roboto', var(--font-body); }

  /* Reusable container styles */
  .card { @apply bg-card text-fg border border-border rounded-2xl shadow-md hover:shadow-lg transition-shadow duration-200 ease-in-out; }
  .chart-container { @apply bg-card p-6 md:p-8 rounded-2xl shadow-md border border-border overflow-hidden min-w-0; }

  /* Glass morphism helpers */
  .glass {
    background: rgba(var(--glass-bg));
    border: 1px solid rgba(var(--glass-border));
    box-shadow: var(--glass-shadow);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
  }
  .glass-card { @apply glass rounded-2xl p-4 md:p-6; }
  .hover-scale { @apply transition-transform duration-200 ease-in-out hover:scale-[1.01]; }

  /* Gradient text utility */
  .text-gradient {
    background: var(--gradient-primary);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
  }
}

@layer utilities {
  /* Responsive chart height utility using app tokens */
  .chart-h { height: 220px; }
  @screen sm { .chart-h { height: 240px; } }
  @screen md { .chart-h { height: 260px; } }
  @screen xl { .chart-h { height: 300px; } }

  /* Height equal to two stacked charts plus gap (~24px) */
  .chart-2h { height: calc(220px * 2 + 24px); }
  @screen sm { .chart-2h { height: calc(240px * 2 + 24px); } }
  @screen md { .chart-2h { height: calc(260px * 2 + 24px); } }
  @screen xl { .chart-2h { height: calc(300px * 2 + 24px); } }

  /* Consistent card padding */
  .card-p { @apply p-4 md:p-6; }

  /* Map helpers */
  .map-container { @apply w-full h-full flex items-center justify-center; }
  .map-label {
    font-family: var(--font-map);
    font-weight: 700;
    /* doubled from previous values */
    font-size: clamp(22px, 3.2vw, 32px);
    fill: var(--fg);
    stroke: var(--bg);
    stroke-width: 2px;
    paint-order: stroke fill;
    text-shadow: 0 1px 2px rgba(0,0,0,0.25);
    user-select: none;
  }
  .map-label-city {
    /* doubled from previous values */
    font-size: clamp(20px, 2.8vw, 28px);
    font-weight: 600;
  }

  /* Subtle neon pulse used in dark mode */
  @keyframes neonPulse {
    0%, 100% { box-shadow: 0 0 30px rgba(0,128,128,0.35), 0 0 60px rgba(0,128,128,0.15); }
    50% { box-shadow: 0 0 45px rgba(0,128,128,0.55), 0 0 80px rgba(0,128,128,0.25); }
  }
  .neon-pulse-dark {
    animation: neonPulse 3s ease-in-out infinite;
  }

  /* Section heading (light: clean & simple, dark: neon 3D override below) */
  .section-title {
    color: var(--primary);
    /* Light mode: keep very subtle depth for a clean, matte look */
    text-shadow: 0 1px 0 rgba(0,0,0,0.12);
    letter-spacing: 0.2px;
  }
  /* Dark mode: stronger neon green with layered 3D glow */
  .dark .section-title {
    color: var(--neon-title);
    text-shadow:
      0 0 12px rgba(50, 255, 170, 0.45),
      0 0 24px rgba(50, 255, 170, 0.30),
      0 2px 0 rgba(0,0,0,0.45),
      0 8px 18px rgba(0,0,0,0.35);
  }

  /* Stronger, lighter neon backlight specifically for chart cards */
  .dark .chart-card .section-title {
    text-shadow:
      0 0 14px rgba(80, 255, 190, 0.60),
      0 0 30px rgba(80, 255, 190, 0.40),
      0 0 48px rgba(80, 255, 190, 0.22),
      0 2px 0 rgba(0,0,0,0.5),
      0 10px 22px rgba(0,0,0,0.40);
  }

  /* Slightly brighter pulse for chart titles */
  .dark .chart-card .section-title-animate { animation: neonTitlePulse 3s ease-in-out infinite; }

  /* Page header title/subtitle (bolder than section titles) */
  .page-title {
    font-family: var(--font-heading);
    line-height: 1.1;
    letter-spacing: 0.2px;
    color: var(--primary);
    text-shadow:
      0 0 6px rgba(50,255,170,0.20),
      0 2px 0 rgba(0,0,0,0.30);
  }
  .dark .page-title {
    color: var(--neon-title);
    text-shadow:
      0 0 16px rgba(50,255,170,0.55),
      0 0 36px rgba(50,255,170,0.35),
      0 3px 0 rgba(0,0,0,0.5),
      0 12px 26px rgba(0,0,0,0.45);
  }
  .page-title-animate { animation: neonTitlePulse 3.4s ease-in-out infinite; }

  .page-subtitle {
    color: var(--muted-foreground);
    text-shadow: 0 1px 0 rgba(0,0,0,0.25);
  }

  /* Mini-sidebar item helpers (light + dark) */
  .mini-sidebar-item {
    @apply flex items-center gap-2 px-3 py-2 rounded-lg transition-colors;
    color: var(--fg);
  }
  .mini-sidebar-item:hover {
    background: color-mix(in oklab, var(--primary) 12%, transparent);
  }
  .mini-sidebar-item.active {
    background: color-mix(in oklab, var(--primary) 18%, transparent);
    outline: 2px solid color-mix(in oklab, var(--primary) 30%, transparent);
  }

  /* Animated neon pulse for titles in dark mode */
  @keyframes neonTitlePulse {
    0%, 100% {
      text-shadow:
        0 0 8px rgba(50, 255, 170, 0.40),
        0 0 18px rgba(50, 255, 170, 0.25),
        0 2px 0 rgba(0,0,0,0.45),
        0 8px 18px rgba(0,0,0,0.35);
    }
    50% {
      text-shadow:
        0 0 14px rgba(50, 255, 170, 0.55),
        0 0 28px rgba(50, 255, 170, 0.35),
        0 2px 0 rgba(0,0,0,0.5),
        0 10px 22px rgba(0,0,0,0.4);
    }
  }
  .dark .section-title-animate { animation: neonTitlePulse 3.2s ease-in-out infinite; }

  /* 3D icon shadow (light + dark) */
  .icon-3d {
    filter:
      drop-shadow(0 1px 0 rgba(0,0,0,0.35))
      drop-shadow(0 4px 10px rgba(0,0,0,0.25));
    transition: transform .2s ease, filter .2s ease;
  }
  .icon-3d:hover { transform: translateY(-1px); }
  .dark .icon-3d {
    filter:
      drop-shadow(0 1px 0 rgba(0,0,0,0.55))
      drop-shadow(0 6px 14px rgba(0,0,0,0.45))
      drop-shadow(0 0 8px rgba(50,255,170,0.18));
  }
}
